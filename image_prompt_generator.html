<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ìƒì„±ê¸°</title>
    
    <!-- CSS íŒŒì¼ ë§í¬ -->
    <link rel="stylesheet" href="design-system.css">
    <link rel="stylesheet" href="concept-art-styles-modern.css">
    <link rel="stylesheet" href="concept-art-styles-unified.css">
    
    <!-- SEO -->
    <meta name="description" content="AI ì´ë¯¸ì§€ ìƒì„±ì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ ì œì‘ ë„êµ¬">
    <meta name="keywords" content="AI ì´ë¯¸ì§€ìƒì„±, í”„ë¡¬í”„íŠ¸, Midjourney, DALL-E, Stable Diffusion">
    
    <!-- íŒŒë¹„ì½˜ -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ–¼ï¸</text></svg>">
    
    <style>
        /* í° íŒì—… ìˆ¨ê¸°ê¸° - ì™¸ë¶€ CSS ì˜¤ë²„ë¼ì´ë“œ */
        .popup, .modal, .overlay, .dialog, .popup-overlay, .modal-backdrop {
            display: none !important;
        }
        
        /* API ëª¨ë‹¬ë§Œ ì˜ˆì™¸ ì²˜ë¦¬ */
        #api-modal.modal-overlay {
            display: none;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        #api-modal.modal-overlay.show {
            display: flex !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        /* í† ìŠ¤íŠ¸ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
        #toast.toast {
            display: none;
        }
        
        #toast.toast.show {
            display: flex !important;
            opacity: 1 !important;
            transform: translateX(0) !important;
        }
        
        /* í˜ì´ì§€ íŠ¹í™” ìŠ¤íƒ€ì¼ */
        .main-container {
            max-width: 1800px;
            margin: 0 auto;
            padding: var(--space-lg);
            padding-top: 80px;
            padding-bottom: 100px; /* í•˜ë‹¨ ë“œë¡­ë‹¤ìš´ì„ ìœ„í•œ ì—¬ë°± */
            position: relative;
            z-index: 1;
        }
        
        /* PCì—ì„œ ì ì ˆí•œ ì»¨í…ì¸  ë„ˆë¹„ ìœ ì§€ */
        @media (min-width: 1200px) {
            .main-container {
                padding-left: 3%;
                padding-right: 3%;
            }
        }

        .section {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
            position: relative;
            /* ë“œë¡­ë‹¤ìš´ì´ ì„¹ì…˜ ë°–ìœ¼ë¡œ ë‚˜ê°ˆ ë•Œ ì˜ë¦¬ì§€ ì•Šë„ë¡ */
            overflow: visible;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-gradient);
            opacity: 0.8;
        }

        .section-header {
            margin-bottom: var(--space-sm);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .section-header-left {
            flex: 1;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-subtitle {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        /* ì…ë ¥ ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .input-area {
            display: block;
            margin-bottom: var(--space-md);
        }
        

        .input-section {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            padding: var(--space-sm);
            transition: all var(--transition-base);
        }

        .input-section:hover {
            border-color: rgba(168, 85, 247, 0.5);
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.1);
        }

        .input-section h3 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: var(--space-sm);
            color: var(--text-primary);
            word-break: keep-all;
            white-space: normal;
        }

        .text-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-sm);
            padding: var(--space-sm);
            color: var(--text-primary);
            font-family: 'Paperlogy', sans-serif;
            font-size: 0.85rem;
            resize: vertical;
            min-height: 150px;
            transition: all var(--transition-base);
        }

        .text-input:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.2);
        }


        /* ì´ë¯¸ì§€ í”„ë¦¬ë·° */
        .image-preview {
            width: 100%;
            max-height: 200px;
            object-fit: contain;
            border-radius: var(--radius-sm);
            margin-top: var(--space-sm);
        }

        .remove-image-btn {
            position: absolute;
            top: var(--space-xs);
            right: var(--space-xs);
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            border-radius: var(--radius-full);
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all var(--transition-base);
        }

        .remove-image-btn:hover {
            background: rgba(239, 68, 68, 1);
            transform: scale(1.1);
        }

        /* ë²„íŠ¼ ê·¸ë£¹ */
        .button-group {
            display: flex;
            gap: var(--space-sm);
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .btn {
            padding: 6px 16px;
            border: none;
            border-radius: var(--radius-full);
            font-family: 'Paperlogy', sans-serif;
            font-weight: 500;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all var(--transition-base);
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 12px rgba(168, 85, 247, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(168, 85, 247, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .btn-export {
            background: var(--accent-gradient);
            color: white;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        .btn-export:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.4);
        }

        /* ìƒì„±ëœ í”„ë¡¬í”„íŠ¸ ì˜ì—­ */
        .output-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-sm);
            padding: var(--space-md);
            margin-top: var(--space-md);
            display: none;
        }

        .output-section.active {
            display: block;
        }

        .output-text {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            padding: var(--space-sm);
            color: var(--text-primary);
            font-family: 'Paperlogy', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
            white-space: pre-wrap;
            word-break: break-word;
        }

        .copy-btn {
            margin-top: var(--space-sm);
            background: var(--secondary-gradient);
            color: white;
        }

        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        /* í”„ë¡¬í”„íŠ¸ ì…ë ¥ ì˜ì—­ */
        .prompt-preview-section {
            margin-top: var(--space-lg);
            margin-bottom: var(--space-md);
        }
        
        /* í”„ë¡¬í”„íŠ¸ ì¹´ë“œ ì„¹ì…˜ ì „ì²´ ë„ˆë¹„ ë³´ì¥ */
        #prompt-cards-section {
            width: 100%;
            /* ë“œë¡­ë‹¤ìš´ì´ í™”ë©´ í•˜ë‹¨ì— ë‹¿ì•„ë„ ì—¬ìœ  ê³µê°„ í™•ë³´ */
            padding-bottom: calc(var(--space-xl, 48px));
        }
        
        #prompt-cards-grid {
            width: 100%;
        }

        .preview-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .prompt-preview {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            padding: var(--space-md);
            min-height: 80px;
            font-family: 'Paperlogy', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
            color: var(--text-primary);
            transition: all var(--transition-base);
        }

        .prompt-preview:hover {
            border-color: rgba(168, 85, 247, 0.3);
            background: rgba(255, 255, 255, 0.05);
        }

        .preview-placeholder {
            color: var(--text-tertiary);
            font-style: italic;
            margin: 0;
        }

        .prompt-preview.has-content {
            color: var(--text-primary);
            font-style: normal;
        }

        /* í”„ë¡¬í”„íŠ¸ ì…ë ¥ ê°€ëŠ¥ ìŠ¤íƒ€ì¼ */
        .prompt-preview[contenteditable="true"] {
            cursor: text;
            outline: none;
            min-height: 100px;
        }
        .prompt-preview:focus {
            border-color: rgba(168, 85, 247, 0.5);
            background: rgba(255, 255, 255, 0.06);
        }

        /* êµ¬ì¡° í¸ì§‘ê¸° íƒ­ ìŠ¤íƒ€ì¼ */
        .structure-tabs {
            margin-bottom: var(--space-md);
        }
        
        .structure-tab-buttons { 
            display: flex; 
            gap: var(--space-xs); 
            margin-bottom: var(--space-xs); 
        }
        
        .structure-tab-button {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-base);
        }
        
        .structure-tab-button:hover { 
            border-color: rgba(168, 85, 247, 0.35); 
            background: rgba(168, 85, 247, 0.05);
        }
        
        .structure-tab-button.active {
            background: rgba(168, 85, 247, 0.15);
            border-color: rgba(168, 85, 247, 0.35);
            color: white;
        }
        
        /* êµ¬ì¡° í¸ì§‘ê¸° ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .structure-section {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
        }
        
        .structure-section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--accent-purple);
            margin-bottom: var(--space-sm);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* ìºë¦­í„° ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .character-container {
            width: 100% !important;
            display: flex;
            flex-direction: column;
            max-width: none !important;
        }
        /* ì¼ë°˜ì´ë¯¸ì§€ ì»¨í…Œì´ë„ˆë„ ë™ì¼ ìŠ¤íƒ€ì¼ ì ìš© */
        .general-container {
            width: 100% !important;
            display: flex;
            flex-direction: column;
            max-width: none !important;
        }
        
        /* ìºë¦­í„° í•˜ìœ„ íƒ­ ìŠ¤íƒ€ì¼ */
        .character-sub-tabs {
            margin-bottom: var(--space-md);
            width: 100%;
        }
        
        .sub-tab-buttons {
            display: flex;
            gap: var(--space-xs);
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            padding-bottom: var(--space-xs);
            width: 100%;
        }
        
        .sub-tab-button {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            padding: 8px 20px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-base);
            position: relative;
        }
        
        .sub-tab-button:hover {
            color: var(--text-primary);
        }
        
        .sub-tab-button.active {
            color: var(--accent-purple);
        }
        
        .sub-tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-purple);
        }
        
        /* í•˜ìœ„ íƒ­ ì»¨í…ì¸  ìŠ¤íƒ€ì¼ */
        .sub-tab-contents {
            min-height: 0; /* ì½˜í…ì¸  ë†’ì´ì— ë§ì¶° ìë™ */
            width: 100%;
            padding-bottom: 0; /* ìºë¦­í„° ì‹œíŠ¸ í•˜ë‹¨ê³¼ ë°”ë¡œ ë§ë‹¿ë„ë¡ */
        }
        
        .sub-tab-content {
            display: none;
            width: 100%;
            position: relative;
        }
        
        .sub-tab-content.active {
            display: block;
        }
        
        /* ìºë¦­í„° í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .character-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .character-row {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all var(--transition-base);
        }
        
        .character-row:hover {
            background: rgba(255, 255, 255, 0.02);
        }
        
        .character-row td {
            padding: var(--space-sm) var(--space-md);
            vertical-align: middle;
        }
        
        .style-column {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: bold;
            width: 150px;
            text-align: center;
            font-size: 0.85rem;
            white-space: nowrap;
            padding: var(--space-sm) var(--space-md);
        }
        
        .item-number {
            color: var(--text-tertiary);
            font-size: 0.85rem;
            min-width: 40px;
            font-weight: 500;
            text-align: center;
        }
        
        .item-key {
            color: var(--accent-purple);
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            min-width: 150px;
        }
        
        .item-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-sm);
            padding: 8px 12px;
            color: var(--text-primary);
            font-family: 'Paperlogy', sans-serif;
            font-size: 0.85rem;
            transition: all var(--transition-base);
        }
        
        .item-input.change-request {
            background-color: rgba(255, 255, 255, 0.03);
        }
        
        .item-input.change-applied {
            background-color: rgba(240, 248, 255, 0.05);
        }
        
        /* ë“œë¡­ë‹¤ìš´ ìŠ¤íƒ€ì¼ */
        .dropdown-container {
            margin-bottom: var(--space-md);
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            overflow: hidden;
            transition: all var(--transition-base);
            position: relative;
        }
        
        .dropdown-container.active {
            overflow: visible;
        }
        
        .dropdown-container:hover {
            border-color: rgba(168, 85, 247, 0.3);
            box-shadow: 0 4px 20px rgba(168, 85, 247, 0.1);
        }
        
        .dropdown-container.active {
            border-color: var(--accent-purple);
            box-shadow: 0 6px 24px rgba(168, 85, 247, 0.2);
        }
        
        .dropdown-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-md);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-base);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .dropdown-header:hover {
            background: rgba(168, 85, 247, 0.1);
            border-bottom-color: var(--accent-purple);
        }
        
        .dropdown-title {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .dropdown-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            background: var(--accent-purple);
            color: white;
            border-radius: var(--radius-full);
            font-size: 0.85rem;
            font-weight: 700;
            transition: all var(--transition-base);
        }
        
        .dropdown-container:hover .dropdown-number {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transform: scale(1.1);
        }
        
        .dropdown-arrow {
            transition: transform var(--transition-base);
            font-size: 1.2rem;
            color: var(--accent-purple);
        }
        
        .dropdown-container:hover .dropdown-arrow {
            color: var(--text-primary);
        }
        
        .dropdown-english-label {
            display: inline-block;
            background: var(--accent-green);
            color: white;
            padding: 2px 8px;
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: var(--space-xs);
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .dropdown-container:hover .dropdown-english-label {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
        
        /* Select-Input í•˜ì´ë¸Œë¦¬ë“œ ìŠ¤íƒ€ì¼ */
        .select-input-wrapper {
            position: relative;
            width: 100%;
        }
        
        .dropdown-field-input.with-select {
            padding-right: 35px;
        }
        
        .dropdown-toggle-btn {
            position: absolute;
            right: 1px;
            top: 1px;
            bottom: 1px;
            width: 30px;
            background: var(--accent-purple);
            border: none;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-base);
        }
        
        .dropdown-toggle-btn:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .dropdown-icon {
            font-size: 0.8rem;
            transition: transform var(--transition-base);
        }
        
        .dropdown-toggle-btn.active .dropdown-icon {
            transform: rotate(180deg);
        }
        
        .style-options-dropdown {
            position: absolute;
            top: calc(100% + 4px);
            left: 0;
            right: 0;
            background: rgba(30, 30, 35, 0.98);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-md);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            z-index: 10000;
            max-height: 340px;
            overflow: auto;
            display: flex;
            flex-direction: column;
            pointer-events: auto;
        }
        
        .style-options-search {
            padding: var(--space-sm);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
        }
        
        .style-options-search input {
            width: 100%;
            padding: 6px 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 0.8rem;
        }
        
        .style-options-list {
            overflow-y: auto;
            max-height: 250px;
            background: rgba(20, 20, 25, 0.6);
        }
        
        .style-option {
            padding: 8px 12px;
            cursor: pointer;
            transition: all var(--transition-base);
            font-size: 0.85rem;
            color: var(--text-secondary);
            position: relative;
        }
        
        .style-option:hover {
            background: rgba(168, 85, 247, 0.1);
            color: var(--text-primary);
            padding-left: 16px;
        }
        
        .style-option.selected {
            background: rgba(168, 85, 247, 0.2);
            color: var(--accent-purple);
            font-weight: 600;
            position: relative;
            padding-right: 35px;
        }
        
        .style-option.selected::after {
            content: 'âœ“';
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent-purple);
            font-size: 1rem;
        }
        
        .style-option.focused {
            background: rgba(168, 85, 247, 0.15);
            color: var(--text-primary);
            outline: 2px solid var(--accent-purple);
            outline-offset: -2px;
        }
        
        .style-option.hidden {
            display: none;
        }
        
        .dropdown-container.active .dropdown-arrow {
            transform: rotate(180deg);
        }
        
        .dropdown-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.25s ease-out;
            background: rgba(255, 255, 255, 0.02);
            position: relative;
        }
        
        .dropdown-container.active .dropdown-content {
            max-height: 420px;
            overflow: visible;
        }
        
        .dropdown-fields {
            padding: var(--space-md);
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-md);
            position: relative;
        }
        
        .dropdown-field {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
            position: relative;
        }
        
        
        .field-action-buttons {
            display: flex;
            gap: 6px;
            flex-shrink: 0;
        }
        
        .btn-field-action {
            padding: 4px 8px;
            font-size: 0.7rem;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-base);
            font-weight: 500;
            white-space: nowrap;
        }
        
        .btn-save {
            background: var(--accent-green);
            color: white;
        }
        
        .btn-save:hover {
            background: #059669;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
        
        .btn-ai-save {
            background: var(--accent-purple);
            color: white;
        }
        
        .btn-ai-save:hover {
            background: #9333EA;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(168, 85, 247, 0.3);
        }
        
        .dropdown-field-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: var(--space-xs);
            display: block;
            line-height: 20px;
            min-height: 20px;
        }
        
        .dropdown-field-label-with-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-xs);
            height: 20px; /* ë¼ë²¨ ì˜ì—­ ë†’ì´ ê³ ì • */
        }
        
        .dropdown-field-label-with-buttons .dropdown-field-label {
            margin-bottom: 0;
        }
        
        .dropdown-field-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-sm);
            padding: 10px 14px;
            color: var(--text-primary);
            font-family: 'Paperlogy', sans-serif;
            font-size: 0.85rem;
            transition: all var(--transition-base);
        }
        
        .dropdown-field-input:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }
        
        /* ëª¨ë°”ì¼ ë“œë¡­ë‹¤ìš´ ìŠ¤íƒ€ì¼ */
        @media (max-width: 767px) {
            .dropdown-fields {
                grid-template-columns: 1fr;
                gap: var(--space-sm);
            }
            
            .dropdown-title {
                font-size: 0.85rem;
            }
            
            .dropdown-number {
                width: 24px;
                height: 24px;
                font-size: 0.75rem;
            }
            
            .dropdown-field-label-with-buttons {
                flex-wrap: wrap;
                gap: var(--space-xs);
            }
            
            .dropdown-field-label-with-buttons .field-action-buttons {
                width: 100%;
                order: 2;
                margin-top: var(--space-xs);
            }
            
            .btn-field-action {
                flex: 1;
                padding: 4px 6px;
                font-size: 0.65rem;
            }
        }
        
        .item-input:focus {
            outline: none;
            border-color: var(--accent-purple);
            background: rgba(255, 255, 255, 0.08);
        }
        

        /* êµ¬ì¡°ë³„ ì¹´ë“œ ì„¹ì…˜ */
        .prompt-cards-section {
            margin-top: 4px;
            margin-bottom: 4px;
            margin-left: calc(-1 * var(--space-sm));
            margin-right: calc(-1 * var(--space-sm));
            padding: var(--space-sm);
            background: rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: visible; /* ë‚´ë¶€ ë“œë¡­ë‹¤ìš´ì´ ë„˜ì³ë„ ë³´ì´ë„ë¡ */
        }

        .cards-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
        }

        .cards-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            word-break: keep-all;
            white-space: normal;
        }

        .btn-import {
            background: var(--secondary-gradient);
            color: white;
            font-size: 0.8rem;
            padding: 6px 14px;
        }

        .btn-import:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .prompt-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-sm);
        }
        
        /* ìºë¦­í„°/ì¼ë°˜ì´ë¯¸ì§€ íƒ­ì—ì„œ prompt-cards-grid ì˜¤ë²„ë¼ì´ë“œ */
        .prompt-cards-grid:has(.character-container),
        .prompt-cards-grid:has(.general-container) {
            display: block;
            width: 100%;
        }
        
        /* í° í™”ë©´ì—ì„œ ë” ë§ì€ ì¹´ë“œ í‘œì‹œ */
        @media (min-width: 1600px) {
            .prompt-cards-grid {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
                gap: var(--space-md);
            }
        }

        .prompt-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-sm);
            padding: var(--space-sm);
            transition: all var(--transition-base);
            position: relative;
        }

        .prompt-card:hover {
            border-color: rgba(168, 85, 247, 0.3);
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-1px);
        }

        .prompt-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-xs);
        }

        .prompt-card-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--accent-purple);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .prompt-card-edit-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.9rem;
            padding: 2px 6px;
            border-radius: var(--radius-sm);
            transition: all var(--transition-base);
        }

        .prompt-card-edit-btn:hover {
            color: var(--accent-purple);
            background: rgba(168, 85, 247, 0.1);
        }

        .prompt-card-content {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.4;
            min-height: 40px;
        }

        .prompt-card-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-sm);
            padding: var(--space-xs);
            color: var(--text-primary);
            font-family: 'Paperlogy', sans-serif;
            font-size: 0.8rem;
            resize: vertical;
            min-height: 60px;
            display: none;
        }

        .prompt-card.editing .prompt-card-content {
            display: none;
        }

        .prompt-card.editing .prompt-card-input {
            display: block;
        }

        .prompt-card-actions {
            display: none;
            gap: var(--space-xs);
            margin-top: var(--space-xs);
        }

        .prompt-card.editing .prompt-card-actions {
            display: flex;
        }

        .prompt-card-btn {
            padding: 4px 12px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-base);
        }

        .prompt-card-save {
            background: var(--accent-green);
            color: white;
        }

        .prompt-card-save:hover {
            background: rgba(16, 185, 129, 0.8);
        }

        .prompt-card-cancel {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        .prompt-card-cancel:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* Hidden class for filtering */
        .hidden {
            display: none !important;
        }
        
        /* í† ìŠ¤íŠ¸ ë©”ì‹œì§€ - ì‚­ì œ (ì¤‘ë³µ ì •ì˜) */

        /* íƒœë¸”ë¦¿ ë””ìì¸ (768px - 1199px) */
        @media (min-width: 768px) and (max-width: 1199px) {
            .main-container {
                padding-left: var(--space-md);
                padding-right: var(--space-md);
            }
        }

        /* ëª¨ë°”ì¼ ë””ìì¸ */
        @media (max-width: 767px) {
            /* ìºë¦­í„° í…Œì´ë¸” ìŠ¤íƒ€ì¼ ì œê±° - ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ëŒ€ì²´ */
            
            .sub-tab-buttons {
                flex-wrap: wrap;
            }
            
            .sub-tab-button {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            .input-area {
                grid-template-columns: 1fr;
                gap: var(--space-sm);
            }

            .button-group {
                justify-content: center;
                gap: 8px;
                flex-wrap: wrap;
            }

            .main-container {
                padding: var(--space-sm);
                padding-top: 70px;
                max-width: 100%;
            }
            
            .section {
                padding: var(--space-sm);
                margin-bottom: var(--space-sm);
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-sm);
            }
            
            .section-header-left {
                width: 100%;
            }
            
            .section-title {
                font-size: 1rem;
                word-break: keep-all;
                white-space: normal;
            }
            
            .section-subtitle {
                font-size: 0.75rem;
                word-break: keep-all;
                white-space: normal;
            }
            
            .btn {
                padding: 6px 12px;
                font-size: 0.8rem;
                white-space: nowrap;
                min-width: auto;
            }
            
            .btn-ai-connect {
                width: 100%;
                justify-content: center;
            }
            
            .text-input {
                min-height: 120px;
                font-size: 0.8rem;
                word-break: break-word;
            }
            
            
            .prompt-preview-section {
                margin-top: var(--space-md);
                margin-bottom: var(--space-sm);
            }
            
            .prompt-preview {
                min-height: 60px;
                padding: var(--space-sm);
                font-size: 0.8rem;
                word-break: break-word;
                white-space: pre-wrap;
            }
            
            .preview-title {
                font-size: 0.85rem;
                word-break: keep-all;
            }
            
            .preview-placeholder {
                word-break: keep-all;
                white-space: normal;
            }
            
            .prompt-cards-grid {
                grid-template-columns: 1fr;
            }
            
            .prompt-card {
                padding: var(--space-xs);
            }
            
            .prompt-card-title {
                font-size: 0.8rem;
                word-break: keep-all;
            }
            
            .prompt-card-content {
                font-size: 0.75rem;
                word-break: break-word;
            }
            
            .cards-title {
                word-break: keep-all;
                white-space: normal;
                font-size: 0.8rem;
            }
            
            .cards-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-xs);
            }
            
            .btn-import {
                width: 100%;
                font-size: 0.8rem;
                padding: 6px 12px;
            }
        }
        
        /* ì´ˆì†Œí˜• ëª¨ë°”ì¼ (max-width: 380px) */
        @media (max-width: 380px) {
            .button-group {
                flex-direction: column;
                width: 100%;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* Utility classes */
        .hidden {
            display: none !important;
        }
        
        /* í† ìŠ¤íŠ¸ ë©”ì‹œì§€ - ì»´íŒ©íŠ¸ ìŠ¤íƒ€ì¼ */
        .toast {
            position: fixed !important;
            top: 16px !important;
            right: 16px !important;
            background: rgba(20, 20, 25, 0.95) !important;
            backdrop-filter: blur(10px) !important;
            color: white !important;
            padding: 10px 16px !important;
            border-radius: 12px !important;
            font-size: 0.8rem !important;
            font-weight: 500 !important;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 10000 !important;
            box-shadow: 
                0 4px 12px rgba(0, 0, 0, 0.15),
                0 0 0 1px rgba(255, 255, 255, 0.1) !important;
            pointer-events: none;
            display: none;
            align-items: center;
            gap: 8px;
            max-width: 320px !important;
            min-height: 40px !important;
            width: auto !important;
            height: auto !important;
        }

        .toast.show {
            display: flex !important;
            opacity: 1 !important;
            transform: translateX(0) !important;
            pointer-events: auto;
        }
        
        .toast::before {
            content: '';
            width: 3px;
            height: 100%;
            position: absolute;
            left: 0;
            top: 0;
            border-radius: 12px 0 0 12px;
        }
        
        .toast[style*="16, 185, 129"]::before {
            background: #10b981;
        }
        
        .toast[style*="239, 68, 68"]::before {
            background: #ef4444;
        }
        
        .toast[style*="59, 130, 246"]::before {
            background: #3b82f6;
        }

        /* API ì—°ë™ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show {
            display: flex !important;
        }

        .modal-container {
            background: rgba(20, 20, 25, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            width: 90%;
            max-width: 420px;
            max-height: 85vh;
            overflow: hidden;
            box-shadow: 
                0 0 0 1px rgba(255, 255, 255, 0.1) inset,
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 100px rgba(168, 85, 247, 0.1);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.15) 0%, rgba(116, 75, 162, 0.15) 100%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all var(--transition-base);
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            color: white;
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 20px;
            overflow-y: auto;
            max-height: calc(85vh - 120px);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-select,
        .form-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 10px 14px;
            color: var(--text-primary);
            font-family: 'Paperlogy', sans-serif;
            font-size: 0.85rem;
            transition: all var(--transition-base);
        }

        .form-select:focus,
        .form-input:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }

        .form-select option {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .api-info {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.08) 0%, rgba(168, 85, 247, 0.08) 100%);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            padding: 10px 12px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .api-info a {
            color: #60a5fa;
            text-decoration: none;
            font-weight: 500;
            transition: all var(--transition-base);
        }
        
        .api-info a:hover {
            color: #93bbfc;
            text-decoration: underline;
        }

        .modal-footer {
            padding: 16px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .modal-footer .btn {
            padding: 8px 16px;
            font-size: 0.8rem;
            border-radius: 8px;
            font-weight: 500;
        }
        
        .btn-test {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .btn-test:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        .modal-footer .btn-save {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .modal-footer .btn-save:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        
        .modal-footer .btn-save:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-cancel {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-secondary);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-cancel:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.15);
            color: var(--text-primary);
        }

        .connection-status {
            margin-top: 12px;
            padding: 10px 14px;
            border-radius: 8px;
            font-size: 0.8rem;
            display: none;
            font-weight: 500;
            text-align: center;
        }

        .connection-status.success {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.1) 100%);
            border: 1px solid rgba(16, 185, 129, 0.25);
            color: #10b981;
            display: block;
            animation: successPulse 0.3s ease-out;
        }
        
        @keyframes successPulse {
            0% { transform: scale(0.95); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .connection-status.error {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(220, 38, 38, 0.1) 100%);
            border: 1px solid rgba(239, 68, 68, 0.25);
            color: #ef4444;
            display: block;
            animation: errorShake 0.3s ease-out;
        }
        
        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
    </style>
</head>
<body class="dark-theme">
    <!-- Gradient Mesh Background -->
    <div class="gradient-mesh-bg"></div>
    
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="header-left">
                <a href="index.html" class="home-btn">ğŸ  í™ˆ</a>
                <h2 class="header-title" style="font-size: 1.1rem;">ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ ìƒì„±ê¸°</h2>
            </div>
            <div class="header-right">
                <div class="header-buttons">
                    <a href="storyboard/index.html" class="header-btn">ìŠ¤í† ë¦¬ë³´ë“œ</a>
                    <a href="your_title_storyboard_v9.4_c.html" class="header-btn">ì»¨ì…‰ì•„íŠ¸</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast ë©”ì‹œì§€ ì œê±°ë¨ -->
    
    <!-- Main Container -->
    <div class="main-container">
        <!-- ìš”ì²­ì‚¬í•­ ì…ë ¥ ì„¹ì…˜ -->
        <div class="section">
            <div class="section-header">
                <div class="section-header-left">
                    <h2 class="section-title">ìš”ì²­ì‚¬í•­ ì…ë ¥</h2>
                </div>
                <button class="btn btn-primary btn-ai-connect" id="ai-connect-btn">
                    ğŸ¤– AI ì—°ë™
                </button>
            </div>


            <!-- í”„ë¡¬í”„íŠ¸ ì…ë ¥ ì˜ì—­ -->
            <div class="prompt-preview-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-sm);">
                    <h3 class="preview-title">í”„ë¡¬í”„íŠ¸ ì…ë ¥</h3>
                </div>
                <div class="prompt-preview" id="prompt-preview" contenteditable="true" spellcheck="false">
                    <p class="preview-placeholder">ì—¬ê¸°ì— í”„ë¡¬í”„íŠ¸ë¥¼ ì§ì ‘ ì…ë ¥í•˜ê±°ë‚˜ ì˜ˆì‹œ í”„ë¡¬í”„íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
            </div>

            <!-- êµ¬ì¡°ë³„ ì¹´ë“œ ì„¹ì…˜ -->
            <div class="prompt-cards-section" id="prompt-cards-section">
                <div class="cards-header">
                    <h3 class="cards-title">ğŸ¯ í”„ë¡¬í”„íŠ¸ êµ¬ì¡° í¸ì§‘ê¸°</h3>
                    <button class="btn btn-import" id="import-prompt-btn" onclick="importPromptFromPreview()">
                        ğŸ“¥ ê°€ì ¸ì˜¤ê¸°
                    </button>
                </div>
                <!-- êµ¬ì¡° í¸ì§‘ê¸° íƒ­ -->
                <div class="structure-tabs">
                    <div class="structure-tab-buttons">
                        <button type="button" class="structure-tab-button active" id="structure-tab-character" onclick="switchStructureTab('character')">ìºë¦­í„°</button>
                        <button type="button" class="structure-tab-button" id="structure-tab-general" onclick="switchStructureTab('general')">ì¼ë°˜ì´ë¯¸ì§€</button>
                    </div>
                </div>
                <div class="prompt-cards-grid" id="prompt-cards-grid">
                    <!-- ì¹´ë“œë“¤ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ë²„íŠ¼ ê·¸ë£¹ -->
            <div class="button-group">
                <button class="btn btn-primary" id="generate-prompt-btn">
                    âœ¨ í”„ë¡¬í”„íŠ¸ ìƒì„±
                </button>
                <button class="btn btn-primary" id="ai-generate-prompt-btn" onclick="console.log('ë²„íŠ¼ ì§ì ‘ í´ë¦­!'); if(window.generateAIPrompt) { window.generateAIPrompt(); } else { console.error('generateAIPrompt í•¨ìˆ˜ê°€ ì•„ì§ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.'); }" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
                    ğŸ¤– AI í”„ë¡¬í”„íŠ¸ ìƒì„±
                </button>
            </div>
        </div>

        <!-- ìµœì¢… í”„ë¡¬í”„íŠ¸ ì„¹ì…˜ -->
        <div class="section" id="final-prompt-section" style="display:none;">
            <div class="section-header">
                <h2 class="section-title">ìµœì¢… í”„ë¡¬í”„íŠ¸</h2>
            </div>
            <textarea id="final-prompt-text" class="text-input" placeholder="ìµœì¢… í”„ë¡¬í”„íŠ¸ê°€ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤." readonly style="min-height:320px;"></textarea>
            <div class="button-group" style="margin-top: 8px;">
                <button class="btn copy-btn" id="copy-final-prompt-btn">ğŸ“‹ í”„ë¡¬í”„íŠ¸ ë³µì‚¬</button>
            </div>
        </div>
        
    </div>

    <!-- Toast Message ì œê±°ë¨ -->

    <script>
        // ë°ì´í„° ì €ì¥ìš© ê°ì²´
        let promptData = {
            textInput: '',
            generatedPrompts: [],
            structuredPrompt: {}
        };

        // DOM ìš”ì†Œë“¤
        const generateBtn = document.getElementById('generate-prompt-btn');
        // ê¸°ì¡´ 'ìƒì„±ëœ í”„ë¡¬í”„íŠ¸' ì„¹ì…˜ ì œê±°ì— ë”°ë¼ ê´€ë ¨ DOM ì°¸ì¡° ì‚­ì œ
        const finalPromptSection = document.getElementById('final-prompt-section');
        const finalPromptText = document.getElementById('final-prompt-text');
        const copyFinalPromptBtn = document.getElementById('copy-final-prompt-btn');
        const toast = document.getElementById('toast');
        const aiConnectBtn = document.querySelector('.btn-ai-connect');
        const promptPreview = document.getElementById('prompt-preview');
        const promptCardsSection = document.getElementById('prompt-cards-section');
        const promptCardsGrid = document.getElementById('prompt-cards-grid');
        let userEditingPreview = false;
        
        // ë“œë¡­ë‹¤ìš´ í‚¤ë³´ë“œ ë‚´ë¹„ê²Œì´ì…˜ì„ ìœ„í•œ ì „ì—­ ë³€ìˆ˜
        let currentFocusedIndex = -1;
        let activeDropdown = null;



        // í”„ë¡¬í”„íŠ¸ ìƒì„±
        generateBtn.addEventListener('click', async () => {
            const text = promptData.textInput || promptPreview.innerText.trim();
            
            if (!text) {
                showToast('í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }

            // AI API ì„¤ì •ì´ ìˆìœ¼ë©´ AIë¡œ í–¥ìƒ, ì—†ìœ¼ë©´ ê¸°ì¡´ ë¡œì§ ì‚¬ìš©
            const config = localStorage.getItem('aiApiConfig');
            let prompt = '';
            
            if (config) {
                showToast('AIë¡œ í”„ë¡¬í”„íŠ¸ë¥¼ í–¥ìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤...', 'info');
                prompt = await enhancePromptWithAI(text);
            } else {
                prompt = enhancePrompt(text);
            }
            

            // í”„ë¡¬í”„íŠ¸ ì €ì¥ ë° í‘œì‹œ
            promptData.generatedPrompts.push({
                timestamp: new Date().toISOString(),
                input: text,
                output: prompt
            });
            saveToLocalStorage();
            
            // ìµœì¢… í”„ë¡¬í”„íŠ¸ í‘œì‹œ í•¨ìˆ˜ í˜¸ì¶œ
            displayFinalPrompt(prompt);
        });
        
        // ìµœì¢… í”„ë¡¬í”„íŠ¸ í‘œì‹œ í•¨ìˆ˜
        function displayFinalPrompt(defaultPrompt) {
            // ìµœì¢… í”„ë¡¬í”„íŠ¸ ì„¹ì…˜ ì—…ë°ì´íŠ¸: ë³€ê²½ë°˜ì˜ > ê¸°ì¡´ë‚´ìš© ìš°ì„ ìœ¼ë¡œ ìˆ˜ì§‘
            const resolvedStructure = { ...promptData.structuredPrompt };
            // í™œì„± íƒ­ì˜ ëª¨ë“  dropdown-fieldë¥¼ ìˆœíšŒí•˜ì—¬ ê°’ì„ ìˆ˜ì§‘
            const scopeSelector = currentStructureTab === 'character' ? '.character-container' : '.general-container';
            const scope = document.querySelector(scopeSelector);
            if (scope) {
                scope.querySelectorAll('.dropdown-container').forEach(container => {
                    const key = container.dataset.key;
                    if (!key) return;
                    const appliedInput = container.querySelector(`input[data-key="${key}-applied"]`);
                    const existingInput = container.querySelector(`input[data-key="${key}"]`);
                    const appliedVal = (appliedInput?.value || '').trim();
                    const existingVal = (existingInput?.value || '').trim();
                    // ë³€ê²½ë°˜ì˜ì´ ìˆìœ¼ë©´ ìš°ì„ , ì—†ìœ¼ë©´ ê¸°ì¡´ë‚´ìš©, ë‘˜ ë‹¤ ì—†ìœ¼ë©´ ê¸°ì¡´ êµ¬ì¡° ìœ ì§€
                    if (appliedVal) {
                        resolvedStructure[key] = appliedVal;
                    } else if (existingVal) {
                        resolvedStructure[key] = existingVal;
                    }
                });
            }
            const finalText = structureToMultilineText(resolvedStructure) || defaultPrompt || '';
            finalPromptText.value = finalText;
            finalPromptSection.style.display = 'block';
            
            // ìŠ¤í¬ë¡¤í•˜ì—¬ ê²°ê³¼ ë³´ì—¬ì£¼ê¸°
            finalPromptSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // ì˜ˆì‹œ í”„ë¡¬í”„íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜
        function loadExamplePrompt() {
            const examplePrompt = `STYLE: 3D animation, Pixar/Disney style render; MEDIUM: CGI 3D animation; CAMERA: wide shot, eye level, professional studio scene; SUBJECT: stick figure character relaxing in director's chair, wearing oversized sunglasses holding whiskey glass, feet up on ottoman, confident relaxed pose; CHARACTER: simple stick figure with round head, thin black line body and limbs, comically oversized designer sunglasses, minimalist yet expressive, wearing suggested white shirt collar and dark pants through simple lines; FURNITURE: plush brown leather director's chair with rounded arms, matching ottoman footrest, luxurious vintage style; PROPS: crystal whiskey glass in stick hand, professional film cameras on tripods, C-stands with lights, reflectors, boom mics, cables on floor; AI ROBOTS: multiple cute robot assistants busily working around studio, one adjusting camera angle, another holding reflector, one operating boom mic, small wheeled robot managing cables, drone robot adjusting overhead light, all with glowing LED eyes and metallic finish; LIGHTING: dramatic studio lighting setup, warm key lights creating amber glow, cool blue fill lights for contrast, multiple light sources visible including softboxes and LED panels, professional photography setup; ENVIRONMENT: professional film studio with visible ceiling grid, white cyc wall, equipment cases, monitors showing footage, busy production atmosphere; ATMOSPHERE: humorous contrast between simple stick figure star and high-tech AI crew, behind-the-scenes movie production vibe, warm and cool color contrast; QUALITY: highly detailed 3D render, professional lighting, cinematic composition --ar 16:9 --v 6`;
            
            // í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸°ì— ì„¤ì •
            promptPreview.textContent = examplePrompt;
            promptPreview.classList.add('has-content');
            promptData.textInput = examplePrompt;
            
            // êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ë¡œ íŒŒì‹±í•˜ì—¬ ì¹´ë“œ ìƒì„±
            promptData.structuredPrompt = parsePrompt(examplePrompt);
            createPromptCards(promptData.structuredPrompt);
            promptCardsSection.style.display = 'block';
            
            // localStorageì— ì €ì¥
            saveToLocalStorage();
        }

        // í”„ë¡¬í”„íŠ¸ íŒŒì‹± í•¨ìˆ˜ (ì„¸ë¯¸ì½œë¡  ê¸°ë°˜ê³¼ ì¤„ë°”ê¿ˆ ê¸°ë°˜ ëª¨ë‘ ì§€ì›)
        function parsePrompt(text) {
            const structure = {};
            
            // ì „ì²´ í…ìŠ¤íŠ¸ì—ì„œ ëª¨ë“  íŒŒë¼ë¯¸í„° ì¶”ì¶œ (ê°’ì´ ìˆëŠ” í”Œë˜ê·¸ì™€ ë‹¨ì¼ í”Œë˜ê·¸ ëª¨ë‘)
            const params = [];
            const paramPattern = /--[a-zA-Z0-9_-]+(?:\s+[^\s;\n]+)?/g;
            let match;
            while ((match = paramPattern.exec(text)) !== null) {
                params.push(match[0]);
            }
            
            // íŒŒë¼ë¯¸í„°ë¥¼ í…ìŠ¤íŠ¸ì—ì„œ ì œê±°
            let cleanText = text;
            params.forEach(param => {
                cleanText = cleanText.replace(param, '').replace(/\s{2,}/g, ' ');
            });
            
            // ì¤„ë°”ê¿ˆì´ ìˆìœ¼ë©´ ì¤„ë°”ê¿ˆ ê¸°ë°˜ìœ¼ë¡œ, ì—†ìœ¼ë©´ ì„¸ë¯¸ì½œë¡  ê¸°ë°˜ìœ¼ë¡œ íŒŒì‹±
            let lines;
            if (cleanText.includes('\n')) {
                // ì¤„ë°”ê¿ˆ ê¸°ë°˜ íŒŒì‹±
                lines = cleanText.split('\n').map(line => line.trim()).filter(line => line);
                // ê° ì¤„ì—ì„œ ëì˜ ì„¸ë¯¸ì½œë¡  ì œê±°
                lines = lines.map(line => line.endsWith(';') ? line.slice(0, -1).trim() : line);
            } else {
                // ì„¸ë¯¸ì½œë¡  ê¸°ë°˜ íŒŒì‹±
                lines = cleanText.split(';').map(line => line.trim()).filter(line => line);
            }
            
            lines.forEach(line => {
                const colonIndex = line.indexOf(':');
                if (colonIndex > -1) {
                    const key = line.substring(0, colonIndex).trim();
                    const value = line.substring(colonIndex + 1).trim();
                    if (key.toUpperCase() !== 'PARAMETERS' || params.length === 0) {
                        structure[key] = value;
                    }
                }
            });
            
            // íŒŒë¼ë¯¸í„° ì €ì¥ (ìˆì„ ë•Œë§Œ)
            if (params.length > 0) {
                structure['PARAMETERS'] = params.join(' ');
            }
            
            return structure;
        }

        // í”„ë¡¬í”„íŠ¸ í–¥ìƒ í•¨ìˆ˜
        function enhancePrompt(text) {
            // êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ì¸ì§€ í™•ì¸
            if (text.includes(':') && text.includes(';')) {
                return text; // ì´ë¯¸ êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ëŠ” ê·¸ëŒ€ë¡œ ë°˜í™˜
            }
            
            // ê¸°ë³¸ í–¥ìƒ í‚¤ì›Œë“œ
            const enhancements = {
                quality: 'highly detailed, 4k, professional',
                style: 'cinematic lighting, photorealistic',
                camera: 'rule of thirds composition',
            };

            let enhanced = text;
            
            // í’ˆì§ˆ ê´€ë ¨ í‚¤ì›Œë“œê°€ ì—†ìœ¼ë©´ ì¶”ê°€
            if (!text.toLowerCase().includes('detailed') && !text.toLowerCase().includes('quality')) {
                enhanced += ', ' + enhancements.quality;
            }

            return enhanced;
        }

        // êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ë¥¼ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜
        function structureToText(structure) {
            let text = '';
            const params = structure['PARAMETERS'] || '';
            const keys = Object.keys(structure).filter(key => key !== 'PARAMETERS');
            
            keys.forEach((key, index) => {
                if (structure[key]) { // ê°’ì´ ìˆëŠ” ê²½ìš°ë§Œ ì¶”ê°€
                    text += `${key}: ${structure[key]}`;
                    if (index < keys.length - 1) {
                        text += '; ';
                    }
                }
            });
            
            if (params) {
                text += ` PARAMETERS: ${params}`;
            }
            
            return text;
        }

        // êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ë¥¼ ë³´ê¸° ì¢‹ê²Œ ì¤„ë°”ê¿ˆëœ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜
        function structureToMultilineText(structure) {
            const lines = [];
            const params = structure['PARAMETERS'] || '';
            const keys = Object.keys(structure).filter(key => key !== 'PARAMETERS');
            keys.forEach(key => {
                if (structure[key]) {
                    lines.push(`${key}: ${structure[key]};`);
                }
            });
            if (params) {
                lines.push(`PARAMETERS: ${params}`);
            }
            return lines.join('\n');
        }

        // í˜„ì¬ í™œì„±í™”ëœ êµ¬ì¡° íƒ­
        let currentStructureTab = 'character';
        
        // êµ¬ì¡° íƒ­ ì „í™˜ í•¨ìˆ˜
        function switchStructureTab(tab) {
            currentStructureTab = tab;
            document.getElementById('structure-tab-character').classList.toggle('active', tab === 'character');
            document.getElementById('structure-tab-general').classList.toggle('active', tab === 'general');
            
            // í˜„ì¬ í”„ë¡¬í”„íŠ¸ ë°ì´í„°ë¡œ ì¹´ë“œ ì¬ìƒì„±
            if (Object.keys(promptData.structuredPrompt).length > 0) {
                createPromptCards(promptData.structuredPrompt);
            }
        }
        
        // ìºë¦­í„° í•˜ìœ„ íƒ­ ì „í™˜ í•¨ìˆ˜
        function switchCharacterSubTab(categoryIndex) {
            // ìºë¦­í„° íƒ­ ë‚´ì—ì„œë§Œ ì‘ë™í•˜ë„ë¡ ë²”ìœ„ ì œí•œ
            const characterContainer = document.querySelector('.character-container');
            if (!characterContainer) return;
            
            // ëª¨ë“  í•˜ìœ„ íƒ­ ë²„íŠ¼ì˜ active í´ë˜ìŠ¤ ì œê±°
            characterContainer.querySelectorAll('.sub-tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // í´ë¦­ëœ íƒ­ ë²„íŠ¼ì— active í´ë˜ìŠ¤ ì¶”ê°€
            characterContainer.querySelector(`.sub-tab-button[data-category="${categoryIndex}"]`)?.classList.add('active');
            
            // ëª¨ë“  ì»¨í…ì¸  ìˆ¨ê¹€
            characterContainer.querySelectorAll('.sub-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ì„ íƒëœ ì»¨í…ì¸ ë§Œ í‘œì‹œ
            characterContainer.querySelector(`.sub-tab-content[data-category="${categoryIndex}"]`)?.classList.add('active');
        }
        
        // ì¼ë°˜ í•˜ìœ„ íƒ­ ì „í™˜ í•¨ìˆ˜
        function switchGeneralSubTab(categoryIndex) {
            // ì¼ë°˜ íƒ­ ë‚´ì—ì„œë§Œ ì‘ë™í•˜ë„ë¡ ë²”ìœ„ ì œí•œ
            const generalContainer = document.querySelector('.general-container');
            if (!generalContainer) return;
            
            // ëª¨ë“  í•˜ìœ„ íƒ­ ë²„íŠ¼ì˜ active í´ë˜ìŠ¤ ì œê±°
            generalContainer.querySelectorAll('.sub-tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // í´ë¦­ëœ íƒ­ ë²„íŠ¼ì— active í´ë˜ìŠ¤ ì¶”ê°€
            generalContainer.querySelector(`.sub-tab-button[data-category="${categoryIndex}"]`)?.classList.add('active');
            
            // ëª¨ë“  ì»¨í…ì¸  ìˆ¨ê¹€
            generalContainer.querySelectorAll('.sub-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ì„ íƒëœ ì»¨í…ì¸ ë§Œ í‘œì‹œ
            generalContainer.querySelector(`.sub-tab-content[data-category="${categoryIndex}"]`)?.classList.add('active');
        }
        
        // ì¹´ë“œ ìƒì„± í•¨ìˆ˜
        function createPromptCards(structure) {
            promptCardsGrid.innerHTML = '';
            
            // ìºë¦­í„° íƒ­ ì¹´í…Œê³ ë¦¬ (ì´ë¯¸ì§€ ê¸°ì¤€)
            // ìŠ¤íƒ€ì¼ ì˜µì…˜ ëª©ë¡
        // ìŠ¤íƒ€ì¼ ì˜µì…˜ ëª©ë¡ (2025 Midjourney v7 ìµœì‹  ì—…ë°ì´íŠ¸)
        const styleOptions = [
            // í¬í† ê·¸ë˜í”¼ & ì‹œë„¤ë§ˆí‹±
            "Aerial", "Analog", "Cinematic", "Documentary", "Drone", "HDR", "High Key", 
            "Infrared", "Light Painting", "Lo-fi", "Low Key", "Macro", "Nightscapes", 
            "Noir", "Photorealistic", "Polaroid", "Portrait", "Vintage", "Film Noir",
            "Anamorphic", "Split Toning", "Film Emulation", "Kodak Vision", "Fujifilm",
            // ì‹¤ì „ MJ ìµœì í™” í¬í†  ì¥ë¥´
            "Studio Portrait", "Beauty Shot", "Fashion Editorial", "Product Photography",
            "Street Photography", "Architectural Photography", "Landscape", "Food Photography",
            "Still Life",
            
            // 2025 íŠ¸ë Œë“œ ë¯¸í•™
            "Y2K Aesthetic", "McBling", "Dreamcore", "Weirdcore", "Liminal Space", 
            "Dark Academia", "Cottagecore", "Vaporwave", "Synthwave", "Webcore",
            "Glitchcore", "Traumacore", "Nostalgiacore", "Blobitecture",
            
            // V7 íŠ¹í™” ìŠ¤íƒ€ì¼ (íŒŒë¼ë¯¸í„°/í’ˆì§ˆ ì„±ê²© ì œê±°)
            "Hyperrealistic", "Hyperdetailed", "Photorealism",
            
            // ë””ì§€í„¸ ì•„íŠ¸
            "3D Render", "8-bit Art", "CGI", "Cyberpunk", "Digital Painting", 
            "Fractal Art", "Generative Art", "Glitch Art", "Graffiti Art", "Isometric", 
            "Low Poly", "Minimalism", "Neon Art", "Pixel Art", 
            "Vector Art", "Voxel Art", "Flat Design", "Material Design",
            
            // ì¼ëŸ¬ìŠ¤íŠ¸ë ˆì´ì…˜
            "Anime Style", "Cartoon", "Chibi", "Children's Book", "Comic Book", 
            "Concept Art", "Disney Style", "Fantasy Illustration", "Graphic Novel", 
            "Manga", "Pixar", "Studio Ghibli", "Sketch Style", "Papercut Illustration", 
            "Line Art", "Whimsical", "Editorial Illustration",
            
            // ì „í†µ ì˜ˆìˆ 
            "Acrylic Painting", "Anatomical Drawing", "Charcoal", "Chinese Ink Painting", 
            "Etching", "Gouache Painting", "Ink Drawing", "Korean Minhwa", "Oil Painting", 
            "Pastel Drawing", "Pencil Sketch", "Persian Miniature", "Sumi-e", "Ukiyo-e", 
            "Watercolor", "Fresco", "Tempera",
            
            // ì˜ˆìˆ  ìš´ë™
            "Abstract", "Art Deco", "Art Nouveau", "Baroque", "Bauhaus", "Brutalism",
            "Cubism", "Dadaism", "Expressionism", "Fauvism", "Gothic", "Impressionism", 
            "Minimalistic", "Neo-Expressionism", "Pointillism", "Pop Art", "Renaissance", 
            "Rococo", "Romanticism", "Suprematism", "Surrealism", "Symbolism",
            
            // íŠ¹ìˆ˜ íš¨ê³¼ & ê¸°íƒ€
            "Collage", "Dark Fantasy", "Double Exposure", "Fantasy", "Horror", 
            "Installation", "Psychedelic", "Retro", "Retro-Futurism", "Sacred Geometry", 
            "Sci-Fi", "Stained Glass", "Steampunk", "Technical Drawing"
        ];

        // ê° ì„¹ì…˜ë³„ ë“œë¡­ë‹¤ìš´ ì˜µì…˜
        const dropdownOptions = {
            STYLE: styleOptions,
            MEDIUM: [
                // V7 ë””ì§€í„¸ ë§¤ì²´
                "AI Generated", "Neural Art", "GAN Art", "Diffusion Model", "Stable Diffusion",
                "Photorealistic Render", "Hyperrealistic CG", "Unreal Engine 5", "Unity HDRP", "Octane Render",
                "Redshift Render", "V-Ray", "Arnold Render", "Cycles Render", "RTX Ray Tracing",
                // ì „í†µ ë§¤ì²´
                "Oil Painting", "Watercolor", "Acrylic", "Gouache", "Tempera", "Encaustic", "Fresco",
                "Pencil Drawing", "Graphite", "Charcoal", "Conte", "Silverpoint", "Ink Drawing", "Pen and Ink",
                "Pastel", "Oil Pastel", "Soft Pastel", "Chalk", "Crayon", "Colored Pencil",
                // ì‚¬ì§„ ë§¤ì²´
                "Digital Photography", "Film Photography", "35mm Film", "Medium Format", "Large Format",
                "Instant Photography", "Polaroid", "Daguerreotype", "Cyanotype", "Tintype",
                // í˜¼í•© ë§¤ì²´
                "Mixed Media", "Collage", "Digital Collage", "Photo Manipulation", "Photobashing",
                "3D Sculpture", "Digital Sculpture", "ZBrush", "Procedural Art", "Algorithmic Art",
                // íŠ¹ìˆ˜ ë§¤ì²´
                "Holography", "VR Art", "AR Art", "NFT Art", "Generative Art", "Interactive Art",
                "Video Art", "Projection Mapping", "Light Installation", "Sound Visualization"
            ],
            'ERA/CULTURAL_REF': [
                // 2025 íŠ¸ë Œë“œ ì‹œëŒ€
                "Y2K Revival", "2000s Nostalgia", "McBling Era", "Indie Sleaze", "2010s Tumblr Era",
                "Vaporwave Era", "Synthwave Era", "Retrowave", "Outrun", "Dark Academia Period",
                "Light Academia", "Cottagecore Era", "Goblincore", "Fairycore", "Angelcore",
                // ì—­ì‚¬ì  ì‹œëŒ€
                "Ancient Egypt", "Ancient Greece", "Ancient Rome", "Byzantine", "Medieval", "Renaissance",
                "Baroque Period", "Rococo", "Victorian Era", "Edwardian Era", "Art Nouveau Era",
                "Art Deco Era", "Roaring Twenties", "Great Depression", "World War II Era",
                // í˜„ëŒ€ ì‹œëŒ€
                "1950s Americana", "1960s Mod", "1970s Disco", "1980s Neon", "1990s Grunge",
                "2000s Digital", "2010s Minimalism", "2020s Post-Pandemic", "Contemporary", "Near Future",
                // ëŒ€ì•ˆ ì—­ì‚¬/ë¯¸ë˜
                "Cyberpunk 2077", "Steampunk Victorian", "Dieselpunk", "Atompunk", "Biopunk",
                "Solarpunk", "Lunarpunk", "Desertpunk", "Oceanpunk", "Forestpunk",
                // ë¬¸í™”ì  ì°¸ì¡°
                "Japanese Edo Period", "Chinese Dynasty", "Korean Joseon", "Indian Mughal",
                "Islamic Golden Age", "African Kingdoms", "Pre-Columbian", "Native American",
                "Scandinavian Viking", "Celtic", "Slavic", "Mediterranean"
            ],
            SCENE: [
                "Daily Life", "Celebration", "Action Scene", "Quiet Moment", "Romantic Scene", 
                "Battle Scene", "Peaceful Scene", "Dramatic Moment", "Comedy Scene", "Horror Scene",
                "Fantasy Scene", "Sci-fi Scene", "Historical Scene", "Urban Scene", "Nature Scene",
                "Indoor Scene", "Outdoor Scene", "Night Scene", "Day Scene", "Sunset/Sunrise Scene"
            ],
            COLOR_TONE: [
                // V7 ìƒ‰ìƒ íŒ”ë ˆíŠ¸
                "Vibrant Colors", "Muted Colors", "Pastel Colors", "Neon Colors", "Fluorescent", "Bioluminescent",
                "Monochromatic", "Duotone", "Tritone", "Multitone", "Black and White", "Grayscale",
                // ìƒ‰ì˜¨ë„
                "Warm Tones", "Cool Tones", "Neutral Tones", "Earth Tones", "Jewel Tones", "Candy Colors",
                "Ice Colors", "Fire Colors", "Ocean Colors", "Forest Colors", "Desert Colors", "Sky Colors",
                // ìƒ‰ìƒ ì¡°í™”
                "Complementary Colors", "Analogous Colors", "Triadic Colors", "Tetradic Colors",
                "Split Complementary", "Double Complementary", "Square Color Scheme", "Monochromatic Harmony",
                // íŠ¹ìˆ˜ ìƒ‰ìƒ
                "Metallic", "Gold", "Silver", "Bronze", "Copper", "Chrome", "Iridescent", "Holographic",
                "Gradient", "Rainbow", "Prismatic", "Opalescent", "Pearlescent", "Luminescent",
                // ì½˜íŠ¸ë¼ìŠ¤íŠ¸
                "High Contrast", "Low Contrast", "Medium Contrast", "Soft Contrast", "Hard Contrast",
                // ë¹ˆí‹°ì§€ ìƒ‰ìƒ
                "Sepia", "Vintage Film", "Faded Colors", "Retro Colors", "Kodachrome", "Technicolor"
            ],
            CHARACTER: [
                "Main Character", "Supporting Character", "Background Character", "Hero", "Villain",
                "Mentor", "Sidekick", "Love Interest", "Comic Relief", "Mysterious Figure",
                "Child", "Teenager", "Adult", "Elderly", "Male", "Female", "Non-binary", "Robot", "Alien"
            ],
            CHARACTER_SHEET: [
                "Full Body Reference", "Turn Around", "Expression Sheet", "Costume Design", "Detail Sheet",
                "Action Poses", "Idle Pose", "Portrait", "Profile View", "Three Quarter View", "Back View"
            ],
            BODY_TYPE: [
                "Slim", "Athletic", "Muscular", "Average", "Curvy", "Petite", "Tall", "Short", "Stocky",
                "Lean", "Bulky", "Toned", "Soft", "Angular", "Round", "Hourglass", "Pear-shaped", "V-shaped"
            ],
            HAIR: [
                "Long", "Short", "Medium", "Wavy", "Straight", "Curly", "Braided", "Ponytail", "Bun",
                "Pixie Cut", "Bob Cut", "Undercut", "Mohawk", "Afro", "Dreadlocks", "Bald", "Buzz Cut",
                "Flowing", "Messy", "Neat", "Styled", "Natural", "Colored", "Highlighted", "Ombre"
            ],
            FACE_SHAPE: [
                "Oval", "Round", "Square", "Heart", "Diamond", "Oblong", "Triangle", "Rectangular"
            ],
            FACIAL_FEATURES: [
                "Sharp", "Soft", "Angular", "Round", "Defined", "Delicate", "Strong", "Gentle",
                "Prominent Cheekbones", "Dimples", "Freckles", "Beauty Mark", "Scar", "Wrinkles",
                "Smooth Skin", "Beard", "Mustache", "Goatee", "Clean Shaven", "Stubble"
            ],
            SKIN: [
                "Fair", "Light", "Medium", "Tan", "Dark", "Pale", "Olive", "Warm Tone", "Cool Tone",
                "Freckled", "Clear", "Glowing", "Matte", "Dewy", "Dry", "Oily", "Textured", "Smooth"
            ],
            EXPRESSION: [
                "Happy", "Sad", "Angry", "Surprised", "Fearful", "Disgusted", "Neutral", "Confident",
                "Shy", "Excited", "Bored", "Thoughtful", "Worried", "Relaxed", "Determined", "Confused",
                "Amused", "Annoyed", "Curious", "Proud", "Embarrassed", "Hopeful", "Disappointed"
            ],
            GAZE: [
                "Direct", "Averted", "Downward", "Upward", "Side Glance", "Over Shoulder", "Closed Eyes",
                "Half-lidded", "Wide Open", "Squinting", "Winking", "Rolling Eyes", "Staring", "Dreamy"
            ],
            CLOTHING: [
                "Casual", "Formal", "Business", "Sport", "Traditional", "Modern", "Vintage", "Futuristic",
                "Fantasy", "Military", "School Uniform", "Work Uniform", "Costume", "Armor", "Dress",
                "Suit", "Jeans and T-shirt", "Hoodie", "Jacket", "Coat", "Sweater", "Shorts", "Skirt"
            ],
            ACCESSORIES: [
                "Glasses", "Sunglasses", "Hat", "Cap", "Headband", "Earrings", "Necklace", "Bracelet",
                "Ring", "Watch", "Belt", "Scarf", "Gloves", "Bag", "Backpack", "Jewelry", "Tattoo",
                "Piercing", "Mask", "Crown", "Tiara", "Badge", "Pin"
            ],
            PROPS: [
                "Weapon", "Tool", "Book", "Phone", "Computer", "Bag", "Umbrella", "Cane", "Staff",
                "Musical Instrument", "Sports Equipment", "Food", "Drink", "Flower", "Key", "Map",
                "Scroll", "Crystal", "Orb", "Potion", "Artifact", "Device"
            ],
            POSE: [
                "Standing", "Sitting", "Walking", "Running", "Jumping", "Flying", "Fighting", "Dancing",
                "Relaxed", "Tense", "Dynamic", "Static", "Action Pose", "Rest Pose", "Hero Pose",
                "Dramatic Pose", "Casual Pose", "Formal Pose", "Combat Stance", "Defensive Stance"
            ],
            CAMERA: [
                // V7 ì¹´ë©”ë¼ ì•µê¸€
                "Eye Level", "High Angle", "Low Angle", "Dutch Angle", "Bird's Eye View", "Worm's Eye View",
                "Aerial View", "Overhead Shot", "Ground Level", "Shoulder Level", "Hip Level", "Knee Level",
                // ìƒ· íƒ€ì…
                "Extreme Wide Shot", "Wide Shot", "Medium Wide Shot", "Medium Shot", "Medium Close-up",
                "Close-up", "Extreme Close-up", "Macro Shot", "Detail Shot", "Insert Shot",
                // ì¹´ë©”ë¼ ë¬´ë¸Œë¨¼íŠ¸
                "Static Shot", "Pan Left", "Pan Right", "Tilt Up", "Tilt Down", "Tracking Shot",
                "Dolly In", "Dolly Out", "Crane Shot", "Steadicam", "Handheld", "Gimbal Shot",
                // íŠ¹ìˆ˜ ìƒ·
                "Over the Shoulder", "Point of View (POV)", "Reverse Shot", "Two Shot", "Three Shot",
                "Group Shot", "Establishing Shot", "Master Shot", "Cutaway", "Reaction Shot",
                // ì‹œë„¤ë§ˆí‹± ê¸°ë²•
                "Split Screen", "Match Cut", "Cross-cutting", "Jump Cut", "Whip Pan", "Rack Focus",
                "Pull Focus", "Deep Focus", "Shallow Focus", "Selective Focus",
                // MJì—ì„œ ìì£¼ ì“°ëŠ” ë Œì¦ˆ/ê±°ë¦¬ê° í‚¤ì›Œë“œ
                "Ultra Wide", "Wide Angle", "Standard Lens", "Telephoto", "Macro",
                "Close-up Portrait", "Headshot", "Full Body Shot"
            ],
            CAMERA_EFFECTS: [
                // V7 ë Œì¦ˆ íš¨ê³¼
                "Bokeh", "Depth of Field", "Shallow DOF", "Deep DOF", "Focus Stacking", "Tilt Shift",
                "Lens Flare", "Chromatic Aberration", "Vignetting", "Barrel Distortion", "Pincushion Distortion",
                // ë¸”ëŸ¬ íš¨ê³¼
                "Motion Blur", "Gaussian Blur", "Radial Blur", "Zoom Blur", "Spin Blur", "Path Blur",
                "Field Blur", "Iris Blur", "Tilt-Shift Blur", "Surface Blur", "Box Blur",
                // íŠ¹ìˆ˜ ë Œì¦ˆ
                "Fish Eye", "Ultra Wide Angle", "Wide Angle", "Normal Lens", "Telephoto", "Super Telephoto",
                "Macro Lens", "Anamorphic", "Lensbaby", "Tilt-Shift Lens", "Periscope Lens",
                // í•„í„° íš¨ê³¼
                "ND Filter", "Polarizing Filter", "UV Filter", "Graduated Filter", "Color Filter",
                "Infrared Filter", "Star Filter", "Prism Filter", "Kaleidoscope", "Crystal Filter",
                // ì˜ˆìˆ ì  íš¨ê³¼
                "Double Exposure", "Multiple Exposure", "Long Exposure", "Light Trails", "Star Trails",
                "HDR Effect", "Orton Effect", "Dragan Effect", "Harris Shutter", "Solarization"
            ],
            CAMERA_TECH: [
                // ì¹´ë©”ë¼ ë¸Œëœë“œ ë° ëª¨ë¸
                "Canon EOS R5", "Canon 5D Mark IV", "Nikon Z9", "Nikon D850", "Sony A7R V", "Sony FX3",
                "Fujifilm GFX 100 II", "Hasselblad X2D", "Leica M11", "Panasonic S5 II", "RED V-Raptor",
                "ARRI Alexa", "Blackmagic URSA", "iPhone 15 Pro", "Google Pixel 8 Pro",
                // ì¹´ë©”ë¼ íƒ€ì…
                "DSLR", "Mirrorless", "Medium Format", "Large Format", "Full Frame", "APS-C", "Micro Four Thirds",
                "Film Camera", "35mm Film", "120 Film", "4x5 Film", "8x10 Film", "Instant Camera",
                // íŠ¹ìˆ˜ ì¹´ë©”ë¼
                "Drone Camera", "Action Camera", "360 Camera", "Light Field Camera", "Thermal Camera",
                "High Speed Camera", "Time-lapse Camera", "Pinhole Camera", "Tilt-Shift Camera",
                // ë Œì¦ˆ ì •ë³´
                "Prime Lens", "Zoom Lens", "24mm", "35mm", "50mm", "85mm", "135mm", "200mm", "400mm",
                "14-24mm", "24-70mm", "70-200mm", "100-400mm", "f/1.2", "f/1.4", "f/1.8", "f/2.8"
            ],
            LOCATION: [
                "City Street", "Forest", "Beach", "Mountain", "Desert", "Ocean", "Lake", "River",
                "Park", "Garden", "Castle", "Palace", "House", "Apartment", "Office", "School",
                "Hospital", "Restaurant", "Cafe", "Shop", "Mall", "Station", "Airport", "Harbor",
                "Bridge", "Tunnel", "Road", "Highway", "Alley", "Rooftop", "Underground", "Space",
                "Fantasy World", "Alien Planet", "Underwater", "Sky", "Cloud City", "Floating Island"
            ],
            LOCATION_DETAIL: [
                "Cozy Corner", "Open Space", "Narrow Path", "Wide Area", "Hidden Spot", "Central Area",
                "Edge/Border", "Entrance", "Exit", "Main Hall", "Side Room", "Basement", "Attic",
                "Balcony", "Terrace", "Courtyard", "Backyard", "Front Yard", "Parking Lot", "Lobby"
            ],
            TIME_LIGHTING: [
                "Dawn", "Early Morning", "Morning", "Noon", "Afternoon", "Late Afternoon", "Dusk",
                "Evening", "Night", "Midnight", "Blue Hour", "Golden Hour", "Magic Hour", "Overcast",
                "Sunny", "Cloudy", "Rainy", "Snowy", "Foggy", "Misty", "Clear Sky", "Starry Night"
            ],
            ARTIFICIAL_LIGHT: [
                "Neon Lights", "Street Lamp", "Candlelight", "Firelight", "Torch Light", "LED Light",
                "Fluorescent", "Incandescent", "Spotlight", "Stage Lights", "Studio Lighting", "Flash",
                "Laser Light", "Hologram", "Projector Light", "Emergency Light", "Fairy Lights", "Lantern"
            ],
            ATMOSPHERE: [
                "Mysterious", "Romantic", "Tense", "Peaceful", "Chaotic", "Serene", "Energetic",
                "Melancholic", "Joyful", "Scary", "Dreamy", "Realistic", "Surreal", "Nostalgic",
                "Futuristic", "Ancient", "Modern", "Timeless", "Ethereal", "Gritty", "Whimsical",
                "Liminal", "Uncanny", "Dreamcore", "Weirdcore", "Vaporwave", "Dark Academia",
                "Cottagecore", "Cyberpunk", "Dystopian", "Utopian", "Apocalyptic", "Mystical",
                "Haunting", "Enchanting", "Unsettling", "Comforting", "Alienating", "Intimate"
            ],
            WEATHER: [
                "Clear", "Sunny", "Cloudy", "Partly Cloudy", "Overcast", "Rainy", "Heavy Rain",
                "Drizzle", "Stormy", "Thunder", "Lightning", "Snowy", "Blizzard", "Hail", "Foggy",
                "Misty", "Windy", "Hurricane", "Tornado", "Rainbow", "Aurora"
            ],
            FOREGROUND: [
                "Empty", "Minimal", "Detailed", "Objects", "Characters", "Nature Elements", "Architecture",
                "Vehicles", "Props", "Debris", "Foliage", "Water", "Rocks", "Sand", "Snow"
            ],
            BACKGROUND: [
                "Simple", "Complex", "Blurred", "Detailed", "Abstract", "Realistic", "Gradient",
                "Pattern", "Textured", "Plain", "Busy", "Minimalist", "Scenic", "Urban", "Natural"
            ],
            LIGHTING: [
                "Natural Light", "Artificial Light", "Mixed Lighting", "Soft Light", "Hard Light",
                "Directional", "Ambient", "Diffused", "Backlit", "Side Lit", "Front Lit", "Top Lit",
                "Bottom Lit", "Rim Light", "Key Light", "Fill Light", "Three Point Lighting"
            ],
            LIGHTING_TECHNIQUE: [
                // V7 ì¡°ëª… ê¸°ìˆ 
                "Volumetric Lighting", "Ray Tracing", "Global Illumination", "Path Tracing", "Subsurface Scattering",
                "Caustics", "Bloom Effect", "Light Leaks", "Lens Flare", "Bokeh Lighting",
                "HDRI Lighting", "IBL (Image Based Lighting)", "PBR Lighting", "Unreal Engine 5 Lumen",
                // í´ë˜ì‹ ì¡°ëª…
                "Rembrandt Lighting", "Butterfly Lighting", "Split Lighting", "Rim Lighting", "Loop Lighting",
                "Broad Lighting", "Short Lighting", "Natural Lighting", "Studio Lighting", "Golden Hour",
                "Blue Hour", "High Key", "Low Key", "Chiaroscuro", "Ambient Occlusion",
                // ì‹œë„¤ë§ˆí‹± ì¡°ëª…
                "Cinematic Lighting", "Film Noir Lighting", "Neon Lighting", "Candlelight", "Firelight",
                "Moonlight", "Starlight", "Northern Lights", "Bioluminescence", "Blacklight",
                // íŠ¹ìˆ˜ íš¨ê³¼ ì¡°ëª…
                "Holographic Lighting", "Prismatic Light", "Iridescent Lighting", "Chromatic Aberration", "Light Painting",
                "Backlighting", "Silhouette", "Contre-jour", "Tyndall Effect", "God Rays"
            ],
            QUALITY: [
                // V7 í’ˆì§ˆ ì„¤ì •
                "--q 0.25", "--q 0.5", "--q 1", "--q 2", "--raw", "--turbo", "--fast", "--relax",
                // í•´ìƒë„
                "16K", "8K", "4K", "2K", "HD", "Ultra HD", "Full HD", "QHD", "UHD", "FHD",
                // ë””í…Œì¼ ë ˆë²¨
                "Hyperdetailed", "Ultra Detailed", "Highly Detailed", "Intricately Detailed",
                "Photorealistic", "Hyperrealistic", "Ultra Realistic", "Extreme Detail",
                // í¬ì»¤ìŠ¤
                "Sharp Focus", "Soft Focus", "Selective Focus", "Deep Focus", "Shallow Depth of Field",
                "Bokeh", "Motion Blur", "Gaussian Blur", "Tilt Shift", "Focus Stacking",
                // í…ìŠ¤ì²˜
                "Crystal Clear", "Crisp", "Clean", "Polished", "Refined", "Raw", "Unprocessed",
                "Film Grain", "Digital Noise", "Pristine", "Professional", "Studio Quality",
                // V7 íŠ¹ìˆ˜ ëª¨ë“œ
                "Raw Mode", "Draft Mode", "Style Raw"
            ],
            PARAMETERS: [
                // V7 íŒŒë¼ë¯¸í„°
                "--v 7", "--ar 16:9", "--ar 9:16", "--ar 1:1", "--ar 4:3", "--ar 3:2", "--ar 21:9",
                "--chaos 0", "--chaos 25", "--chaos 50", "--chaos 75", "--chaos 100",
                "--stylize 0", "--stylize 100", "--stylize 250", "--stylize 500", "--stylize 750", "--stylize 1000",
                "--weird 0", "--weird 250", "--weird 500", "--weird 750", "--weird 1000", "--weird 3000",
                // ìŠ¤íƒ€ì¼ ì°¸ì¡°
                "--sref", "--sw 0", "--sw 100", "--sw 250", "--sw 500", "--sw 750", "--sw 1000",
                "--sv 1", "--sv 2", "--sv 3", "--sv 4",
                // ì´ë¯¸ì§€ ì°¸ì¡°
                "--iw 0.5", "--iw 1", "--iw 2", "--cref", "--cw 0", "--cw 100",
                // ê¸°íƒ€ V7 íŒŒë¼ë¯¸í„°
                "--no", "--seed", "--stop", "--tile", "--repeat", "--video", "--style raw",
                // ë””í…Œì¼ ì„¤ì • (íŒŒë¼ë¯¸í„°ê°€ ì•„ë‹Œ ì„¤ëª…ì„± í‚¤ì›Œë“œëŠ” ì œê±°)
            ],
            // ì¼ë°˜ ì´ë¯¸ì§€ íƒ­ìš© ìºë¦­í„° ì˜µì…˜
            CHARACTER_1: [
                "young woman", "young man", "middle-aged woman", "middle-aged man", "elderly woman", "elderly man",
                "teenager", "child", "baby", "toddler", "professional", "student", "artist", "scientist",
                "doctor", "teacher", "engineer", "musician", "athlete", "chef", "police officer", "firefighter",
                "soldier", "pilot", "astronaut", "dancer", "actor", "model", "photographer", "writer"
            ],
            CHARACTER_1_DETAIL: [
                "smiling", "serious", "thoughtful", "confident", "nervous", "excited", "calm", "angry",
                "sad", "happy", "surprised", "focused", "relaxed", "determined", "curious", "worried",
                "casual clothes", "formal wear", "uniform", "traditional dress", "modern fashion", "vintage style",
                "athletic wear", "business suit", "streetwear", "costume", "armor", "robe"
            ],
            CHARACTER_2: [
                "young woman", "young man", "middle-aged woman", "middle-aged man", "elderly woman", "elderly man",
                "teenager", "child", "baby", "toddler", "professional", "student", "artist", "scientist",
                "doctor", "teacher", "engineer", "musician", "athlete", "chef", "police officer", "firefighter",
                "soldier", "pilot", "astronaut", "dancer", "actor", "model", "photographer", "writer"
            ],
            CHARACTER_2_DETAIL: [
                "smiling", "serious", "thoughtful", "confident", "nervous", "excited", "calm", "angry",
                "sad", "happy", "surprised", "focused", "relaxed", "determined", "curious", "worried",
                "casual clothes", "formal wear", "uniform", "traditional dress", "modern fashion", "vintage style",
                "athletic wear", "business suit", "streetwear", "costume", "armor", "robe"
            ],
            CHARACTER_3: [
                "young woman", "young man", "middle-aged woman", "middle-aged man", "elderly woman", "elderly man",
                "teenager", "child", "baby", "toddler", "professional", "student", "artist", "scientist",
                "doctor", "teacher", "engineer", "musician", "athlete", "chef", "police officer", "firefighter",
                "soldier", "pilot", "astronaut", "dancer", "actor", "model", "photographer", "writer"
            ],
            CHARACTER_3_DETAIL: [
                "smiling", "serious", "thoughtful", "confident", "nervous", "excited", "calm", "angry",
                "sad", "happy", "surprised", "focused", "relaxed", "determined", "curious", "worried",
                "casual clothes", "formal wear", "uniform", "traditional dress", "modern fashion", "vintage style",
                "athletic wear", "business suit", "streetwear", "costume", "armor", "robe"
            ],
            CHARACTER_4: [
                "young woman", "young man", "middle-aged woman", "middle-aged man", "elderly woman", "elderly man",
                "teenager", "child", "baby", "toddler", "professional", "student", "artist", "scientist",
                "doctor", "teacher", "engineer", "musician", "athlete", "chef", "police officer", "firefighter",
                "soldier", "pilot", "astronaut", "dancer", "actor", "model", "photographer", "writer"
            ],
            CHARACTER_4_DETAIL: [
                "smiling", "serious", "thoughtful", "confident", "nervous", "excited", "calm", "angry",
                "sad", "happy", "surprised", "focused", "relaxed", "determined", "curious", "worried",
                "casual clothes", "formal wear", "uniform", "traditional dress", "modern fashion", "vintage style",
                "athletic wear", "business suit", "streetwear", "costume", "armor", "robe"
            ],
            CHARACTER_5: [
                "young woman", "young man", "middle-aged woman", "middle-aged man", "elderly woman", "elderly man",
                "teenager", "child", "baby", "toddler", "professional", "student", "artist", "scientist",
                "doctor", "teacher", "engineer", "musician", "athlete", "chef", "police officer", "firefighter",
                "soldier", "pilot", "astronaut", "dancer", "actor", "model", "photographer", "writer"
            ],
            CHARACTER_5_DETAIL: [
                "smiling", "serious", "thoughtful", "confident", "nervous", "excited", "calm", "angry",
                "sad", "happy", "surprised", "focused", "relaxed", "determined", "curious", "worried",
                "casual clothes", "formal wear", "uniform", "traditional dress", "modern fashion", "vintage style",
                "athletic wear", "business suit", "streetwear", "costume", "armor", "robe"
            ]
        };
        
        // ë“œë¡­ë‹¤ìš´ ê°’ì˜ í•œê¸€ ë²ˆì—­ ë§¤í•‘
        const dropdownTranslations = {
            // STYLE translations (partial - will expand)
            // Photography / Cinematic
            "Aerial": "í•­ê³µë·°",
            "Analog": "ì•„ë‚ ë¡œê·¸",
            "Cinematic": "ì‹œë„¤ë§ˆí‹±",
            "Documentary": "ë‹¤íë©˜í„°ë¦¬",
            "Drone": "ë“œë¡ ",
            "HDR": "HDR",
            "High Key": "í•˜ì´í‚¤",
            "Infrared": "ì ì™¸ì„ ",
            "Light Painting": "ë¼ì´íŠ¸ í˜ì¸íŒ…",
            "Lo-fi": "ë¡œíŒŒì´",
            "Low Key": "ë¡œìš°í‚¤",
            "Macro": "ë§¤í¬ë¡œ",
            "Nightscapes": "ì•¼ê²½",
            "Noir": "ëˆ„ì•„ë¥´",
            "Photorealistic": "í¬í† ë¦¬ì–¼ë¦¬ìŠ¤í‹±",
            "Polaroid": "í´ë¼ë¡œì´ë“œ",
            "Portrait": "ì¸ë¬¼ ì‚¬ì§„",
            "Vintage": "ë¹ˆí‹°ì§€",
            "Film Noir": "í•„ë¦„ ëˆ„ì•„ë¥´",
            "Anamorphic": "ì•„ë‚˜ëª¨í”½",
            "Split Toning": "ìŠ¤í”Œë¦¿ í† ë‹",
            "Film Emulation": "í•„ë¦„ ì—ë®¬ë ˆì´ì…˜",
            "Kodak Vision": "ì½”ë‹¥ ë¹„ì „",
            "Fujifilm": "í›„ì§€í•„ë¦„",
            
            // Digital Art
            "3D Render": "3D ë Œë”",
            "8-bit Art": "8ë¹„íŠ¸ ì•„íŠ¸",
            "CGI": "CGI",
            "Cyberpunk": "ì‚¬ì´ë²„í‘í¬",
            "Digital Painting": "ë””ì§€í„¸ í˜ì¸íŒ…",
            "Fractal Art": "í”„ë™íƒˆ ì•„íŠ¸",
            "Generative Art": "ìƒì„± ì˜ˆìˆ ",
            "Glitch Art": "ê¸€ë¦¬ì¹˜ ì•„íŠ¸",
            "Graffiti Art": "ê·¸ë˜í”¼í‹° ì•„íŠ¸",
            "Isometric": "ì•„ì´ì†Œë©”íŠ¸ë¦­",
            "Low Poly": "ë¡œìš°í´ë¦¬",
            "Minimalism": "ë¯¸ë‹ˆë©€ë¦¬ì¦˜",
            "Neon Art": "ë„¤ì˜¨ ì•„íŠ¸",
            "Pixel Art": "í”½ì…€ ì•„íŠ¸",
            "Ray Tracing": "ë ˆì´ íŠ¸ë ˆì´ì‹±",
            "Vector Art": "ë²¡í„° ì•„íŠ¸",
            "Voxel Art": "ë³µì…€ ì•„íŠ¸",
            "Flat Design": "í”Œë« ë””ìì¸",
            "Material Design": "ë¨¸í‹°ë¦¬ì–¼ ë””ìì¸",
            
            // Illustration
            "Anime Style": "ì• ë‹ˆë©”ì´ì…˜ ìŠ¤íƒ€ì¼",
            "Cartoon": "ì¹´íˆ°",
            "Chibi": "ì¹˜ë¹„",
            "Children's Book": "ì•„ë™ ë„ì„œ ìŠ¤íƒ€ì¼",
            "Comic Book": "ì½”ë¯¹ë¶",
            "Concept Art": "ì»¨ì…‰ ì•„íŠ¸",
            "Disney Style": "ë””ì¦ˆë‹ˆ ìŠ¤íƒ€ì¼",
            "Fantasy Illustration": "íŒíƒ€ì§€ ì¼ëŸ¬ìŠ¤íŠ¸",
            "Graphic Novel": "ê·¸ë˜í”½ ë…¸ë¸”",
            "Manga": "ë§Œí™”",
            "Pixar": "í”½ì‚¬ ìŠ¤íƒ€ì¼",
            "Studio Ghibli": "ìŠ¤íŠœë””ì˜¤ ì§€ë¸Œë¦¬",
            "Sketch Style": "ìŠ¤ì¼€ì¹˜ ìŠ¤íƒ€ì¼",
            "Papercut Illustration": "í˜ì´í¼ì»· ì¼ëŸ¬ìŠ¤íŠ¸",
            "Line Art": "ë¼ì¸ ì•„íŠ¸",
            "Whimsical": "ê¸°ë°œí•œ ìŠ¤íƒ€ì¼",
            "Editorial Illustration": "ì—ë””í† ë¦¬ì–¼ ì¼ëŸ¬ìŠ¤íŠ¸",
            
            // Traditional
            "Acrylic Painting": "ì•„í¬ë¦´ í˜ì¸íŒ…",
            "Anatomical Drawing": "í•´ë¶€í•™ ë“œë¡œì‰",
            "Charcoal": "ëª©íƒ„",
            "Chinese Ink Painting": "ì¤‘êµ­ ìˆ˜ë¬µí™”",
            "Etching": "ì—ì¹­",
            "Gouache Painting": "ê³¼ìŠˆ í˜ì¸íŒ…",
            "Ink Drawing": "ì‰í¬ ë“œë¡œì‰",
            "Korean Minhwa": "í•œêµ­ ë¯¼í™”",
            "Oil Painting": "ìœ í™”",
            "Pastel Drawing": "íŒŒìŠ¤í…” ë“œë¡œì‰",
            "Pencil Sketch": "ì—°í•„ ìŠ¤ì¼€ì¹˜",
            "Persian Miniature": "í˜ë¥´ì‹œì•„ ë¯¸ë‹ˆì–´ì²˜",
            "Sumi-e": "ìŠ¤ë¯¸ì—",
            "Ukiyo-e": "ìš°í‚¤ìš”ì—",
            "Watercolor": "ìˆ˜ì±„í™”",
            "Fresco": "í”„ë ˆìŠ¤ì½”",
            "Tempera": "í…œí˜ë¼",
            
            // Art Movements
            "Abstract": "ì¶”ìƒ",
            "Art Deco": "ì•„ë¥´ë°ì½”",
            "Art Nouveau": "ì•„ë¥´ëˆ„ë³´",
            "Baroque": "ë°”ë¡œí¬",
            "Bauhaus": "ë°”ìš°í•˜ìš°ìŠ¤",
            "Brutalism": "ë¸Œë£¨íƒˆë¦¬ì¦˜",
            "Cubism": "íë¹„ì¦˜",
            "Dadaism": "ë‹¤ë‹¤ì´ì¦˜",
            "Expressionism": "í‘œí˜„ì£¼ì˜",
            "Fauvism": "ì•¼ìˆ˜íŒŒ",
            "Gothic": "ê³ ë”•",
            "Impressionism": "ì¸ìƒì£¼ì˜",
            "Minimalistic": "ë¯¸ë‹ˆë©€ë¦¬ìŠ¤íŠ¸",
            "Neo-Expressionism": "ì‹ í‘œí˜„ì£¼ì˜",
            "Pointillism": "ì ë¬˜ì£¼ì˜",
            "Pop Art": "íŒ ì•„íŠ¸",
            "Renaissance": "ë¥´ë„¤ìƒìŠ¤",
            "Rococo": "ë¡œì½”ì½”",
            "Romanticism": "ë‚­ë§Œì£¼ì˜",
            "Suprematism": "ìˆ˜í”„ë ˆë§ˆí‹°ì¦˜",
            "Surrealism": "ì´ˆí˜„ì‹¤ì£¼ì˜",
            "Symbolism": "ìƒì§•ì£¼ì˜",
            
            // Special / Etc
            "Collage": "ì½œë¼ì£¼",
            "Dark Fantasy": "ë‹¤í¬ íŒíƒ€ì§€",
            "Double Exposure": "ë‹¤ì¤‘ ë…¸ì¶œ",
            "Fantasy": "íŒíƒ€ì§€",
            "Horror": "í˜¸ëŸ¬",
            "Installation": "ì„¤ì¹˜ ë¯¸ìˆ ",
            "Psychedelic": "ì‚¬ì´í‚¤ë¸ë¦­",
            "Retro": "ë ˆíŠ¸ë¡œ",
            "Retro-Futurism": "ë ˆíŠ¸ë¡œ í“¨ì²˜ë¦¬ì¦˜",
            "Sacred Geometry": "ì„±ìŠ¤ëŸ¬ìš´ ê¸°í•˜í•™",
            "Sci-Fi": "ê³µìƒê³¼í•™",
            "Stained Glass": "ìŠ¤í…Œì¸ë“œê¸€ë¼ìŠ¤",
            "Steampunk": "ìŠ¤íŒ€í‘í¬",
            "Technical Drawing": "í…Œí¬ë‹ˆì»¬ ë“œë¡œì‰",
            "Studio Portrait": "ìŠ¤íŠœë””ì˜¤ ì¸ë¬¼ ì‚¬ì§„",
            "Beauty Shot": "ë·°í‹° ìƒ·",
            "Fashion Editorial": "íŒ¨ì…˜ ì—ë””í† ë¦¬ì–¼",
            "Product Photography": "ì œí’ˆ ì‚¬ì§„",
            "Street Photography": "ìŠ¤íŠ¸ë¦¬íŠ¸ ì‚¬ì§„",
            "Architectural Photography": "ê±´ì¶• ì‚¬ì§„",
            "Landscape": "í’ê²½ ì‚¬ì§„",
            "Food Photography": "í‘¸ë“œ ì‚¬ì§„",
            "Still Life": "ì •ë¬¼ ì‚¬ì§„",
            "Y2K Aesthetic": "Y2K ë¯¸í•™",
            "McBling": "ë§¥ë¸”ë§",
            "Dreamcore": "ë“œë¦¼ì½”ì–´",
            "Weirdcore": "ìœ„ì–´ë“œì½”ì–´", 
            "Liminal Space": "ë¦¬ë¯¸ë„ ìŠ¤í˜ì´ìŠ¤",
            "Dark Academia": "ë‹¤í¬ ì•„ì¹´ë°ë¯¸ì•„",
            "Cottagecore": "ì½”í‹°ì§€ì½”ì–´",
            "Vaporwave": "ë² ì´í¼ì›¨ì´ë¸Œ",
            "Synthwave": "ì‹ ìŠ¤ì›¨ì´ë¸Œ",
            "Webcore": "ì›¹ì½”ì–´",
            "Hyperrealistic": "ì´ˆí˜„ì‹¤ì ì¸",
            "Hyperdetailed": "ì´ˆì •ë°€í•œ",
            "Raw Mode": "ë¡œìš° ëª¨ë“œ",
            "Draft Mode": "ë“œë˜í”„íŠ¸ ëª¨ë“œ",
            "Photorealism": "í¬í† ë¦¬ì–¼ë¦¬ì¦˜",
            
            // MEDIUM translations
            "AI Generated": "AI ìƒì„±",
            "Neural Art": "ì‹ ê²½ë§ ì•„íŠ¸",
            "GAN Art": "GAN ì•„íŠ¸",
            "Diffusion Model": "í™•ì‚° ëª¨ë¸",
            "Stable Diffusion": "ìŠ¤í…Œì´ë¸” ë””í“¨ì „",
            "Photorealistic Render": "í¬í† ë¦¬ì–¼ë¦¬ìŠ¤í‹± ë Œë”",
            "Hyperrealistic CG": "ì´ˆí˜„ì‹¤ì  CG",
            "Unreal Engine 5": "ì–¸ë¦¬ì–¼ ì—”ì§„ 5",
            "Unity HDRP": "ìœ ë‹ˆí‹° HDRP",
            "Octane Render": "ì˜¥í…Œì¸ ë Œë”",
            "Redshift Render": "ë ˆë“œì‹œí”„íŠ¸ ë Œë”",
            "V-Ray": "V-Ray",
            "Arnold Render": "ì•„ë†€ë“œ ë Œë”",
            "Cycles Render": "ì‚¬ì´í´ìŠ¤ ë Œë”",
            "RTX Ray Tracing": "RTX ë ˆì´ íŠ¸ë ˆì´ì‹±",
            "Oil Painting": "ìœ í™”",
            "Watercolor": "ìˆ˜ì±„í™”",
            "Acrylic": "ì•„í¬ë¦´",
            "Gouache": "ê³¼ìŠˆ",
            "Pencil Drawing": "ì—°í•„ ë“œë¡œì‰",
            "Charcoal": "ëª©íƒ„",
            "Graphite": "í‘ì—°",
            "Conte": "ì½©í…Œ",
            "Silverpoint": "ì‹¤ë²„í¬ì¸íŠ¸",
            "Ink Drawing": "ì‰í¬ ë“œë¡œì‰",
            "Pen and Ink": "íœê³¼ ì‰í¬",
            "Pastel": "íŒŒìŠ¤í…”",
            "Oil Pastel": "ì˜¤ì¼ íŒŒìŠ¤í…”",
            "Soft Pastel": "ì†Œí”„íŠ¸ íŒŒìŠ¤í…”",
            "Chalk": "ë¶„í•„",
            "Crayon": "í¬ë ˆìš©",
            "Colored Pencil": "ìƒ‰ì—°í•„",
            "Digital Photography": "ë””ì§€í„¸ ì‚¬ì§„",
            "Film Photography": "í•„ë¦„ ì‚¬ì§„",
            "35mm Film": "35mm í•„ë¦„",
            "Medium Format": "ì¤‘í˜• í¬ë§·",
            "Large Format": "ëŒ€í˜• í¬ë§·",
            "Instant Photography": "ì¦‰ì„ ì‚¬ì§„",
            "Daguerreotype": "ë‹¤ê²Œë ˆì˜¤íƒ€ì…",
            "Cyanotype": "ì‹œì•„ë…¸íƒ€ì…",
            "Tintype": "í‹´íƒ€ì…",
            "Mixed Media": "í˜¼í•© ë§¤ì²´",
            "Collage": "ì½œë¼ì£¼",
            "Digital Collage": "ë””ì§€í„¸ ì½œë¼ì£¼",
            "Photo Manipulation": "ì‚¬ì§„ í•©ì„±",
            "Photobashing": "í¬í† ë°°ì‹±",
            "3D Sculpture": "3D ì¡°ê°",
            "Digital Sculpture": "ë””ì§€í„¸ ì¡°ê°",
            "ZBrush": "ZBrush(ì œë¸ŒëŸ¬ì‹œ)",
            "Procedural Art": "í”„ë¡œì‹œì €ëŸ´ ì•„íŠ¸",
            "Algorithmic Art": "ì•Œê³ ë¦¬ì¦˜ ì•„íŠ¸",
            "Holography": "í™€ë¡œê·¸ë˜í”¼",
            "VR Art": "VR ì•„íŠ¸",
            "AR Art": "AR ì•„íŠ¸",
            "NFT Art": "NFT ì•„íŠ¸",
            "Interactive Art": "ì¸í„°ë™í‹°ë¸Œ ì•„íŠ¸",
            "Video Art": "ë¹„ë””ì˜¤ ì•„íŠ¸",
            "Projection Mapping": "í”„ë¡œì ì…˜ ë§¤í•‘",
            "Light Installation": "ë¼ì´íŠ¸ ì¸ìŠ¤í†¨ë ˆì´ì…˜",
            "Sound Visualization": "ì‚¬ìš´ë“œ ë¹„ì£¼ì–¼ë¼ì´ì œì´ì…˜",
            
            // CAMERA translations
            "Eye Level": "ëˆˆë†’ì´",
            "High Angle": "í•˜ì´ ì•µê¸€",
            "Low Angle": "ë¡œìš° ì•µê¸€",
            "Dutch Angle": "ë”ì¹˜ ì•µê¸€",
            "Bird's Eye View": "ì¡°ê°ë„",
            "Worm's Eye View": "ê°œêµ¬ë¦¬ ì‹œì ",
            "Wide Shot": "ì™€ì´ë“œ ìƒ·",
            "Close-up": "í´ë¡œì¦ˆì—…",
            "Over the Shoulder": "ì˜¤ë²„ ë” ìˆ„ë”",
            "Point of View (POV)": "ì£¼ê´€ì  ì‹œì ",
            "Extreme Wide Shot": "ìµìŠ¤íŠ¸ë¦¼ ì™€ì´ë“œ ìƒ·",
            "Medium Shot": "ë¯¸ë””ì—„ ìƒ·",
            "Medium Close-up": "ë¯¸ë””ì—„ í´ë¡œì¦ˆì—…",
            "Extreme Close-up": "ìµìŠ¤íŠ¸ë¦¼ í´ë¡œì¦ˆì—…",
            "Macro Shot": "ë§¤í¬ë¡œ ìƒ·",
            "Detail Shot": "ë””í…Œì¼ ìƒ·",
            "Insert Shot": "ì¸ì„œíŠ¸ ìƒ·",
            "Static Shot": "ì •ì§€ ìƒ·",
            "Pan Left": "ì¢Œë¡œ íŒ¨ë‹",
            "Pan Right": "ìš°ë¡œ íŒ¨ë‹",
            "Tilt Up": "í‹¸íŠ¸ ì—…",
            "Tilt Down": "í‹¸íŠ¸ ë‹¤ìš´",
            "Tracking Shot": "íŠ¸ë˜í‚¹ ìƒ·",
            "Dolly In": "ëŒë¦¬ ì¸",
            "Dolly Out": "ëŒë¦¬ ì•„ì›ƒ",
            "Crane Shot": "í¬ë ˆì¸ ìƒ·",
            "Handheld": "í•¸ë“œí—¬ë“œ",
            "Gimbal Shot": "ì§ë²Œ ìƒ·",
            "Reverse Shot": "ë¦¬ë²„ìŠ¤ ìƒ·",
            "Two Shot": "íˆ¬ ìƒ·",
            "Three Shot": "ì“°ë¦¬ ìƒ·",
            "Group Shot": "ê·¸ë£¹ ìƒ·",
            "Establishing Shot": "ì„¤ì • ìƒ·",
            "Master Shot": "ë§ˆìŠ¤í„° ìƒ·",
            "Cutaway": "ì»·ì–´ì›¨ì´",
            "Reaction Shot": "ë¦¬ì•¡ì…˜ ìƒ·",
            "Split Screen": "ìŠ¤í”Œë¦¿ ìŠ¤í¬ë¦°",
            "Match Cut": "ë§¤ì¹˜ ì»·",
            "Cross-cutting": "í¬ë¡œìŠ¤ ì»·íŒ…",
            "Jump Cut": "ì í”„ ì»·",
            "Whip Pan": "íœ© íŒ¬",
            "Rack Focus": "ë™ í¬ì»¤ìŠ¤",
            "Pull Focus": "í’€ í¬ì»¤ìŠ¤",
            "Deep Focus": "ë”¥ í¬ì»¤ìŠ¤",
            "Shallow Focus": "ì–•ì€ í¬ì»¤ìŠ¤",
            "Selective Focus": "ì„ íƒì  í¬ì»¤ìŠ¤",
            "Ultra Wide": "ìš¸íŠ¸ë¼ ì™€ì´ë“œ",
            "Wide Angle": "ê´‘ê°",
            "Standard Lens": "í‘œì¤€ ë Œì¦ˆ",
            "Telephoto": "ë§ì›",
            "Macro": "ë§¤í¬ë¡œ",
            "Close-up Portrait": "í´ë¡œì¦ˆì—… ì¸ë¬¼",
            "Headshot": "í—¤ë“œìƒ·",
            "Full Body Shot": "ì „ì‹  ìƒ·",
            
            // LIGHTING_TECHNIQUE translations
            "Volumetric Lighting": "ë³¼ë¥˜ë©”íŠ¸ë¦­ ì¡°ëª…",
            "Ray Tracing": "ë ˆì´ íŠ¸ë ˆì´ì‹±",
            "Global Illumination": "ê¸€ë¡œë²Œ ì¼ë£¨ë¯¸ë„¤ì´ì…˜",
            "Path Tracing": "íŒ¨ìŠ¤ íŠ¸ë ˆì´ì‹±",
            "Subsurface Scattering": "ì„œë¸Œì„œí˜ì´ìŠ¤ ìŠ¤ìºí„°ë§",
            "Rembrandt Lighting": "ë ˜ë¸Œë€íŠ¸ ì¡°ëª…",
            "Golden Hour": "ê³¨ë“  ì•„ì›Œ",
            "Blue Hour": "ë¸”ë£¨ ì•„ì›Œ",
            "Cinematic Lighting": "ì‹œë„¤ë§ˆí‹± ì¡°ëª…",
            
            // QUALITY translations
            "--q 0.25": "--q 0.25 (ë¹ ë¥¸ í’ˆì§ˆ)",
            "--q 0.5": "--q 0.5 (ì¤‘ê°„ í’ˆì§ˆ)",
            "--q 1": "--q 1 (ê¸°ë³¸ í’ˆì§ˆ)",
            "--q 2": "--q 2 (ë†’ì€ í’ˆì§ˆ)",
            "--raw": "--raw (ë¡œìš° ëª¨ë“œ)",
            "--turbo": "--turbo (í„°ë³´ ëª¨ë“œ)",
            "--fast": "--fast (ë¹ ë¥¸ ëª¨ë“œ)",
            "--relax": "--relax (ë¦´ë ‰ìŠ¤ ëª¨ë“œ)",
            "16K": "16K í•´ìƒë„",
            "8K": "8K í•´ìƒë„",
            "4K": "4K í•´ìƒë„",
            "Sharp Focus": "ì„ ëª…í•œ ì´ˆì ",
            "Soft Focus": "ë¶€ë“œëŸ¬ìš´ ì´ˆì ",
            
            // PARAMETERS translations
            "--v 7": "--v 7 (ë²„ì „ 7)",
            "--ar 16:9": "--ar 16:9 (ì™€ì´ë“œìŠ¤í¬ë¦°)",
            "--ar 9:16": "--ar 9:16 (ì„¸ë¡œí˜•)",
            "--ar 1:1": "--ar 1:1 (ì •ì‚¬ê°í˜•)",
            "--chaos 0": "--chaos 0 (ì¼ê´€ì„± ë†’ìŒ)",
            "--chaos 100": "--chaos 100 (ë³€í™” ë§ìŒ)",
            "--stylize 100": "--stylize 100 (ìŠ¤íƒ€ì¼ ì•½í•¨)",
            "--stylize 1000": "--stylize 1000 (ìŠ¤íƒ€ì¼ ê°•í•¨)",
            "--weird 0": "--weird 0 (ì¼ë°˜ì )",
            "--weird 3000": "--weird 3000 (ë§¤ìš° ë…íŠ¹í•¨)",
            "--style raw": "--style raw (ìŠ¤íƒ€ì¼ ìµœì†Œí™”)",
            
            // COLOR_TONE translations
            "Vibrant Colors": "ì„ ëª…í•œ ìƒ‰ìƒ",
            "Muted Colors": "ì°¨ë¶„í•œ ìƒ‰ìƒ",
            "Pastel Colors": "íŒŒìŠ¤í…” ìƒ‰ìƒ",
            "Neon Colors": "ë„¤ì˜¨ ìƒ‰ìƒ",
            "Warm Tones": "ë”°ëœ»í•œ í†¤",
            "Cool Tones": "ì°¨ê°€ìš´ í†¤",
            "Earth Tones": "ëŒ€ì§€ ìƒ‰ì¡°",
            "Monochromatic": "ë‹¨ìƒ‰",
            "High Contrast": "ë†’ì€ ëŒ€ë¹„",
            "Low Contrast": "ë‚®ì€ ëŒ€ë¹„",
            
            // CHARACTER translations
            "Main Character": "ì£¼ì¸ê³µ",
            "Supporting Character": "ì¡°ì—°",
            "Background Character": "ë°°ê²½ ì¸ë¬¼",
            "Hero": "ì˜ì›…",
            "Villain": "ì•…ë‹¹",
            "Mentor": "ë©˜í† ",
            "Sidekick": "ì¡°ìˆ˜",
            "Love Interest": "ì—°ì¸ ëŒ€ìƒ",
            "Comic Relief": "ì½”ë¯¹ ë¦´ë¦¬í”„",
            "Mysterious Figure": "ì˜ë¬¸ì˜ ì¸ë¬¼",
            "Child": "ì•„ì´",
            "Teenager": "ì‹­ëŒ€",
            "Adult": "ì„±ì¸",
            "Elderly": "ë…¸ë…„",
            "Male": "ë‚¨ì„±",
            "Female": "ì—¬ì„±",
            "Non-binary": "ë…¼ë°”ì´ë„ˆë¦¬",
            "Robot": "ë¡œë´‡",
            "Alien": "ì™¸ê³„ì¸",

            // BODY_TYPE translations
            "Slim": "ìŠ¬ë¦¼",
            "Athletic": "ìš´ë™í˜•",
            "Muscular": "ê·¼ìœ¡ì§ˆ",
            "Average": "ë³´í†µ ì²´í˜•",
            "Curvy": "êµ½ì´ì§„ ì²´í˜•",
            "Petite": "ì•„ë‹´í•œ",
            "Tall": "í‚¤ í°",
            "Short": "í‚¤ ì‘ì€",
            "Stocky": "ë‹¤ë¶€ì§„",
            "Lean": "ë§ˆë¥¸ ê·¼ìœ¡ì§ˆ",
            "Bulky": "ë©ì¹˜ í°",
            "Toned": "íƒ„íƒ„í•œ",
            "Soft": "ë¶€ë“œëŸ¬ìš´",
            "Angular": "ê°ì§„",
            "Round": "ë‘¥ê·¼",
            "Hourglass": "ëª¨ë˜ì‹œê³„í˜•",
            "Pear-shaped": "í•˜ì²´ ë°œë‹¬(ë°°í˜•)",
            "V-shaped": "ì—­ì‚¼ê°í˜•",

            // HAIR translations
            "Long": "ê¸´ ë¨¸ë¦¬",
            "Short": "ì§§ì€ ë¨¸ë¦¬",
            "Medium": "ì¤‘ê°„ ê¸¸ì´",
            "Wavy": "ì›¨ì´ë¸Œ",
            "Straight": "ìƒë¨¸ë¦¬",
            "Curly": "ê³±ìŠ¬",
            "Braided": "ë•‹ì€ ë¨¸ë¦¬",
            "Ponytail": "í¬ë‹ˆí…Œì¼",
            "Bun": "ë²ˆ í—¤ì–´",
            "Pixie Cut": "í”½ì‹œ ì»·",
            "Bob Cut": "ë³´ë¸Œ ì»·",
            "Undercut": "ì–¸ë”ì»·",
            "Mohawk": "ëª¨íˆì¹¸",
            "Afro": "ì•„í”„ë¡œ",
            "Dreadlocks": "ë“œë ˆë“œë½",
            "Bald": "ëŒ€ë¨¸ë¦¬",
            "Buzz Cut": "ë²„ì¦ˆ ì»·",
            "Flowing": "í©ë‚ ë¦¬ëŠ”",
            "Messy": "í—í´ì–´ì§„",
            "Neat": "ë‹¨ì •í•œ",
            "Styled": "ìŠ¤íƒ€ì¼ë§",
            "Natural": "ë‚´ì¶”ëŸ´",
            "Colored": "ì—¼ìƒ‰",
            "Highlighted": "í•˜ì´ë¼ì´íŠ¸",
            "Ombre": "ì˜´ë¸Œë ˆ",

            // FACE_SHAPE translations
            "Oval": "íƒ€ì›í˜•",
            "Round": "ë‘¥ê·¼í˜•",
            "Square": "ì‚¬ê°í˜•",
            "Heart": "í•˜íŠ¸í˜•",
            "Diamond": "ë‹¤ì´ì•„ëª¬ë“œí˜•",
            "Oblong": "ê¸´í˜•",
            "Triangle": "ì‚¼ê°í˜•",
            "Rectangular": "ì§ì‚¬ê°í˜•",

            // FACIAL_FEATURES translations
            "Sharp": "ë‚ ì¹´ë¡œìš´",
            "Soft": "ë¶€ë“œëŸ¬ìš´",
            "Angular": "ê°ì§„",
            "Round": "ë‘¥ê·¼",
            "Defined": "ë˜ë ·í•œ",
            "Delicate": "ì„¬ì„¸í•œ",
            "Strong": "ê°•í•œ",
            "Gentle": "ì˜¨í™”í•œ",
            "Prominent Cheekbones": "ë„ë“œë¼ì§„ ê´‘ëŒ€ë¼ˆ",
            "Dimples": "ë³´ì¡°ê°œ",
            "Freckles": "ì£¼ê·¼ê¹¨",
            "Beauty Mark": "ì (ë·°í‹° ë§ˆí¬)",
            "Scar": "í‰í„°",
            "Wrinkles": "ì£¼ë¦„",
            "Smooth Skin": "ë§¤ëˆí•œ í”¼ë¶€",
            "Beard": "ìˆ˜ì—¼",
            "Mustache": "ì½§ìˆ˜ì—¼",
            "Goatee": "ì—¼ì†Œìˆ˜ì—¼",
            "Clean Shaven": "ë©´ë„í•¨",
            "Stubble": "ìˆ˜ì—¼ìêµ­",

            // SKIN translations
            "Fair": "ë°ì€ í”¼ë¶€",
            "Light": "ì—°í•œ í”¼ë¶€",
            "Medium": "ì¤‘ê°„ í”¼ë¶€",
            "Tan": "í–‡ë³•ì— íƒ„ í”¼ë¶€",
            "Dark": "ì§™ì€ í”¼ë¶€",
            "Pale": "ì°½ë°±í•œ í”¼ë¶€",
            "Olive": "ì˜¬ë¦¬ë¸Œ í†¤",
            "Warm Tone": "ì›œ í†¤",
            "Cool Tone": "ì¿¨ í†¤",
            "Freckled": "ì£¼ê·¼ê¹¨ í”¼ë¶€",
            "Clear": "ê¹¨ë—í•œ í”¼ë¶€",
            "Glowing": "ë¹›ë‚˜ëŠ” í”¼ë¶€",
            "Matte": "ë§¤íŠ¸ í”¼ë¶€",
            "Dewy": "ìœ¤ê´‘ í”¼ë¶€",
            "Dry": "ê±´ì„±",
            "Oily": "ì§€ì„±",
            "Textured": "ê²° ìˆëŠ” í”¼ë¶€",
            "Smooth": "ë§¤ëˆí•¨",

            // EXPRESSION translations (ì¶”ê°€ ë³´ê°•)
            "Neutral": "ë¬´í‘œì •",
            "Confident": "ìì‹ ê° ìˆëŠ”",
            "Thoughtful": "ì‚¬ìƒ‰ì ì¸",
            "Determined": "ê²°ì—°í•œ",
            "Embarrassed": "ë‹¹í™©í•œ",
            "Disappointed": "ì‹¤ë§í•œ",

            // CLOTHING translations ë³´ê°•
            "Jeans and T-shirt": "ì²­ë°”ì§€ì™€ í‹°ì…”ì¸ ",
            "Hoodie": "í›„ë””",
            "Jacket": "ì¬í‚·",
            "Coat": "ì½”íŠ¸",
            "Sweater": "ìŠ¤ì›¨í„°",
            "Shorts": "ë°˜ë°”ì§€",
            "Skirt": "ìŠ¤ì»¤íŠ¸",

            // ACCESSORIES translations
            "Glasses": "ì•ˆê²½",
            "Sunglasses": "ì„ ê¸€ë¼ìŠ¤",
            "Hat": "ëª¨ì",
            "Cap": "ìº¡",
            "Headband": "í—¤ì–´ë°´ë“œ",
            "Earrings": "ê·€ê±¸ì´",
            "Necklace": "ëª©ê±¸ì´",
            "Bracelet": "íŒ”ì°Œ",
            "Ring": "ë°˜ì§€",
            "Watch": "ì‹œê³„",
            "Belt": "ë²¨íŠ¸",
            "Scarf": "ìŠ¤ì¹´í”„",
            "Gloves": "ì¥ê°‘",
            "Bag": "ê°€ë°©",
            "Backpack": "ë°±íŒ©",
            "Jewelry": "ì£¼ì–¼ë¦¬",
            "Tattoo": "ë¬¸ì‹ ",
            "Piercing": "í”¼ì–´ì‹±",
            "Mask": "ë§ˆìŠ¤í¬",
            "Crown": "ì™•ê´€",
            "Tiara": "í‹°ì•„ë¼",
            "Badge": "ë°°ì§€",
            "Pin": "í•€",

            // PROPS translations (ì£¼ìš” ì˜ˆì‹œ)
            "Weapon": "ë¬´ê¸°",
            "Tool": "ë„êµ¬",
            "Book": "ì±…",
            "Phone": "ì „í™”ê¸°",
            "Computer": "ì»´í“¨í„°",
            "Umbrella": "ìš°ì‚°",
            "Cane": "ì§€íŒ¡ì´",
            "Staff": "ìŠ¤íƒœí”„",
            "Musical Instrument": "ì•…ê¸°",
            "Sports Equipment": "ìŠ¤í¬ì¸  ì¥ë¹„",
            "Food": "ìŒì‹",
            "Drink": "ìŒë£Œ",
            "Flower": "ê½ƒ",
            "Key": "ì—´ì‡ ",
            "Map": "ì§€ë„",
            "Scroll": "ë‘ë£¨ë§ˆë¦¬",
            "Crystal": "í¬ë¦¬ìŠ¤íƒˆ",
            "Orb": "ì˜¤ë¸Œ",
            "Potion": "ë¬¼ì•½",
            "Artifact": "ìœ ë¬¼",
            "Device": "ì¥ì¹˜",

            // POSE translations (ì£¼ìš” ì˜ˆì‹œ)
            "Standing": "ì„œ ìˆëŠ”",
            "Sitting": "ì•‰ì•„ ìˆëŠ”",
            "Walking": "ê±·ëŠ”",
            "Running": "ë›°ëŠ”",
            "Jumping": "ì í”„",
            "Flying": "ë¹„í–‰",
            "Fighting": "ì „íˆ¬",
            "Dancing": "ì¶¤ì¶”ëŠ”",
            "Relaxed": "í¸ì•ˆí•œ",
            "Tense": "ê¸´ì¥í•œ",
            "Dynamic": "ë‹¤ì´ë‚´ë¯¹",
            "Static": "ì •ì ì¸",
            "Action Pose": "ì•¡ì…˜ í¬ì¦ˆ",
            "Rest Pose": "íœ´ì‹ í¬ì¦ˆ",
            "Hero Pose": "ì˜ì›… í¬ì¦ˆ",
            "Dramatic Pose": "ë“œë¼ë§ˆí‹± í¬ì¦ˆ",
            "Casual Pose": "ìºì£¼ì–¼ í¬ì¦ˆ",
            "Formal Pose": "í¬ë©€ í¬ì¦ˆ",
            "Combat Stance": "ì „íˆ¬ ìì„¸",
            "Defensive Stance": "ë°©ì–´ ìì„¸",

            // GAZE translations
            "Direct": "ì •ë©´ ì‘ì‹œ",
            "Averted": "ì‹œì„  íšŒí”¼",
            "Downward": "ì•„ë˜ìª½ ì‹œì„ ",
            "Upward": "ìœ„ìª½ ì‹œì„ ",
            "Side Glance": "ì˜†ëˆˆì§ˆ",
            "Over Shoulder": "ì–´ê¹¨ ë„ˆë¨¸ ë³´ê¸°",
            "Closed Eyes": "ëˆˆ ê°ìŒ",
            "Half-lidded": "ë°˜ì¯¤ ê°ì€ ëˆˆ",
            "Wide Open": "í¬ê²Œ ëœ¬ ëˆˆ",
            "Squinting": "ê°€ëŠ˜ê²Œ ëœ¬ ëˆˆ",
            "Winking": "ìœ™í¬",
            "Rolling Eyes": "ëˆˆ êµ´ë¦¬ê¸°",
            "Staring": "ì‘ì‹œ",
            "Dreamy": "ëª½í™˜ì ì¸ ì‹œì„ ",

            // CHARACTER_SHEET translations
            "Full Body Reference": "ì „ì‹  ì°¸ê³ ",
            "Turn Around": "í„´ì–´ë¼ìš´ë“œ",
            "Expression Sheet": "í‘œì • ì‹œíŠ¸",
            "Costume Design": "ì˜ìƒ ë””ìì¸",
            "Detail Sheet": "ë””í…Œì¼ ì‹œíŠ¸",
            "Action Poses": "ì•¡ì…˜ í¬ì¦ˆ",
            "Idle Pose": "ì•„ì´ë“¤ í¬ì¦ˆ",
            "Portrait": "ì¸ë¬¼ ì‚¬ì§„",
            "Profile View": "ì¸¡ë©´ ë·°",
            "Three Quarter View": "3/4 ë·°",
            "Back View": "í›„ë©´ ë·°",

            "young woman": "ì Šì€ ì—¬ì„±",
            "young man": "ì Šì€ ë‚¨ì„±",
            "middle-aged woman": "ì¤‘ë…„ ì—¬ì„±",
            "middle-aged man": "ì¤‘ë…„ ë‚¨ì„±",
            "elderly woman": "ë…¸ë…„ ì—¬ì„±",
            "elderly man": "ë…¸ë…„ ë‚¨ì„±",
            "teenager": "ì‹­ëŒ€",
            "child": "ì•„ì´",
            "professional": "ì „ë¬¸ê°€",
            "student": "í•™ìƒ",
            "artist": "ì˜ˆìˆ ê°€",
            "scientist": "ê³¼í•™ì",
            
            // ATMOSPHERE translations
            "Mysterious": "ì‹ ë¹„ë¡œìš´",
            "Romantic": "ë¡œë§¨í‹±í•œ",
            "Peaceful": "í‰í™”ë¡œìš´",
            "Chaotic": "í˜¼ë€ìŠ¤ëŸ¬ìš´",
            "Dreamy": "ê¿ˆê°™ì€",
            "Realistic": "í˜„ì‹¤ì ì¸",
            "Futuristic": "ë¯¸ë˜ì ì¸",
            "Ancient": "ê³ ëŒ€ì˜",
            "Liminal": "ê²½ê³„ì˜",
            "Uncanny": "ê¸°ì´í•œ",
            "Vaporwave": "ë² ì´í¼ì›¨ì´ë¸Œ",
            "Cyberpunk": "ì‚¬ì´ë²„í‘í¬",
            
            // CLOTHING translations
            "smiling": "ì›ƒëŠ”",
            "serious": "ì§„ì§€í•œ",
            "thoughtful": "ì‚¬ìƒ‰ì ì¸",
            "confident": "ìì‹ ê° ìˆëŠ”",
            "nervous": "ê¸´ì¥í•œ",
            "excited": "í¥ë¶„í•œ",
            "calm": "ì°¨ë¶„í•œ",
            "angry": "í™”ë‚œ",
            "sad": "ìŠ¬í”ˆ",
            "happy": "í–‰ë³µí•œ",
            "surprised": "ë†€ë€",
            "focused": "ì§‘ì¤‘í•œ",
            "relaxed": "í¸ì•ˆí•œ",
            "determined": "ê²°ì—°í•œ",
            "curious": "í˜¸ê¸°ì‹¬ ìˆëŠ”",
            "worried": "ê±±ì •í•˜ëŠ”",
            "casual clothes": "ìºì£¼ì–¼ ì˜ìƒ",
            "formal wear": "ì •ì¥",
            "uniform": "ìœ ë‹ˆí¼",
            "traditional dress": "ì „í†µ ì˜ìƒ",
            "modern fashion": "í˜„ëŒ€ íŒ¨ì…˜",
            "vintage style": "ë¹ˆí‹°ì§€ ìŠ¤íƒ€ì¼",
            "athletic wear": "ìš´ë™ë³µ",
            "business suit": "ë¹„ì¦ˆë‹ˆìŠ¤ ì •ì¥",
            "streetwear": "ìŠ¤íŠ¸ë¦¬íŠ¸ì›¨ì–´",
            "costume": "ì½”ìŠ¤íŠ¬",
            "armor": "ê°‘ì˜·",
            "robe": "ë¡œë¸Œ",
            
            // SCENE translations
            "Daily Life": "ì¼ìƒ ìƒí™œ",
            "Celebration": "ì¶•í•˜",
            "Action Scene": "ì•¡ì…˜ ì¥ë©´",
            "Quiet Moment": "ì¡°ìš©í•œ ìˆœê°„",
            "Romantic Scene": "ë¡œë§¨í‹±í•œ ì¥ë©´",
            "Battle Scene": "ì „íˆ¬ ì¥ë©´",
            "Peaceful Scene": "í‰í™”ë¡œìš´ ì¥ë©´",
            "Dramatic Moment": "ê·¹ì ì¸ ìˆœê°„",
            
            // LOCATION translations
            "City Street": "ë„ì‹œ ê±°ë¦¬",
            "Forest": "ìˆ²",
            "Beach": "í•´ë³€",
            "Mountain": "ì‚°",
            "Desert": "ì‚¬ë§‰",
            "Ocean": "ë°”ë‹¤",
            "Lake": "í˜¸ìˆ˜",
            "River": "ê°•",
            "Park": "ê³µì›",
            "Garden": "ì •ì›",
            "Castle": "ì„±",
            "Palace": "ê¶ì „",
            
            // WEATHER translations
            "Clear": "ë§‘ìŒ",
            "Sunny": "í™”ì°½í•¨",
            "Cloudy": "íë¦¼",
            "Rainy": "ë¹„",
            "Snowy": "ëˆˆ",
            "Foggy": "ì•ˆê°œ",
            "Stormy": "í­í’",
            
            // ERA translations
            "Y2K Revival": "Y2K ë¦¬ë°”ì´ë²Œ",
            "2000s Nostalgia": "2000ë…„ëŒ€ í–¥ìˆ˜",
            "McBling Era": "ë§¥ë¸”ë§ ì‹œëŒ€",
            "Indie Sleaze": "ì¸ë”” ìŠ¬ë¦¬ì¦ˆ",
            "Victorian Era": "ë¹…í† ë¦¬ì•„ ì‹œëŒ€",
            "Renaissance": "ë¥´ë„¤ìƒìŠ¤",
            "Medieval": "ì¤‘ì„¸",
            "Ancient Egypt": "ê³ ëŒ€ ì´ì§‘íŠ¸",
            "Cyberpunk 2077": "ì‚¬ì´ë²„í‘í¬ 2077",
            "Steampunk Victorian": "ìŠ¤íŒ€í‘í¬ ë¹…í† ë¦¬ì•„",
            
            // Additional common terms
            "Ultra Detailed": "ì´ˆì •ë°€",
            "Highly Detailed": "ë§¤ìš° ìƒì„¸í•œ",
            "Intricate Details": "ë³µì¡í•œ ë””í…Œì¼",
            "Fine Details": "ì„¸ë°€í•œ ë””í…Œì¼",
            "High Resolution": "ê³ í•´ìƒë„",
            "Professional": "ì „ë¬¸ì ì¸",
            "Artistic": "ì˜ˆìˆ ì ì¸",
            "Creative": "ì°½ì˜ì ì¸",
            "Modern": "í˜„ëŒ€ì ì¸",
            "Classic": "í´ë˜ì‹í•œ",
            "Traditional": "ì „í†µì ì¸",
            "Contemporary": "ë™ì‹œëŒ€ì˜",
            "Futuristic": "ë¯¸ë˜ì ì¸",
            "Vintage": "ë¹ˆí‹°ì§€",
            "Retro": "ë ˆíŠ¸ë¡œ"
        };
        
        // í•œê¸€ ì œëª© ë§¤í•‘
        const koreanTitles = {
            'STYLE': 'ìŠ¤íƒ€ì¼',
            'MEDIUM': 'ë§¤ì²´',
            'ERA/CULTURAL_REF': 'ì‹œëŒ€/ë¬¸í™” ì°¸ì¡°',
            'CHARACTER': 'ìºë¦­í„°',
            'CAMERA': 'ì¹´ë©”ë¼',
            'SCENE': 'ì¥ë©´',
            'COLOR_TONE': 'ìƒ‰ì¡°',
            'GAZE': 'ì‹œì„ ',
            'CHARACTER_SHEET': 'ìºë¦­í„° ì‹œíŠ¸',
            'BODY_TYPE': 'ì²´í˜•',
            'HAIR': 'í—¤ì–´',
            'FACE_SHAPE': 'ì–¼êµ´í˜•',
            'FACIAL_FEATURES': 'ì–¼êµ´ íŠ¹ì§•',
            'SKIN': 'í”¼ë¶€',
            'EXPRESSION': 'í‘œì •',
            'CLOTHING': 'ì˜ìƒ',
            'ACCESSORIES': 'ì•¡ì„¸ì„œë¦¬',
            'PROPS': 'ì†Œí’ˆ',
            'POSE': 'í¬ì¦ˆ',
            'BACKGROUND': 'ë°°ê²½',
            'LIGHTING': 'ì¡°ëª…',
            'QUALITY': 'í’ˆì§ˆ',
            'PARAMETERS': 'íŒŒë¼ë¯¸í„°',
            'CHARACTER_1': 'ìºë¦­í„° 1',
            'CHARACTER_1_DETAIL': 'ìºë¦­í„° 1 ìƒì„¸',
            'CHARACTER_2': 'ìºë¦­í„° 2',
            'CHARACTER_2_DETAIL': 'ìºë¦­í„° 2 ìƒì„¸',
            'CHARACTER_3': 'ìºë¦­í„° 3',
            'CHARACTER_3_DETAIL': 'ìºë¦­í„° 3 ìƒì„¸',
            'CHARACTER_4': 'ìºë¦­í„° 4',
            'CHARACTER_4_DETAIL': 'ìºë¦­í„° 4 ìƒì„¸',
            'CHARACTER_5': 'ìºë¦­í„° 5',
            'CHARACTER_5_DETAIL': 'ìºë¦­í„° 5 ìƒì„¸',
            'LOCATION': 'ì¥ì†Œ',
            'LOCATION_DETAIL': 'ì¥ì†Œ ìƒì„¸',
            'TIME_LIGHTING': 'ì‹œê°„ëŒ€/ì¡°ëª…',
            'ARTIFICIAL_LIGHT': 'ì¸ê³µ ì¡°ëª…',
            'ATMOSPHERE': 'ë¶„ìœ„ê¸°',
            'WEATHER': 'ë‚ ì”¨',
            'FOREGROUND': 'ì „ê²½',
            'CAMERA_EFFECTS': 'ì¹´ë©”ë¼ íš¨ê³¼',
            'LIGHTING_TECHNIQUE': 'ì¡°ëª… ê¸°ë²•',
            'CAMERA_TECH': 'ì¹´ë©”ë¼ ê¸°ìˆ '
        };
        
        const characterCategories = [
                { name: 'ê¸°ë³¸ì •ë³´', items: [
                    'STYLE', 'MEDIUM', 'CHARACTER', 'CAMERA', 'GAZE', 'CHARACTER_SHEET'
                ]},
                { name: 'ìºë¦­í„° ì •ë³´', items: [
                    'BODY_TYPE', 'HAIR', 'FACE_SHAPE', 'FACIAL_FEATURES', 'SKIN', 
                    'EXPRESSION', 'CLOTHING', 'ACCESSORIES', 'PROPS', 'POSE'
                ]},
                { name: 'ë°°ê²½/í™˜ê²½ ì •ë³´', items: [
                    'BACKGROUND'
                ]},
                { name: 'ê¸°ìˆ  ì •ë³´', items: [
                    'LIGHTING', 'QUALITY', 'PARAMETERS'
                ]}
            ];
            
            // ì¼ë°˜ì´ë¯¸ì§€ íƒ­ ì¹´í…Œê³ ë¦¬
            const generalCategories = {
                'ê¸°ë³¸ì •ë³´': ['STYLE', 'MEDIUM', 'ERA/CULTURAL_REF', 'CAMERA', 'SCENE', 'COLOR_TONE'],
                'ìºë¦­í„° ì •ë³´': ['CHARACTER_1', 'CHARACTER_1_DETAIL', 'CHARACTER_2', 'CHARACTER_2_DETAIL', 
                               'CHARACTER_3', 'CHARACTER_3_DETAIL', 'CHARACTER_4', 'CHARACTER_4_DETAIL', 
                               'CHARACTER_5', 'CHARACTER_5_DETAIL'],
                'ë°°ê²½/í™˜ê²½ ì •ë³´': ['LOCATION', 'LOCATION_DETAIL', 'TIME_LIGHTING', 'ARTIFICIAL_LIGHT',
                                'ATMOSPHERE', 'WEATHER', 'FOREGROUND', 'BACKGROUND'],
                'ê¸°ìˆ  ì •ë³´': ['CAMERA_EFFECTS', 'LIGHTING_TECHNIQUE', 'CAMERA_TECH', 'QUALITY', 'PARAMETERS']
            };
            
            if (currentStructureTab === 'character') {
                // ìºë¦­í„° íƒ­: í•˜ìœ„ íƒ­ê³¼ í•¨ê»˜ í‘œì‹œ
                const characterContainer = document.createElement('div');
                characterContainer.className = 'character-container';
                
                // ìºë¦­í„° í•˜ìœ„ íƒ­ ìƒì„±
                const subTabs = document.createElement('div');
                subTabs.className = 'character-sub-tabs';
                subTabs.innerHTML = `
                    <div class="sub-tab-buttons">
                        <button type="button" class="sub-tab-button active" data-category="0" onclick="switchCharacterSubTab(0)">ê¸°ë³¸ì •ë³´</button>
                        <button type="button" class="sub-tab-button" data-category="1" onclick="switchCharacterSubTab(1)">ìºë¦­í„° ì •ë³´</button>
                        <button type="button" class="sub-tab-button" data-category="2" onclick="switchCharacterSubTab(2)">ë°°ê²½/í™˜ê²½ì •ë³´</button>
                        <button type="button" class="sub-tab-button" data-category="3" onclick="switchCharacterSubTab(3)">ê¸°ìˆ  ì •ë³´</button>
                    </div>
                `;
                characterContainer.appendChild(subTabs);
                
                // ê° ì¹´í…Œê³ ë¦¬ë³„ ì»¨í…ì¸  ìƒì„±
                const subTabContents = document.createElement('div');
                subTabContents.className = 'sub-tab-contents';
                
                characterCategories.forEach((category, catIndex) => {
                    const content = document.createElement('div');
                    content.className = `sub-tab-content ${catIndex === 0 ? 'active' : ''}`;
                    content.dataset.category = catIndex;
                    
                    let startNumber = 1;
                    if (catIndex === 1) startNumber = 7;  // ìºë¦­í„° ì •ë³´
                    else if (catIndex === 2) startNumber = 17;  // ë°°ê²½/í™˜ê²½ì •ë³´
                    else if (catIndex === 3) startNumber = 18;  // ê¸°ìˆ  ì •ë³´
                    
                    category.items.forEach((key, index) => {
                        const value = structure[key] || '';
                        const itemNumber = startNumber + index;
                        
                        // ë“œë¡­ë‹¤ìš´ ì»¨í…Œì´ë„ˆ ìƒì„±
                        const dropdownContainer = document.createElement('div');
                        dropdownContainer.className = 'dropdown-container';
                        dropdownContainer.dataset.key = key;
                        
                        dropdownContainer.innerHTML = `
                            <div class="dropdown-header" onclick="toggleDropdown(this.parentElement)">
                                <div class="dropdown-title">
                                    <span class="dropdown-number">${itemNumber}</span>
                                    <span>${koreanTitles[key] || key}</span>
                                    <span class="dropdown-english-label">${key}</span>
                                </div>
                                <span class="dropdown-arrow">â–¼</span>
                            </div>
                            <div class="dropdown-content">
                                <div class="dropdown-fields">
                                    <div class="dropdown-field">
                                        <label class="dropdown-field-label">ê¸°ì¡´ë‚´ìš©</label>
                                        <input type="text" 
                                               class="dropdown-field-input" 
                                               value="${value}" 
                                               data-key="${key}" 
                                               onchange="updateStructureValue('${key}', this.value)"
                                               placeholder="ê¸°ì¡´ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”">
                                    </div>
                                    <div class="dropdown-field">
                                        <div class="dropdown-field-label-with-buttons">
                                            <label class="dropdown-field-label">ë³€ê²½ìš”ì²­</label>
                                            <div class="field-action-buttons">
                                                <button type="button" class="btn-field-action btn-save" onclick="saveToApplied(event, '${key}')">ì €ì¥</button>
                                                <button type="button" class="btn-field-action btn-ai-save" onclick="aiSaveField('${key}')">AIì €ì¥</button>
                                            </div>
                                        </div>
                                        <div class="select-input-wrapper">
                                            <input type="text" 
                                                   class="dropdown-field-input with-select" 
                                                   data-key="${key}-request" 
                                                   placeholder="ì§ì ‘ ì…ë ¥ ë˜ëŠ” ì„ íƒ">
                                            <button type="button" class="dropdown-toggle-btn" onclick="event.stopPropagation(); toggleStyleDropdown(this)">
                                                <span class="dropdown-icon">â–¼</span>
                                            </button>
                                            <div class="style-options-dropdown" style="display: none;">
                                                <div class="style-options-search">
                                                    <input type="text" placeholder="ê²€ìƒ‰..." onkeyup="filterStyleDropdown(this)">
                                                </div>
                                                <div class="style-options-list">
                                                    ${(dropdownOptions[key] || []).map((option, idx) => {
                                                        const ko = dropdownTranslations[option];
                                                        const displayText = ko && ko !== option ? `${ko} (${option})` : (ko || option);
                                                        return `<div class="style-option" role="option" tabindex="-1" data-index="${idx}" data-value="${option}" onclick="event.stopPropagation(); selectStyleOption(this, '${option}', '${key}-request')">${displayText}</div>`;
                                                    }).join('')}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="dropdown-field">
                                        <label class="dropdown-field-label">ë³€ê²½ ë°˜ì˜</label>
                                        <input type="text" 
                                               class="dropdown-field-input" 
                                               data-key="${key}-applied" 
                                               placeholder="ë³€ê²½ëœ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”">
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        content.appendChild(dropdownContainer);
                    });
                    
                    subTabContents.appendChild(content);
                });
                
                characterContainer.appendChild(subTabContents);
                promptCardsGrid.appendChild(characterContainer);
                
            } else {
                // ì¼ë°˜ì´ë¯¸ì§€ íƒ­: ë“œë¡­ë‹¤ìš´ í˜•íƒœë¡œ ë³€ê²½
                const generalContainer = document.createElement('div');
                generalContainer.className = 'general-container';
                
                // ì¼ë°˜ íƒ­ í•˜ìœ„ ì¹´í…Œê³ ë¦¬ ìƒì„±
                const subTabs = document.createElement('div');
                subTabs.className = 'character-sub-tabs';
                subTabs.innerHTML = `
                    <div class="sub-tab-buttons">
                        <button type="button" class="sub-tab-button active" data-category="0" onclick="switchGeneralSubTab(0)">ê¸°ë³¸ì •ë³´</button>
                        <button type="button" class="sub-tab-button" data-category="1" onclick="switchGeneralSubTab(1)">ìºë¦­í„° ì •ë³´</button>
                        <button type="button" class="sub-tab-button" data-category="2" onclick="switchGeneralSubTab(2)">ë°°ê²½/í™˜ê²½ ì •ë³´</button>
                        <button type="button" class="sub-tab-button" data-category="3" onclick="switchGeneralSubTab(3)">ê¸°ìˆ  ì •ë³´</button>
                    </div>
                `;
                generalContainer.appendChild(subTabs);
                
                // ê° ì¹´í…Œê³ ë¦¬ë³„ ì»¨í…ì¸  ìƒì„±
                const subTabContents = document.createElement('div');
                subTabContents.className = 'sub-tab-contents';

                // ì´ë¯¸ì§€ ìƒì˜ ë²ˆí˜¸ ì²´ê³„ì— ë§ì¶˜ ì»¤ìŠ¤í…€ ë„˜ë²„ ë§¤í•‘
                const generalNumberMap = {
                    // ê¸°ë³¸ì •ë³´ (1~6)
                    'STYLE': 1,
                    'MEDIUM': 2,
                    'ERA/CULTURAL_REF': 3,
                    'CAMERA': 4,
                    'SCENE': 5,
                    'COLOR_TONE': 6,
                    // ìºë¦­í„° ì •ë³´ (6~15) - ì´ë¯¸ì§€ ìƒ í‘œê¸°ëŒ€ë¡œ ìœ ì§€
                    'CHARACTER_1': 6,
                    'CHARACTER_1_DETAIL': 7,
                    'CHARACTER_2': 8,
                    'CHARACTER_2_DETAIL': 9,
                    'CHARACTER_3': 10,
                    'CHARACTER_3_DETAIL': 11,
                    'CHARACTER_4': 12,
                    'CHARACTER_4_DETAIL': 13,
                    'CHARACTER_5': 14,
                    'CHARACTER_5_DETAIL': 15,
                    // ë°°ê²½/í™˜ê²½ ì •ë³´ (17~25, 21ì€ ê¸°ìˆ  ì •ë³´ì— ë°°ì •)
                    'LOCATION': 17,
                    'LOCATION_DETAIL': 18,
                    'TIME_LIGHTING': 19,
                    'ARTIFICIAL_LIGHT': 20,
                    'ATMOSPHERE': 22,
                    'WEATHER': 23,
                    'FOREGROUND': 24,
                    'BACKGROUND': 25,
                    // ê¸°ìˆ  ì •ë³´ (16, 21, 27, 28, 29)
                    'CAMERA_EFFECTS': 16,
                    'LIGHTING_TECHNIQUE': 21,
                    'CAMERA_TECH': 27,
                    'QUALITY': 28,
                    'PARAMETERS': 29
                };
                
                const generalCategoriesArray = [
                    { name: 'ê¸°ë³¸ì •ë³´', items: generalCategories['ê¸°ë³¸ì •ë³´'] },
                    { name: 'ìºë¦­í„° ì •ë³´', items: generalCategories['ìºë¦­í„° ì •ë³´'] },
                    { name: 'ë°°ê²½/í™˜ê²½ ì •ë³´', items: generalCategories['ë°°ê²½/í™˜ê²½ ì •ë³´'] },
                    { name: 'ê¸°ìˆ  ì •ë³´', items: generalCategories['ê¸°ìˆ  ì •ë³´'] }
                ];
                
                generalCategoriesArray.forEach((category, catIndex) => {
                    const content = document.createElement('div');
                    content.className = `sub-tab-content ${catIndex === 0 ? 'active' : ''}`;
                    content.dataset.category = catIndex;
                    
                    // ê¸°ë³¸ ì‹œì‘ ë²ˆí˜¸ (ì»¤ìŠ¤í…€ ë§¤í•‘ì´ ì—†ëŠ” í•­ëª© ëŒ€ë¹„ìš©)
                    let startNumber = 1;
                    if (catIndex === 1) startNumber = 7;
                    else if (catIndex === 2) startNumber = 17;
                    else if (catIndex === 3) startNumber = 16;
                    
                    category.items.forEach((key, index) => {
                        const value = structure[key] || '';
                        const itemNumber = generalNumberMap[key] ?? (startNumber + index);
                        
                        // ë“œë¡­ë‹¤ìš´ ì»¨í…Œì´ë„ˆ ìƒì„±
                        const dropdownContainer = document.createElement('div');
                        dropdownContainer.className = 'dropdown-container';
                        dropdownContainer.dataset.key = key;
                        
                        dropdownContainer.innerHTML = `
                            <div class="dropdown-header" onclick="toggleDropdown(this.parentElement)">
                                <div class="dropdown-title">
                                    <span class="dropdown-number">${itemNumber}</span>
                                    <span>${koreanTitles[key] || key}</span>
                                    <span class="dropdown-english-label">${key}</span>
                                </div>
                                <span class="dropdown-arrow">â–¼</span>
                            </div>
                            <div class="dropdown-content">
                                <div class="dropdown-fields">
                                    <div class="dropdown-field">
                                        <label class="dropdown-field-label">ê¸°ì¡´ë‚´ìš©</label>
                                        <input type="text" 
                                               class="dropdown-field-input" 
                                               value="${value}" 
                                               data-key="${key}" 
                                               onchange="updateStructureValue('${key}', this.value)"
                                               placeholder="ê¸°ì¡´ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”">
                                    </div>
                                    <div class="dropdown-field">
                                        <div class="dropdown-field-label-with-buttons">
                                            <label class="dropdown-field-label">ë³€ê²½ìš”ì²­</label>
                                            <div class="field-action-buttons">
                                                <button type="button" class="btn-field-action btn-save" onclick="saveToApplied(event, '${key}')">ì €ì¥</button>
                                                <button type="button" class="btn-field-action btn-ai-save" onclick="aiSaveField('${key}')">AIì €ì¥</button>
                                            </div>
                                        </div>
                                        <div class="select-input-wrapper">
                                            <input type="text" 
                                                   class="dropdown-field-input with-select" 
                                                   data-key="${key}-request" 
                                                   placeholder="ì§ì ‘ ì…ë ¥ ë˜ëŠ” ì„ íƒ">
                                            <button type="button" class="dropdown-toggle-btn" onclick="event.stopPropagation(); toggleStyleDropdown(this)">
                                                <span class="dropdown-icon">â–¼</span>
                                            </button>
                                            <div class="style-options-dropdown" style="display: none;">
                                                <div class="style-options-search">
                                                    <input type="text" placeholder="ê²€ìƒ‰..." onkeyup="filterStyleDropdown(this)">
                                                </div>
                                                <div class="style-options-list">
                                                    ${(dropdownOptions[key] || []).map((option, idx) => {
                                                        const ko = dropdownTranslations[option];
                                                        const displayText = ko && ko !== option ? `${ko} (${option})` : (ko || option);
                                                        return `<div class="style-option" role="option" tabindex="-1" data-index="${idx}" data-value="${option}" onclick="event.stopPropagation(); selectStyleOption(this, '${option}', '${key}-request')">${displayText}</div>`;
                                                    }).join('')}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="dropdown-field">
                                        <label class="dropdown-field-label">ë³€ê²½ ë°˜ì˜</label>
                                        <input type="text" 
                                               class="dropdown-field-input" 
                                               data-key="${key}-applied" 
                                               placeholder="ë³€ê²½ëœ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”">
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        content.appendChild(dropdownContainer);
                    });
                    
                    subTabContents.appendChild(content);
                });
                
                generalContainer.appendChild(subTabContents);
                promptCardsGrid.appendChild(generalContainer);
            }
            
            // ì¼ë°˜ì´ë¯¸ì§€ íƒ­: 'ê¸°íƒ€' ì„¹ì…˜ì€ ìƒì„±í•˜ì§€ ì•ŠìŒ (ìš”ì²­ì— ë”°ë¼ ì œê±°)
            
            promptCardsSection.style.display = 'block';
        }

        // ì¹´ë“œ í¸ì§‘ í•¨ìˆ˜
        function editCard(key) {
            const card = document.querySelector(`.prompt-card[data-key="${key}"]`);
            card.classList.add('editing');
            const input = card.querySelector('.prompt-card-input');
            input.focus();
            input.setSelectionRange(input.value.length, input.value.length);
        }

        // ì¹´ë“œ ì €ì¥ í•¨ìˆ˜
        function saveCard(key) {
            const card = document.querySelector(`.prompt-card[data-key="${key}"]`);
            const input = card.querySelector('.prompt-card-input');
            const content = card.querySelector('.prompt-card-content');
            
            promptData.structuredPrompt[key] = input.value;
            content.textContent = input.value;
            card.classList.remove('editing');
            
            // í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
            updatePromptPreview();
            saveToLocalStorage();
        }

        // ì¹´ë“œ ì·¨ì†Œ í•¨ìˆ˜
        function cancelCard(key) {
            const card = document.querySelector(`.prompt-card[data-key="${key}"]`);
            const input = card.querySelector('.prompt-card-input');
            
            input.value = promptData.structuredPrompt[key];
            card.classList.remove('editing');
        }

        // ìµœì¢… í”„ë¡¬í”„íŠ¸ ë³µì‚¬

        // ìµœì¢… í”„ë¡¬í”„íŠ¸ ë³µì‚¬
        copyFinalPromptBtn.addEventListener('click', () => {
            const value = finalPromptText.value || '';
            if (!value.trim()) {
                showToast('ë³µì‚¬í•  ìµœì¢… í”„ë¡¬í”„íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            navigator.clipboard.writeText(value)
                .then(() => showToast('ìµœì¢… í”„ë¡¬í”„íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success'))
                .catch(() => showToast('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error'));
        });

        // AI ì—°ë™ ë²„íŠ¼
        aiConnectBtn.addEventListener('click', () => {
            openApiModal();
        });

        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ - ì½˜ì†” ë¡œê·¸ë¡œ ëŒ€ì²´
        function showToast(message, type = 'success') {
            // ì½˜ì†”ì— ë¡œê·¸ ì¶œë ¥
            if (type === 'error') {
                console.error(`[ERROR] ${message}`);
            } else if (type === 'warning') {
                console.warn(`[WARNING] ${message}`);
            } else {
                console.log(`[${type.toUpperCase()}] ${message}`);
            }
            
            // ì¤‘ìš”í•œ ì—ëŸ¬ëŠ” alertë¡œ í‘œì‹œ
            if (type === 'error' && message.includes('API')) {
                alert(message);
            }
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥
        function saveToLocalStorage() {
            localStorage.setItem('imagePromptData', JSON.stringify(promptData));
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadFromLocalStorage() {
            const saved = localStorage.getItem('imagePromptData');
            if (saved) {
                promptData = JSON.parse(saved);
                
                // í…ìŠ¤íŠ¸ ë³µì›
                if (promptData.textInput) {
                    promptPreview.textContent = promptData.textInput;
                    promptPreview.classList.add('has-content');
                }
                
            }
        }

        // í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updatePromptPreview() {
            const text = promptData.textInput || promptPreview.innerText.trim();
            
            if (!text && Object.keys(promptData.structuredPrompt).length === 0) {
                if (!userEditingPreview) {
                    promptPreview.innerHTML = '<p class="preview-placeholder">ì—¬ê¸°ì— í”„ë¡¬í”„íŠ¸ë¥¼ ì§ì ‘ ì…ë ¥í•˜ê±°ë‚˜ ì˜ˆì‹œ í”„ë¡¬í”„íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>';
                }
                promptPreview.classList.remove('has-content');
                promptCardsSection.style.display = 'none';
                return;
            }

            let previewText = '';
            
            // êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ê°€ ìˆìœ¼ë©´ ìš°ì„  ì‚¬ìš© (ì¤„ë°”ê¿ˆ í¬ë§·)
            if (Object.keys(promptData.structuredPrompt).length > 0) {
                previewText = structureToMultilineText(promptData.structuredPrompt);
            } else if (text) {
                // í…ìŠ¤íŠ¸ ê¸°ë°˜ í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸°
                previewText = enhancePrompt(text);
                
                // êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ì¸ì§€ í™•ì¸í•˜ê³  íŒŒì‹±
                if (text.includes(':') && text.includes(';')) {
                    promptData.structuredPrompt = parsePrompt(text);
                    createPromptCards(promptData.structuredPrompt);
                    // êµ¬ì¡°ë¡œ ì¸ì‹ë˜ë©´ ì¤„ë°”ê¿ˆ í¬ë§·ìœ¼ë¡œ í‘œì‹œ
                    previewText = structureToMultilineText(promptData.structuredPrompt);
                } else {
                    promptCardsSection.style.display = 'none';
                }
            }
            

            if (!userEditingPreview) {
                promptPreview.textContent = previewText;
            }
            promptPreview.classList.add('has-content');
        }

        // í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸° ì§ì ‘ í¸ì§‘ ê¸°ëŠ¥
        promptPreview.addEventListener('input', () => {
            const text = promptPreview.innerText.trim();
            promptData.textInput = text;
            
            // êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ì¸ ê²½ìš° ìë™ìœ¼ë¡œ íŒŒì‹±
            if (text.includes(':') && text.includes(';')) {
                promptData.structuredPrompt = parsePrompt(text);
                createPromptCards(promptData.structuredPrompt);
                promptCardsSection.style.display = 'block';
            }
            
            saveToLocalStorage();
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë³µì›
        window.addEventListener('load', () => {
            loadFromLocalStorage();
            
            // localStorageì— ë°ì´í„°ê°€ ì—†ìœ¼ë©´ placeholderë§Œ í‘œì‹œ
            if (!promptData.textInput && !localStorage.getItem('imagePromptData')) {
                // ê¸°ë³¸ê°’ ì„¤ì • ì œê±° - ì‚¬ìš©ìê°€ ì˜ˆì‹œ í”„ë¡¬í”„íŠ¸ ë²„íŠ¼ì„ í´ë¦­í•´ì•¼ë§Œ ë¡œë“œ
            }
            
            // AI ìˆ˜ì •ì„ ìœ„í•´ ì „ë‹¬ë°›ì€ í”„ë¡¬í”„íŠ¸ê°€ ìˆëŠ”ì§€ í™•ì¸
            const aiEditPrompt = localStorage.getItem('aiEditPrompt');
            if (aiEditPrompt) {
                // í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥ì°½ì— ì„¤ì •
                promptPreview.textContent = aiEditPrompt;
                promptPreview.classList.add('has-content');
                userEditingPreview = true;
                
                // promptData ì—…ë°ì´íŠ¸
                promptData.textInput = aiEditPrompt;
                
                // êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ì¸ ê²½ìš° ìë™ íŒŒì‹±
                if (aiEditPrompt.includes(':') && (aiEditPrompt.includes(';') || aiEditPrompt.includes('\n'))) {
                    const parsedStructure = parsePrompt(aiEditPrompt);
                    if (Object.keys(parsedStructure).length > 0) {
                        promptData.structuredPrompt = parsedStructure;
                        createPromptCards(parsedStructure);
                        promptCardsSection.style.display = 'block';
                    }
                }
                
                // ì‚¬ìš© í›„ localStorageì—ì„œ ì œê±°
                localStorage.removeItem('aiEditPrompt');
                
                // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
                showToast('í”„ë¡¬í”„íŠ¸ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.', 'success');
            }
            
            // í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸°ì— ê¸°ë³¸ê°’ì´ ìˆìœ¼ë©´ í™•ì¸
            if (promptData.textInput) {
                // êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ì¸ ê²½ìš° ìë™ìœ¼ë¡œ íŒŒì‹±í•˜ì—¬ ì¹´ë“œ ìƒì„±
                const text = promptData.textInput;
                if (text.includes(':') && text.includes(';')) {
                    promptData.structuredPrompt = parsePrompt(text);
                    createPromptCards(promptData.structuredPrompt);
                }
            }
            
            // êµ¬ì¡° í¸ì§‘ê¸° íƒ­ì„ ê¸°ë³¸ì ìœ¼ë¡œ í‘œì‹œ
            const hasStructuredData = Object.keys(promptData.structuredPrompt).length > 0;
            if (hasStructuredData) {
                // ì €ì¥ëœ êµ¬ì¡°í™” ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì¹´ë“œ ìƒì„±
                createPromptCards(promptData.structuredPrompt);
            } else {
                // êµ¬ì¡°í™” ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ í…œí”Œë¦¿ìœ¼ë¡œ ì´ˆê¸°í™”
                const characterTemplate = {
                    'STYLE': '',
                    'MEDIUM': '',
                    'CHARACTER': '',
                    'CAMERA': '',
                    'GAZE': '',
                    'CHARACTER_SHEET': ''
                };
                promptData.structuredPrompt = characterTemplate;
                createPromptCards(characterTemplate);
            }
            promptCardsSection.style.display = 'block';
            
            updatePromptPreview();

            // í”„ë¦¬ë·° ì§ì ‘ ì…ë ¥ ì œì–´
            promptPreview.addEventListener('focus', () => {
                userEditingPreview = true;
            });
            promptPreview.addEventListener('input', () => {
                userEditingPreview = true;
            });
            promptPreview.addEventListener('blur', () => {
                const manualText = (promptPreview.textContent || '').trim();
                userEditingPreview = false;
                if (!manualText) {
                    // ë¹„ì›Œì¡Œìœ¼ë©´ ìƒíƒœ ì´ˆê¸°í™” í›„ ìë™ ë¯¸ë¦¬ë³´ê¸° ë³µêµ¬
                    promptData.structuredPrompt = {};
                    updatePromptPreview();
                    return;
                }
                if (manualText.includes(':') && (manualText.includes(';') || manualText.includes('\n'))) {
                    // êµ¬ì¡°í™” í…ìŠ¤íŠ¸ë¡œ í•´ì„ (ì„¸ë¯¸ì½œë¡  ë˜ëŠ” ì¤„ë°”ê¿ˆ í˜•ì‹)
                    promptData.structuredPrompt = parsePrompt(manualText);
                    createPromptCards(promptData.structuredPrompt);
                    promptCardsSection.style.display = 'block';
                } else {
                    // êµ¬ì¡°í™” ì•„ë‹˜ â†’ ì¹´ë“œ ìˆ¨ê¹€, í…ìŠ¤íŠ¸ë§Œ ìœ ì§€
                    promptData.structuredPrompt = {};
                    promptCardsSection.style.display = 'none';
                }
                saveToLocalStorage();
            });
        });

        // ì¹´ë“œ ì…ë ¥ì°½ í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬
        function handleCardKeydown(event, key) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                saveCard(key);
            } else if (event.key === 'Escape') {
                event.preventDefault();
                cancelCard(key);
            }
        }

        // í”„ë¡¬í”„íŠ¸ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
        function importPromptFromPreview() {
            const previewText = promptPreview.textContent;
            // ì„¸ë¯¸ì½œë¡  í˜•ì‹ ë˜ëŠ” ì¤„ë°”ê¿ˆ í˜•ì‹ ëª¨ë‘ êµ¬ì¡°í™”ëœ ê²ƒìœ¼ë¡œ ì¸ì‹
            const hasStructured = !!previewText && previewText.includes(':') && 
                                (previewText.includes(';') || previewText.includes('\n'));

            // í”„ë¦¬ë·°ê°€ ë¹„ì—ˆê±°ë‚˜ êµ¬ì¡°í™”ë˜ì§€ ì•Šì€ ê²½ìš°: í˜„ì¬ êµ¬ì¡° í¸ì§‘ê¸° íƒ­ì˜ í…œí”Œë¦¿ ì‚¬ìš©
            if (!previewText || previewText.trim() === '' || !hasStructured) {
                const characterTemplate = {
                    'STYLE': 'professional portrait photography',
                    'MEDIUM': 'high quality photography',
                    'CHARACTER': 'Korean male 28',
                    'CAMERA': 'close-up shot, multiple angles',
                    'CHARACTER_SHEET': 'photo collage of same person, close-up portraits, front face, side profile, 3/4 angle, consistent person',
                    'BODY_TYPE': 'average build, 175cm',
                    'HAIR': 'black short neat side part',
                    'FACE_SHAPE': 'oval',
                    'FACIAL_FEATURES': 'straight eyebrows, dark brown almond eyes, medium nose, natural lips',
                    'SKIN': 'light beige smooth',
                    'EXPRESSION': 'neutral calm',
                    'GAZE': 'varied eye directions for each angle',
                    'CLOTHING': 'navy blue casual t-shirt',
                    'BACKGROUND': 'white background',
                    'LIGHTING': 'professional portrait lighting',
                    'QUALITY': 'high-end photography',
                    'PARAMETERS': '--ar 16:9 --v 6'
                };

                const generalTemplate = {
                    'STYLE': 'cinematic photography',
                    'MEDIUM': 'digital photography',
                    'ERA/CULTURAL_REF': '(ì„ íƒ)',
                    'CAMERA': 'wide shot, low angle',
                    'SCENE': 'two people talking in car during chase',
                    'CHARACTER_1': 'young woman driving, tense expression',
                    'CHARACTER_1_DETAIL': 'ponytail, leather jacket',
                    'CHARACTER_2': 'man in passenger seat, looking back',
                    'CHARACTER_2_DETAIL': 'stubble, white shirt',
                    'CHARACTER_3': '(ì„ íƒ)',
                    'CHARACTER_3_DETAIL': '(ì„ íƒ)',
                    'CHARACTER_4': '(ì„ íƒ)',
                    'CHARACTER_4_DETAIL': '(ì„ íƒ)',
                    'CHARACTER_5': '(ì„ íƒ)',
                    'CHARACTER_5_DETAIL': '(ì„ íƒ)',
                    'CAMERA_EFFECTS': 'motion blur, shallow DOF',
                    'LOCATION': 'city highway at rush hour',
                    'LOCATION_DETAIL': 'inside sedan, leather seats',
                    'TIME_LIGHTING': 'golden hour sunlight',
                    'ARTIFICIAL_LIGHT': 'dashboard glow, street lights',
                    'LIGHTING_TECHNIQUE': 'backlit silhouettes',
                    'ATMOSPHERE': 'tense, urgent',
                    'WEATHER': 'clear',
                    'FOREGROUND': 'dashboard',
                    'BACKGROUND': 'blurred city skyline',
                    'COLOR_TONE': 'warm oranges, deep shadows',
                    'CAMERA_TECH': 'Canon 5D, 24mm lens, f/2.8 (ì„ íƒ)',
                    'QUALITY': 'photorealistic',
                    'PARAMETERS': '--ar 16:9 --v 7'
                };

                const chosen = currentStructureTab === 'character' ? characterTemplate : generalTemplate;
                promptData.structuredPrompt = chosen;
                createPromptCards(chosen);
                promptCardsSection.style.display = 'block';
                // í”„ë¦¬ë·°ëŠ” ì‚¬ìš©ìê°€ ë³´ê³  ìˆëŠ” ë‚´ìš©ì„ ë³´ì¡´í•˜ê¸° ìœ„í•´ ì¦‰ì‹œ ê°±ì‹ í•˜ì§€ ì•ŠìŒ
                showToast('í…œí”Œë¦¿ì„ êµ¬ì¡° í¸ì§‘ê¸°ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤. ê° í•­ëª©ì„ í¸ì§‘í•˜ì„¸ìš”.', 'success');
                return;
            }

            // í”„ë¦¬ë·°ê°€ êµ¬ì¡°í™”ëœ ê²½ìš°: í”„ë¦¬ë·°ë¥¼ íŒŒì‹±í•˜ì—¬ ì¹´ë“œ ìƒì„±
            const parsed = parsePrompt(previewText);
            console.log('ê°€ì ¸ì˜¤ê¸°: íŒŒì‹±ëœ êµ¬ì¡°', parsed);
            
            // íŒŒì‹±ëœ í‚¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì–´ë–¤ íƒ­ì„ ì‚¬ìš©í• ì§€ ìë™ ê°ì§€
            const hasCharacterKeys = ['CHARACTER_SHEET', 'BODY_TYPE', 'HAIR', 'FACE_SHAPE', 'FACIAL_FEATURES', 'SKIN', 'EXPRESSION', 'GAZE'].some(key => parsed[key]);
            const hasGeneralKeys = ['SCENE', 'LOCATION', 'LOCATION_DETAIL', 'TIME_LIGHTING', 'ARTIFICIAL_LIGHT', 'ATMOSPHERE', 'WEATHER', 'FOREGROUND', 'BACKGROUND'].some(key => parsed[key]);
            
            // ìë™ íƒ­ ì „í™˜ ìš°ì„ ìˆœìœ„: ìºë¦­í„° > ì¼ë°˜ì´ë¯¸ì§€ > ìœ ì§€
            if (hasCharacterKeys) {
                // ìºë¦­í„° ê´€ë ¨ í‚¤ê°€ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ ìºë¦­í„° íƒ­ìœ¼ë¡œ
                switchStructureTab('character');
            } else if (hasGeneralKeys) {
                // ìºë¦­í„° í‚¤ê°€ ì—†ê³  ì¼ë°˜ í‚¤ê°€ ìˆìœ¼ë©´ ì¼ë°˜ì´ë¯¸ì§€ íƒ­ìœ¼ë¡œ
                switchStructureTab('general');
            }
            // ë‘˜ ë‹¤ ì—†ìœ¼ë©´ í˜„ì¬ íƒ­ ìœ ì§€
            
            const defaultKeys = ['STYLE', 'MEDIUM', 'CAMERA', 'SUBJECT', 'CHARACTER', 'FURNITURE', 'PROPS', 'AI ROBOTS', 'LIGHTING', 'ENVIRONMENT', 'ATMOSPHERE', 'QUALITY', 'PARAMETERS'];
            const structuredData = {};
            defaultKeys.forEach(key => { structuredData[key] = parsed[key] || ''; });
            Object.keys(parsed).forEach(key => { if (!defaultKeys.includes(key)) { structuredData[key] = parsed[key]; } });
            promptData.structuredPrompt = structuredData;
            createPromptCards(structuredData);
            promptCardsSection.style.display = 'block';
            // í”„ë¦¬ë·°ëŠ” ì¦‰ì‹œ ê°±ì‹ í•˜ì§€ ì•ŠìŒ (ì‚¬ìš©ì ì…ë ¥ ë³´í˜¸)
            showToast('í”„ë¡¬í”„íŠ¸ë¥¼ êµ¬ì¡° í¸ì§‘ê¸°ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.', 'success');
        }

        // ìºë¦­í„° í…Œì´ë¸” ê°’ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateStructureValue(key, value) {
            promptData.structuredPrompt[key] = value;
            saveToLocalStorage();
            
            // í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
            if (!userEditingPreview) {
                const multilineText = structureToMultilineText(promptData.structuredPrompt);
                promptPreview.textContent = multilineText;
            }
        }
        
        // ë“œë¡­ë‹¤ìš´ í† ê¸€ í•¨ìˆ˜ (í•˜ë‚˜ë§Œ ì—´ë¦¼ ìœ ì§€)
        function toggleDropdown(container) {
            // ì´ë¯¸ ì—´ë ¤ìˆëŠ” ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆ ëª¨ë‘ ë‹«ê¸°
            document.querySelectorAll('.dropdown-container.active').forEach((open) => {
                if (open !== container) {
                    open.classList.remove('active');
                }
            });
            // í˜„ì¬ ì»¨í…Œì´ë„ˆ í† ê¸€
            container.classList.toggle('active');
        }
        
        // ìŠ¤íƒ€ì¼ ë“œë¡­ë‹¤ìš´ í† ê¸€
        function toggleStyleDropdown(button) {
            event.stopPropagation();
            event.preventDefault();
            
            const wrapper = button.closest('.select-input-wrapper');
            const dropdown = wrapper.querySelector('.style-options-dropdown');
            const isOpen = dropdown.style.display !== 'none';
            
            // ëª¨ë“  ì—´ë¦° ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
            closeAllDropdowns();
            
            if (!isOpen) {
                // ë“œë¡­ë‹¤ìš´ ì—´ê¸°
                dropdown.style.display = 'flex';
                button.classList.add('active');
                activeDropdown = dropdown;
                currentFocusedIndex = -1;
                
                // ARIA ì†ì„± ì„¤ì •
                button.setAttribute('aria-expanded', 'true');
                dropdown.setAttribute('role', 'listbox');
                
                // ë“œë¡­ë‹¤ìš´ ì„ íƒ ìƒíƒœ ì´ˆê¸°í™”
                if (!wrapper.dropdownSelections) {
                    wrapper.dropdownSelections = [];
                }
                
                // í˜„ì¬ ì…ë ¥ê°’ì—ì„œ ë“œë¡­ë‹¤ìš´ ì˜µì…˜ì— í•´ë‹¹í•˜ëŠ” ê°’ë“¤ ì°¾ê¸°
                const input = wrapper.querySelector('.dropdown-field-input');
                const currentValues = input.value.trim() ? input.value.split(',').map(v => v.trim()).filter(v => v) : [];
                const options = dropdown.querySelectorAll('.style-option');
                
                // ë“œë¡­ë‹¤ìš´ ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸
                wrapper.dropdownSelections = [];
                options.forEach(option => {
                    const optionValue = option.textContent.trim();
                    if (currentValues.includes(optionValue)) {
                        option.classList.add('selected');
                        wrapper.dropdownSelections.push(optionValue);
                    } else {
                        option.classList.remove('selected');
                    }
                });
                
                // ê²€ìƒ‰ ì…ë ¥ì°½ì— í¬ì»¤ìŠ¤
                setTimeout(() => {
                    const searchInput = dropdown.querySelector('.style-options-search input');
                    searchInput.focus();
                    
                    // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                    addKeyboardListeners(dropdown, wrapper);
                    
                    // ë“œë¡­ë‹¤ìš´ì´ í™”ë©´ì— ë³´ì´ë„ë¡ ìœ„ì¹˜ ì¡°ì • ë° ìŠ¤í¬ë¡¤
                    const dropdownRect = dropdown.getBoundingClientRect();
                    const windowHeight = window.innerHeight;
                    const inputRect = wrapper.getBoundingClientRect();
                    
                    // ë“œë¡­ë‹¤ìš´ì€ í•­ìƒ ì•„ë˜ë¡œë§Œ ì—´ë¦¬ê²Œ ê³ ì •í•˜ê³ , í™”ë©´ ë°–ì´ë©´ ìŠ¤í¬ë¡¤ë¡œ ë³´ì´ê²Œ í•¨
                    dropdown.style.top = 'calc(100% + 4px)';
                    dropdown.style.bottom = 'auto';
                    if (dropdownRect.bottom > windowHeight - 20) {
                        const scrollAmount = dropdownRect.bottom - windowHeight + 50; // 50px ì—¬ìœ 
                        window.scrollBy({ top: scrollAmount, behavior: 'smooth' });
                    }
                    
                    // ë“œë¡­ë‹¤ìš´ ë‚´ë¶€ í´ë¦­ ì´ë²¤íŠ¸ ì „íŒŒ ì°¨ë‹¨
                    dropdown.addEventListener('click', (e) => {
                        e.stopPropagation();
                    });
                }, 50);
            }
        }
        
        // ìŠ¤íƒ€ì¼ ì˜µì…˜ ì„ íƒ (ë‹¤ì¤‘ ì„ íƒ ì§€ì›)
        function selectStyleOption(element, value, inputKey) {
            event.stopPropagation();
            event.preventDefault();
            
            const wrapper = element.closest('.select-input-wrapper');
            const input = wrapper.querySelector('.dropdown-field-input');
            
            // í˜„ì¬ ì…ë ¥ê°’ì„ ë°°ì—´ë¡œ ë³€í™˜ (ì‰¼í‘œë¡œ êµ¬ë¶„)
            let currentValues = input.value.trim() ? input.value.split(',').map(v => v.trim()).filter(v => v) : [];
            
            // ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒëœ ê°’ë“¤ë§Œ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ë°ì´í„° ì†ì„±
            if (!wrapper.dropdownSelections) {
                wrapper.dropdownSelections = [];
            }
            
            // ì´ë¯¸ ë“œë¡­ë‹¤ìš´ì—ì„œ ì„ íƒëœ ê°’ì¸ì§€ í™•ì¸
            const dropdownIndex = wrapper.dropdownSelections.indexOf(value);
            
            if (dropdownIndex > -1) {
                // ì´ë¯¸ ì„ íƒëœ ê²½ìš° ì œê±° (í† ê¸€)
                wrapper.dropdownSelections.splice(dropdownIndex, 1);
                element.classList.remove('selected');
                
                // ì „ì²´ ê°’ì—ì„œë„ ì œê±°
                const valueIndex = currentValues.indexOf(value);
                if (valueIndex > -1) {
                    currentValues.splice(valueIndex, 1);
                }
            } else {
                // ì„ íƒë˜ì§€ ì•Šì€ ê²½ìš° ì¶”ê°€
                wrapper.dropdownSelections.push(value);
                element.classList.add('selected');
                
                // ì „ì²´ ê°’ì— ì¶”ê°€ (ì¤‘ë³µ í™•ì¸)
                if (!currentValues.includes(value)) {
                    currentValues.push(value);
                }
            }
            
            // ì…ë ¥ í•„ë“œì— ì—…ë°ì´íŠ¸
            input.value = currentValues.join(', ');
            input.dispatchEvent(new Event('change'));
            
            // êµ¬ì¡° ë°ì´í„° ì—…ë°ì´íŠ¸
            const key = inputKey.replace('-request', '');
            updateStructureValue(key, input.value);
            
            // ë“œë¡­ë‹¤ìš´ì€ ì—´ì–´ë‘  (ë‹¤ì¤‘ ì„ íƒì„ ìœ„í•´)
        }
        
        // ìŠ¤íƒ€ì¼ ë“œë¡­ë‹¤ìš´ í•„í„°ë§
        function filterStyleDropdown(searchInput) {
            const searchValue = searchInput.value.toLowerCase();
            const dropdown = searchInput.closest('.style-options-dropdown');
            const options = dropdown.querySelectorAll('.style-option');
            
            options.forEach(option => {
                const text = option.textContent.toLowerCase();
                if (text.includes(searchValue)) {
                    option.classList.remove('hidden');
                } else {
                    option.classList.add('hidden');
                }
            });
        }
        
        // ì…ë ¥ í•„ë“œì—ì„œ í•„í„°ë§
        function filterStyleOptions(input) {
            const searchValue = input.value.toLowerCase();
            const wrapper = input.closest('.select-input-wrapper');
            const dropdown = wrapper.querySelector('.style-options-dropdown');
            const options = dropdown.querySelectorAll('.style-option');
            
            options.forEach(option => {
                const text = option.textContent.toLowerCase();
                if (text.includes(searchValue)) {
                    option.classList.remove('hidden');
                } else {
                    option.classList.add('hidden');
                }
            });
        }
        
        // ëª¨ë“  ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
        function closeAllDropdowns() {
            document.querySelectorAll('.style-options-dropdown').forEach(dropdown => {
                const button = dropdown.parentElement.querySelector('.dropdown-toggle-btn');
                closeDropdown(dropdown, button);
            });
            activeDropdown = null;
            currentFocusedIndex = -1;
        }
        
        // íŠ¹ì • ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
        function closeDropdown(dropdown, button) {
            dropdown.style.display = 'none';
            button.classList.remove('active');
            button.setAttribute('aria-expanded', 'false');
            
            // í¬ì»¤ìŠ¤ëœ ì˜µì…˜ ìŠ¤íƒ€ì¼ ì œê±°
            dropdown.querySelectorAll('.style-option').forEach(option => {
                option.classList.remove('focused');
            });
            
            // ë“œë¡­ë‹¤ìš´ ìœ„ì¹˜ ì´ˆê¸°í™” (í•­ìƒ ì•„ë˜ë¡œ)
            dropdown.style.bottom = 'auto';
            dropdown.style.top = 'calc(100% + 4px)';
        }
        
        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        function addKeyboardListeners(dropdown, wrapper) {
            const searchInput = dropdown.querySelector('.style-options-search input');
            const input = wrapper.querySelector('.dropdown-field-input');
            
            // ê²€ìƒ‰ ì…ë ¥ì°½ í‚¤ë³´ë“œ ì´ë²¤íŠ¸
            searchInput.addEventListener('keydown', (e) => {
                handleDropdownKeyboard(e, dropdown, wrapper);
            });
            
            // ë“œë¡­ë‹¤ìš´ ì „ì²´ í‚¤ë³´ë“œ ì´ë²¤íŠ¸
            dropdown.addEventListener('keydown', (e) => {
                handleDropdownKeyboard(e, dropdown, wrapper);
            });
        }
        
        // ë“œë¡­ë‹¤ìš´ í‚¤ë³´ë“œ í•¸ë“¤ëŸ¬
        function handleDropdownKeyboard(e, dropdown, wrapper) {
            const options = Array.from(dropdown.querySelectorAll('.style-option:not(.hidden)'));
            const button = wrapper.querySelector('.dropdown-toggle-btn');
            
            switch(e.key) {
                case 'ArrowDown':
                    e.preventDefault();
                    currentFocusedIndex = Math.min(currentFocusedIndex + 1, options.length - 1);
                    updateFocusedOption(options);
                    break;
                    
                case 'ArrowUp':
                    e.preventDefault();
                    currentFocusedIndex = Math.max(currentFocusedIndex - 1, -1);
                    updateFocusedOption(options);
                    break;
                    
                case 'Enter':
                    e.preventDefault();
                    if (currentFocusedIndex >= 0 && options[currentFocusedIndex]) {
                        options[currentFocusedIndex].click();
                    }
                    break;
                    
                case 'Escape':
                    e.preventDefault();
                    closeDropdown(dropdown, button);
                    wrapper.querySelector('.dropdown-field-input').focus();
                    break;
                    
                case 'Tab':
                    // Tab í‚¤ëŠ” ë“œë¡­ë‹¤ìš´ì„ ë‹«ê³  ë‹¤ìŒ ìš”ì†Œë¡œ ì´ë™
                    e.preventDefault();
                    closeDropdown(dropdown, button);
                    break;
            }
        }
        
        // í¬ì»¤ìŠ¤ëœ ì˜µì…˜ ì—…ë°ì´íŠ¸
        function updateFocusedOption(options) {
            options.forEach((option, index) => {
                if (index === currentFocusedIndex) {
                    option.classList.add('focused');
                    option.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
                } else {
                    option.classList.remove('focused');
                }
            });
        }
        
        // í´ë¦­ ì™¸ë¶€ ì˜ì—­ ì²˜ë¦¬
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.select-input-wrapper')) {
                closeAllDropdowns();
            }
        });
        
        // ì €ì¥ ë²„íŠ¼ í´ë¦­ ì‹œ ë³€ê²½ìš”ì²­ ê°’ì„ ë³€ê²½ë°˜ì˜ìœ¼ë¡œ ë³µì‚¬
        function saveToApplied(event, key) {
            // ì €ì¥ ë²„íŠ¼ì„ í´ë¦­í•œ ë“œë¡­ë‹¤ìš´ ì»¨í…Œì´ë„ˆ ì°¾ê¸°
            const button = event.target;
            let container = button.closest('.dropdown-container');
            
            if (!container) {
                // í‚¤ë¡œ ì§ì ‘ ì°¾ê±°ë‚˜, í™œì„± ì»¨í…Œì´ë„ˆë¡œ ëŒ€ì²´
                container = document.querySelector(`.dropdown-container[data-key="${key}"]`) ||
                            document.querySelector('.dropdown-container.active');
                if (!container) {
                    showToast('ë“œë¡­ë‹¤ìš´ì„ ë¨¼ì € ì—´ì–´ì£¼ì„¸ìš”.', 'error');
                    return;
                }
            }
            
            const requestInput = container.querySelector(`input[data-key="${key}-request"]`);
            const appliedInput = container.querySelector(`input[data-key="${key}-applied"]`);
            const existingInput = container.querySelector(`input[data-key="${key}"]`);
            
            if (!appliedInput) return;
            
            const requestValue = (requestInput?.value || '').trim();
            let valueToApply = requestValue;
            
            if (!valueToApply) {
                // ìš”ì²­ê°’ì´ ì—†ìœ¼ë©´ ë™ì¼ ì¹´ë“œì˜ ê¸°ì¡´ë‚´ìš© â†’ ì „ì—­ ìƒíƒœ ìˆœìœ¼ë¡œ ì‚¬ìš©
                valueToApply = (existingInput?.value || '').trim();
                if (!valueToApply) {
                    valueToApply = (promptData?.structuredPrompt?.[key] || '').trim();
                }
            }
            
            if (valueToApply) {
                appliedInput.value = valueToApply;
                // êµ¬ì¡° ë°ì´í„° ì¦‰ì‹œ ë°˜ì˜í•˜ì—¬ í”„ë¦¬ë·°/ì €ì¥ ë™ê¸°í™”
                updateStructureValue(key, valueToApply);
                showToast(requestValue ? 'ë³€ê²½ìš”ì²­ ë‚´ìš©ì´ ë³€ê²½ë°˜ì˜ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ê¸°ì¡´ ë‚´ìš©ì´ ë³€ê²½ë°˜ì˜ìœ¼ë¡œ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            } else {
                showToast('ë³€ê²½ìš”ì²­ ë˜ëŠ” ê¸°ì¡´ë‚´ìš©ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // AIì €ì¥ ë²„íŠ¼ ê¸°ëŠ¥ - ì €ì¥ ë²„íŠ¼ê³¼ ë™ì¼í•œ ë™ì‘
        function aiSaveField(key) {
            const dropdownContainer = document.querySelector('.dropdown-container.active');
            if (!dropdownContainer) {
                showToast('ë“œë¡­ë‹¤ìš´ì„ ë¨¼ì € ì—´ì–´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            const container = dropdownContainer.querySelector('.dropdown-content');
            const requestInput = container.querySelector(`input[data-key="${key}-request"]`);
            const appliedInput = container.querySelector(`input[data-key="${key}-applied"]`);
            const existingInput = container.querySelector(`input[data-key="${key}"]`);
            
            if (!appliedInput) return;
            
            const requestValue = (requestInput?.value || '').trim();
            let valueToApply = requestValue;
            
            if (!valueToApply) {
                // ìš”ì²­ê°’ì´ ì—†ìœ¼ë©´ ë™ì¼ ì¹´ë“œì˜ ê¸°ì¡´ë‚´ìš© â†’ ì „ì—­ ìƒíƒœ ìˆœìœ¼ë¡œ ì‚¬ìš©
                valueToApply = (existingInput?.value || '').trim();
                if (!valueToApply) {
                    valueToApply = (promptData?.structuredPrompt?.[key] || '').trim();
                }
            }
            
            if (valueToApply) {
                appliedInput.value = valueToApply;
                // êµ¬ì¡° ë°ì´í„° ì¦‰ì‹œ ë°˜ì˜í•˜ì—¬ í”„ë¦¬ë·°/ì €ì¥ ë™ê¸°í™”
                updateStructureValue(key, valueToApply);
                console.log(`[AI ì €ì¥] ${key}: ${valueToApply}`);
            } else {
                console.log(`[AI ì €ì¥] ${key}: ë¹„ì–´ìˆìŒ`);
            }
        }
        
        // window ì „ì—­ í•¨ìˆ˜ë¡œ ë“±ë¡ (ì¸ë¼ì¸ onclickìš©)
        window.removeImage = removeImage;
        window.editCard = editCard;
        window.saveCard = saveCard;
        window.cancelCard = cancelCard;
        window.importPromptFromPreview = importPromptFromPreview;
        window.handleCardKeydown = handleCardKeydown;
        window.switchStructureTab = switchStructureTab;
        window.switchCharacterSubTab = switchCharacterSubTab;
        window.switchGeneralSubTab = switchGeneralSubTab;
        window.updateStructureValue = updateStructureValue;
        window.toggleDropdown = toggleDropdown;
        window.toggleStyleDropdown = toggleStyleDropdown;
        window.selectStyleOption = selectStyleOption;
        window.saveToApplied = saveToApplied;
        window.aiSaveField = aiSaveField;
        window.filterStyleDropdown = filterStyleDropdown;
        window.filterStyleOptions = filterStyleOptions;
        
        // AI í”„ë¡¬í”„íŠ¸ ìƒì„± ê´€ë ¨ í•¨ìˆ˜ë“¤ - ë¨¼ì € ì •ì˜
        async function generateAIPrompt() {
            console.log('AI í”„ë¡¬í”„íŠ¸ ìƒì„± ì‹œì‘');
            
            // API ì„¤ì • í™•ì¸
            const config = localStorage.getItem('aiApiConfig');
            if (!config) {
                console.log('API ì„¤ì •ì´ ì—†ìŠµë‹ˆë‹¤. ëª¨ë‹¬ì„ ì—½ë‹ˆë‹¤.');
                showToast('API ì„¤ì •ì„ ë¨¼ì € í•´ì£¼ì„¸ìš”.', 'error');
                openApiModal();
                return;
            }
            
            console.log('API ì„¤ì • í™•ì¸:', JSON.parse(config));
            
            // ëª¨ë“  ë³€ê²½ ë°˜ì˜ í…ìŠ¤íŠ¸ì°½ì˜ ë‚´ìš© ìˆ˜ì§‘
            const collectedData = collectAllAppliedData();
            console.log('ìˆ˜ì§‘ëœ ë°ì´í„°:', collectedData);
            
            if (Object.keys(collectedData).length === 0) {
                showToast('ë³€ê²½ ë°˜ì˜ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.', 'error');
                console.log('ë³€ê²½ ë°˜ì˜ëœ ë‚´ìš©ì´ ì—†ì–´ì„œ ì¢…ë£Œí•©ë‹ˆë‹¤.');
                return;
            }
            
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            const aiGenerateBtn = document.getElementById('ai-generate-prompt-btn');
            if (!aiGenerateBtn) {
                console.error('AI í”„ë¡¬í”„íŠ¸ ìƒì„± ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                showToast('ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            const originalText = aiGenerateBtn.innerHTML;
            aiGenerateBtn.disabled = true;
            aiGenerateBtn.innerHTML = 'ğŸ”„ AI í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘...';
            
            try {
                // AI APIë¥¼ í†µí•œ í”„ë¡¬í”„íŠ¸ ìµœì í™”
                const optimizedPrompt = await optimizePromptWithAI(collectedData);
                
                // ê¸°ì¡´ í”„ë¡¬í”„íŠ¸ì™€ ë³‘í•©
                mergeOptimizedPrompt(optimizedPrompt);
                
                showToast('AI í”„ë¡¬í”„íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            } catch (error) {
                console.error('AI í”„ë¡¬í”„íŠ¸ ìƒì„± ì‹¤íŒ¨:', error);
                // ë” ìì„¸í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
                let errorMessage = 'AI í”„ë¡¬í”„íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                if (error.message.includes('CORS')) {
                    errorMessage = 'CORS ì˜¤ë¥˜: Chrome í™•ì¥ í”„ë¡œê·¸ë¨(Allow CORS)ì„ ì„¤ì¹˜í•˜ê±°ë‚˜ í”„ë¡ì‹œ ì„œë²„ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.';
                } else if (error.message.includes('401')) {
                    errorMessage = 'API í‚¤ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
                } else if (error.message.includes('404')) {
                    errorMessage = 'ëª¨ë¸ëª…ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. gemini-1.5-flash ë˜ëŠ” gemini-proë¥¼ ì‚¬ìš©í•´ë³´ì„¸ìš”.';
                } else if (error.message.includes('429')) {
                    errorMessage = 'API ìš”ì²­ í•œë„ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                }
                showToast(errorMessage, 'error');
            } finally {
                if (aiGenerateBtn) {
                    aiGenerateBtn.disabled = false;
                    aiGenerateBtn.innerHTML = originalText;
                }
            }
        }
        
        // í•¨ìˆ˜ë¥¼ ì¦‰ì‹œ windowì— í• ë‹¹
        window.generateAIPrompt = generateAIPrompt;
        
        // ë””ë²„ê¹…ì„ ìœ„í•œ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        window.testGeminiAPI = async function() {
            console.log('=== Gemini API ë””ë²„ê¹… í…ŒìŠ¤íŠ¸ ì‹œì‘ ===');
            const config = localStorage.getItem('aiApiConfig');
            if (!config) {
                console.error('API ì„¤ì •ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € APIë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const parsedConfig = JSON.parse(config);
            console.log('í˜„ì¬ ì„¤ì •:', parsedConfig);
            
            if (parsedConfig.provider !== 'gemini') {
                console.error('Gemini APIê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.');
                return;
            }
            
            const testUrl = `https://generativelanguage.googleapis.com/v1beta/models/${parsedConfig.model}:generateContent?key=${parsedConfig.apiKey}`;
            console.log('í…ŒìŠ¤íŠ¸ URL:', testUrl.replace(parsedConfig.apiKey, 'API_KEY_HIDDEN'));
            
            const testBody = {
                contents: [{
                    parts: [{
                        text: "Hello, please respond with 'Hi' if you receive this message."
                    }]
                }],
                generationConfig: {
                    temperature: 0.1,
                    maxOutputTokens: 50
                }
            };
            
            console.log('ìš”ì²­ ë³¸ë¬¸:', testBody);
            
            try {
                console.log('API í˜¸ì¶œ ì‹œì‘...');
                const response = await fetch(testUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testBody)
                });
                
                console.log('ì‘ë‹µ ìƒíƒœ:', response.status, response.statusText);
                console.log('ì‘ë‹µ í—¤ë”:', Object.fromEntries(response.headers.entries()));
                
                const responseText = await response.text();
                console.log('ì›ë³¸ ì‘ë‹µ:', responseText);
                
                try {
                    const data = JSON.parse(responseText);
                    console.log('íŒŒì‹±ëœ ì‘ë‹µ:', data);
                    
                    if (data.candidates && data.candidates[0]) {
                        console.log('âœ… API ì—°ê²° ì„±ê³µ!');
                        console.log('ì‘ë‹µ í…ìŠ¤íŠ¸:', data.candidates[0].content.parts[0].text);
                    } else if (data.error) {
                        console.error('âŒ API ì˜¤ë¥˜:', data.error);
                    }
                } catch (e) {
                    console.error('JSON íŒŒì‹± ì‹¤íŒ¨:', e);
                }
            } catch (error) {
                console.error('âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜:', error);
                if (error.message.includes('Failed to fetch')) {
                    console.error('ğŸ’¡ CORS ì˜¤ë¥˜ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.');
                    console.error('í•´ê²° ë°©ë²•:');
                    console.error('1. Chrome í™•ì¥ í”„ë¡œê·¸ë¨ "Allow CORS" ì„¤ì¹˜');
                    console.error('2. https://cors-anywhere.herokuapp.com/ í”„ë¡ì‹œ ì‚¬ìš©');
                    console.error('3. ë°±ì—”ë“œ ì„œë²„ë¥¼ í†µí•œ API í˜¸ì¶œ');
                }
            }
            
            console.log('=== í…ŒìŠ¤íŠ¸ ì¢…ë£Œ ===');
        };
        
        // ëª¨ë“  ë³€ê²½ ë°˜ì˜ ë°ì´í„° ìˆ˜ì§‘
        function collectAllAppliedData() {
            const collectedData = {};
            console.log('collectAllAppliedData í•¨ìˆ˜ ì‹œì‘');
            
            // ëª¨ë“  ë“œë¡­ë‹¤ìš´ ì»¨í…Œì´ë„ˆì—ì„œ ë³€ê²½ ë°˜ì˜ ë‚´ìš© ìˆ˜ì§‘
            const containers = document.querySelectorAll('.dropdown-container');
            console.log('ì°¾ì€ ë“œë¡­ë‹¤ìš´ ì»¨í…Œì´ë„ˆ ìˆ˜:', containers.length);
            
            containers.forEach((container, index) => {
                const appliedInputs = container.querySelectorAll('input[data-key$="-applied"]');
                console.log(`ì»¨í…Œì´ë„ˆ ${index}: ì°¾ì€ applied input ìˆ˜:`, appliedInputs.length);
                
                appliedInputs.forEach(input => {
                    const value = input.value.trim();
                    const key = input.getAttribute('data-key');
                    console.log(`Input key: ${key}, value: ${value}`);
                    
                    if (value) {
                        const cleanKey = key.replace('-applied', '');
                        collectedData[cleanKey] = value;
                    }
                });
            });
            
            // ëŒ€ì²´ ì„ íƒìë¡œ ì‹œë„
            if (Object.keys(collectedData).length === 0) {
                console.log('ê¸°ë³¸ ì„ íƒìë¡œ ë°ì´í„°ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ëŒ€ì²´ ë°©ë²• ì‹œë„...');
                
                // ëª¨ë“  input ìš”ì†Œ ì¤‘ì—ì„œ applied ê´€ë ¨ ì°¾ê¸°
                const allInputs = document.querySelectorAll('input[type="text"]');
                console.log('ì „ì²´ í…ìŠ¤íŠ¸ ì…ë ¥ í•„ë“œ ìˆ˜:', allInputs.length);
                
                allInputs.forEach(input => {
                    const dataKey = input.getAttribute('data-key');
                    const value = input.value.trim();
                    
                    if (dataKey && dataKey.includes('-applied') && value) {
                        const cleanKey = dataKey.replace('-applied', '');
                        collectedData[cleanKey] = value;
                        console.log(`ëŒ€ì²´ ë°©ë²•ìœ¼ë¡œ ì°¾ì€ ë°ì´í„°: ${cleanKey} = ${value}`);
                    }
                });
                
                // í”„ë¡¬í”„íŠ¸ í”„ë¦¬ë·°ì—ì„œ ì§ì ‘ ê°€ì ¸ì˜¤ê¸°
                if (Object.keys(collectedData).length === 0) {
                    console.log('applied ì…ë ¥ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. í”„ë¡¬í”„íŠ¸ í”„ë¦¬ë·°ì—ì„œ ì§ì ‘ ê°€ì ¸ì˜µë‹ˆë‹¤.');
                    const promptPreview = document.getElementById('prompt-preview');
                    if (promptPreview && promptPreview.textContent.trim()) {
                        collectedData['prompt-preview'] = promptPreview.textContent.trim();
                        console.log('í”„ë¡¬í”„íŠ¸ í”„ë¦¬ë·° ë‚´ìš©:', collectedData['prompt-preview']);
                    }
                }
            }
            
            console.log('ìµœì¢… ìˆ˜ì§‘ëœ ë°ì´í„°:', collectedData);
            return collectedData;
        }
        
        // AIë¥¼ í†µí•œ í”„ë¡¬í”„íŠ¸ ìµœì í™” ë° ì˜ë¬¸ ë²ˆì—­
        async function optimizePromptWithAI(data) {
            try {
                const configStr = localStorage.getItem('aiApiConfig');
                if (!configStr) {
                    throw new Error('API ì„¤ì •ì´ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                const config = JSON.parse(configStr);
                if (!config || !config.provider || !config.apiKey || !config.model) {
                    throw new Error('API ì„¤ì •ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                }
                
                const { provider, apiKey, model } = config;
                
                console.log('=== AI API ì„¤ì • ===');
                console.log('Provider:', provider);
                console.log('Model:', model);
                console.log('API Key:', apiKey ? `${apiKey.substring(0, 10)}...` : 'ì—†ìŒ');
                
                // ê° ì„¹ì…˜ë³„ë¡œ ê°œë³„ ìµœì í™”
                const optimizedData = {};
                
                for (const [key, value] of Object.entries(data)) {
                    if (!value || value.trim() === '') continue;
                    
                    console.log(`\n=== ${key} ì„¹ì…˜ ìµœì í™” ì‹œì‘ ===`);
                    console.log('ì›ë³¸:', value);
                    
                    try {
                        const optimizedText = await optimizeSinglePrompt(value, provider, apiKey, model);
                        optimizedData[key] = optimizedText;
                        console.log('ìµœì í™” ê²°ê³¼:', optimizedText);
                    } catch (error) {
                        console.error(`${key} ìµœì í™” ì‹¤íŒ¨:`, error);
                        // ì‹¤íŒ¨ ì‹œ ì›ë³¸ ì‚¬ìš©
                        optimizedData[key] = value;
                    }
                }
                
                return optimizedData;
            } catch (error) {
                console.error('AI ìµœì í™” ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                throw error;
            }
        }
        
        // ë‹¨ì¼ í”„ë¡¬í”„íŠ¸ ìµœì í™” í•¨ìˆ˜
        async function optimizeSinglePrompt(text, provider, apiKey, model) {
            // ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ í”„ë¡¬í”„íŠ¸ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜
            let promptText = text;
            } else {
                // êµ¬ì¡°í™”ëœ ë°ì´í„°ì¸ ê²½ìš°
                promptText = Object.entries(data)
                    .map(([key, value]) => `${key}: ${value}`)
                    .join(', ');
            }
            
            console.log('=== í”„ë¡¬í”„íŠ¸ ì •ë³´ ===');
            console.log('ì…ë ¥ ë°ì´í„°:', data);
            console.log('ë³€í™˜ëœ í”„ë¡¬í”„íŠ¸ í…ìŠ¤íŠ¸:', promptText);
            console.log('í…ìŠ¤íŠ¸ ê¸¸ì´:', promptText.length);
            
            const systemPrompt = `You are an expert at creating optimal prompts for AI image generation. 
Your task is to:
1. Take the provided Korean text describing image elements
2. Optimize it for AI image generation by adding relevant artistic details, style, lighting, mood, and technical specifications
3. Translate everything to English while maintaining the artistic intent
4. Output ONLY the optimized English prompt without any explanations or additional text

Focus on creating vivid, detailed descriptions that will produce high-quality AI-generated images.`;
            
            try {
                let optimizedText;
                
                if (provider === 'gemini') {
                    const geminiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;
                    const geminiBody = {
                        contents: [{
                            parts: [{
                                text: `${systemPrompt}\n\nOptimize this Korean prompt for image generation: ${promptText}`
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.8,
                            maxOutputTokens: 1000
                        }
                    };
                    
                    console.log('=== Gemini API ìš”ì²­ ===');
                    console.log('URL:', geminiUrl.replace(apiKey, 'API_KEY_HIDDEN'));
                    console.log('Model:', model);
                    console.log('Request Body:', JSON.stringify(geminiBody, null, 2));
                    
                    // ì§€ì›ë˜ëŠ” ëª¨ë¸ ëª©ë¡ í‘œì‹œ
                    console.log('ğŸ’¡ ì§€ì›ë˜ëŠ” Gemini ëª¨ë¸: gemini-1.5-flash, gemini-1.5-pro, gemini-pro');
                    
                    const response = await fetch(geminiUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(geminiBody)
                    });
                    
                    console.log('=== Gemini API ì‘ë‹µ ìƒíƒœ ===');
                    console.log('Status:', response.status);
                    console.log('StatusText:', response.statusText);
                    console.log('Headers:', response.headers);
                    
                    const responseText = await response.text();
                    console.log('Raw Response:', responseText);
                    
                    let data;
                    try {
                        data = JSON.parse(responseText);
                    } catch (parseError) {
                        console.error('JSON íŒŒì‹± ì‹¤íŒ¨:', parseError);
                        console.error('ì‘ë‹µ í…ìŠ¤íŠ¸:', responseText);
                        throw new Error('API ì‘ë‹µì„ íŒŒì‹±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                    
                    if (response.ok) {
                        console.log('Parsed Gemini API ì‘ë‹µ:', JSON.stringify(data, null, 2));
                        
                        // ë‹¤ì–‘í•œ ì‘ë‹µ êµ¬ì¡° ì²˜ë¦¬
                        if (data && data.candidates && data.candidates.length > 0) {
                            const candidate = data.candidates[0];
                            if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {
                                optimizedText = candidate.content.parts[0].text;
                                console.log('Gemini ìµœì í™”ëœ í…ìŠ¤íŠ¸:', optimizedText);
                            } else if (candidate.text) {
                                // ë‹¤ë¥¸ ê°€ëŠ¥í•œ ì‘ë‹µ êµ¬ì¡°
                                optimizedText = candidate.text;
                                console.log('Gemini ìµœì í™”ëœ í…ìŠ¤íŠ¸ (ëŒ€ì²´ êµ¬ì¡°):', optimizedText);
                            } else {
                                console.error('Candidate êµ¬ì¡°ê°€ ì˜ˆìƒê³¼ ë‹¤ë¦„:', candidate);
                                throw new Error('ì‘ë‹µì—ì„œ í…ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                            }
                        } else if (data && data.error) {
                            console.error('Gemini API ì—ëŸ¬ ì‘ë‹µ:', data.error);
                            const errorMessage = data.error.message || data.error.status || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜';
                            const errorCode = data.error.code || 'UNKNOWN';
                            throw new Error(`Gemini API ì—ëŸ¬ [${errorCode}]: ${errorMessage}`);
                        } else {
                            console.error('ì˜ˆìƒì¹˜ ëª»í•œ Gemini API ì‘ë‹µ êµ¬ì¡°:', data);
                            throw new Error('Gemini API ì‘ë‹µ êµ¬ì¡°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                        }
                    } else {
                        // ì˜¤ë¥˜ ì‘ë‹µ ì²˜ë¦¬
                        console.error('Gemini API ì˜¤ë¥˜ ì‘ë‹µ:', data);
                        if (data && data.error) {
                            const errorMessage = data.error.message || data.error.status || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜';
                            const errorCode = data.error.code || response.status;
                            
                            // ì¼ë°˜ì ì¸ ì˜¤ë¥˜ ë©”ì‹œì§€ ì²˜ë¦¬
                            let userMessage = errorMessage;
                            if (response.status === 400) {
                                userMessage = 'API ìš”ì²­ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. API í‚¤ì™€ ëª¨ë¸ëª…ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
                            } else if (response.status === 401) {
                                userMessage = 'API í‚¤ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
                            } else if (response.status === 403) {
                                userMessage = 'API ì ‘ê·¼ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. API í‚¤ ê¶Œí•œì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
                            } else if (response.status === 429) {
                                userMessage = 'API ìš”ì²­ í•œë„ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                            } else if (response.status === 404) {
                                userMessage = 'ì˜ëª»ëœ ëª¨ë¸ëª…ì…ë‹ˆë‹¤. gemini-1.5-flash ë˜ëŠ” gemini-1.5-proë¥¼ ì‚¬ìš©í•´ë³´ì„¸ìš”.';
                            }
                            
                            throw new Error(`[${errorCode}] ${userMessage}`);
                        } else {
                            throw new Error(`API ìš”ì²­ ì‹¤íŒ¨: ${response.status} ${response.statusText}`);
                        }
                    }
                } else if (provider === 'openai') {
                    const response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${apiKey}`
                        },
                        body: JSON.stringify({
                            model: model,
                            messages: [
                                {
                                    role: 'system',
                                    content: systemPrompt
                                },
                                {
                                    role: 'user',
                                    content: `Optimize this Korean prompt for image generation: ${promptText}`
                                }
                            ],
                            temperature: 0.8,
                            max_tokens: 1000
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('OpenAI API ì‘ë‹µ:', data);
                        
                        // ì•ˆì „í•œ íŒŒì‹±
                        if (data && data.choices && data.choices[0] && 
                            data.choices[0].message && data.choices[0].message.content) {
                            optimizedText = data.choices[0].message.content;
                            console.log('OpenAI ìµœì í™”ëœ í…ìŠ¤íŠ¸:', optimizedText);
                        } else if (data && data.error) {
                            console.error('OpenAI API ì—ëŸ¬:', data.error);
                            throw new Error(`OpenAI API ì—ëŸ¬: ${data.error.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);
                        } else {
                            console.error('ì˜ˆìƒì¹˜ ëª»í•œ OpenAI API ì‘ë‹µ êµ¬ì¡°:', data);
                            throw new Error('OpenAI API ì‘ë‹µ êµ¬ì¡°ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                        }
                    } else {
                        const errorData = await response.json().catch(() => null);
                        console.error('OpenAI API ìš”ì²­ ì‹¤íŒ¨:', response.status, errorData);
                        throw new Error(`API ìš”ì²­ ì‹¤íŒ¨: ${response.status} ${errorData?.error?.message || ''}`);
                    }
                }
                
                return optimizedText;
            } catch (error) {
                console.error('ë‹¨ì¼ í”„ë¡¬í”„íŠ¸ ìµœì í™” ì‹¤íŒ¨:', error);
                
                // CORS ì˜¤ë¥˜ ê°ì§€
                if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError') || error.name === 'TypeError') {
                    console.error('ğŸš« CORS ì˜¤ë¥˜ ê°ì§€ë¨!');
                    console.error('í•´ê²° ë°©ë²•:');
                    console.error('1. Chrome í™•ì¥ í”„ë¡œê·¸ë¨: "Allow CORS" ë˜ëŠ” "CORS Unblock" ì„¤ì¹˜');
                    console.error('2. í”„ë¡ì‹œ ì„œë²„ ì‚¬ìš© (https://cors-anywhere.herokuapp.com/ ë“±)');
                    console.error('3. ë¡œì»¬ ê°œë°œ ì„œë²„ì—ì„œ CORS ì„¤ì •');
                    throw new Error('CORS ì˜¤ë¥˜: ë¸Œë¼ìš°ì €ì—ì„œ API í˜¸ì¶œì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ìœ„ì˜ í•´ê²° ë°©ë²•ì„ ì°¸ê³ í•´ì£¼ì„¸ìš”.');
                }
                
                throw error;
            }
        }
        
        // ìµœì í™”ëœ í”„ë¡¬í”„íŠ¸ë¥¼ ê¸°ì¡´ ë‚´ìš©ê³¼ ë³‘í•©
        function mergeOptimizedPrompt(optimizedData) {
            console.log('=== mergeOptimizedPrompt í•¨ìˆ˜ í˜¸ì¶œ ===');
            console.log('ìµœì í™”ëœ ë°ì´í„°:', optimizedData);
            
            // 1. ê° ì„¹ì…˜ì˜ ë³€ê²½ ë°˜ì˜ í…ìŠ¤íŠ¸ì°½ì— ìµœì í™”ëœ ê²°ê³¼ ì—…ë°ì´íŠ¸
            for (const [key, value] of Object.entries(optimizedData)) {
                // ë³€ê²½ ë°˜ì˜ input ì°¾ê¸°
                const appliedInput = document.querySelector(`input[data-key="${key}-applied"]`);
                if (appliedInput) {
                    console.log(`${key} ë³€ê²½ ë°˜ì˜ í•„ë“œ ì—…ë°ì´íŠ¸:`, value);
                    appliedInput.value = value;
                    // ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±° (ë³€ê²½ ì‚¬í•­ ì¶”ì ì„ ìœ„í•´)
                    appliedInput.dispatchEvent(new Event('input', { bubbles: true }));
                }
            }
            
            // 2. ëª¨ë“  ë³€ê²½ ë°˜ì˜ ë°ì´í„°ë¡œ í”„ë¡¬í”„íŠ¸ ìƒì„± (ì¼ë°˜ í”„ë¡¬í”„íŠ¸ ìƒì„±ê³¼ ë™ì¼í•œ ë¡œì§)
            console.log('ìµœì¢… í”„ë¡¬í”„íŠ¸ í‘œì‹œ í•¨ìˆ˜ í˜¸ì¶œ');
            
            // displayFinalPrompt í•¨ìˆ˜ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
            if (typeof displayFinalPrompt === 'function') {
                displayFinalPrompt();
            } else {
                console.error('displayFinalPrompt í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                
                // Fallback: ìµœì¢… í”„ë¡¬í”„íŠ¸ ì…‰ì…˜ ì§ì ‘ í‘œì‹œ
                const finalPromptSection = document.getElementById('final-prompt-section');
                if (finalPromptSection) {
                    finalPromptSection.style.display = 'block';
                    finalPromptSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }
            
            return;
            
            // ê¸°ì¡´ ì½”ë“œëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
            /*
            
            const promptPreview = document.getElementById('prompt-preview');
            const currentPrompt = promptPreview.textContent.trim();
            
            console.log('í˜„ì¬ í”„ë¡¬í”„íŠ¸ í”„ë¦¬ë·° ë‚´ìš©:', currentPrompt);
            
            // ê¸°ì¡´ ë‚´ìš©ê³¼ AI ìµœì í™” ë‚´ìš©ì„ ë³‘í•©
            let mergedPrompt = '';
            if (currentPrompt) {
                mergedPrompt = `${currentPrompt}\n\n[AI Enhanced]\n${optimizedPrompt}`;
            } else {
                mergedPrompt = optimizedPrompt;
            }
            
            // í”„ë¡¬í”„íŠ¸ í”„ë¦¬ë·°ì— í‘œì‹œ
            console.log('ë³‘í•©ëœ í”„ë¡¬í”„íŠ¸ë¥¼ í”„ë¦¬ë·°ì— í‘œì‹œ:', mergedPrompt);
            promptPreview.textContent = mergedPrompt;
            promptPreview.classList.add('has-content');
            
            // í”„ë¡¬í”„íŠ¸ êµ¬ì¡° í¸ì§‘ê¸°ë¡œ ê°€ì ¸ì˜¤ê¸°
            console.log('importPromptFromPreview í˜¸ì¶œ');
            importPromptFromPreview();
            
            // í”„ë¡¬í”„íŠ¸ ë°ì´í„° ì €ì¥ (ì¼ë°˜ í”„ë¡¬í”„íŠ¸ ìƒì„±ê³¼ ë™ì¼)
            const text = currentPrompt || 'ì‚¬ìš©ì ì…ë ¥';
            
            // promptDataê°€ ì •ì˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
            if (typeof promptData !== 'undefined' && promptData) {
                if (!promptData.generatedPrompts) {
                    promptData.generatedPrompts = [];
                }
                promptData.generatedPrompts.push({
                    timestamp: new Date().toISOString(),
                    input: text,
                    output: mergedPrompt
                });
                
                // saveToLocalStorage í•¨ìˆ˜ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
                if (typeof saveToLocalStorage === 'function') {
                    saveToLocalStorage();
                }
            }
            
            */
        }
        
        // AI í”„ë¡¬í”„íŠ¸ ìƒì„± ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ - DOM ë¡œë“œ í›„ ì—°ê²°
        function initializeAIPromptButton() {
            const aiButton = document.getElementById('ai-generate-prompt-btn');
            if (aiButton) {
                // ê¸°ì¡´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±° (ì¤‘ë³µ ë°©ì§€)
                aiButton.removeEventListener('click', generateAIPrompt);
                
                // ìƒˆ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                aiButton.addEventListener('click', function(e) {
                    console.log('AI í”„ë¡¬í”„íŠ¸ ìƒì„± ë²„íŠ¼ í´ë¦­ë¨!');
                    e.preventDefault();
                    generateAIPrompt();
                });
                
                console.log('AI í”„ë¡¬í”„íŠ¸ ìƒì„± ë²„íŠ¼ ì´ˆê¸°í™” ì™„ë£Œ');
                console.log('ë²„íŠ¼ ìš”ì†Œ:', aiButton);
                console.log('ë²„íŠ¼ ID:', aiButton.id);
                console.log('ë²„íŠ¼ onclick:', aiButton.onclick);
                
                // ë²„íŠ¼ì— ì§ì ‘ onclickë„ ì¶”ê°€ (ë°±ì—…)
                aiButton.onclick = function() {
                    console.log('onclick í•¸ë“¤ëŸ¬ ì‹¤í–‰ë¨');
                    generateAIPrompt();
                };
            } else {
                console.error('AI í”„ë¡¬í”„íŠ¸ ìƒì„± ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                
                // 1ì´ˆ í›„ ì¬ì‹œë„
                setTimeout(() => {
                    console.log('ë²„íŠ¼ ì°¾ê¸° ì¬ì‹œë„...');
                    const retryButton = document.getElementById('ai-generate-prompt-btn');
                    if (retryButton) {
                        console.log('ì¬ì‹œë„ì—ì„œ ë²„íŠ¼ ì°¾ìŒ!');
                        initializeAIPromptButton();
                    }
                }, 1000);
            }
        }
        
        // DOMì´ ì™„ì „íˆ ë¡œë“œëœ í›„ ì‹¤í–‰
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeAIPromptButton);
        } else {
            // ì´ë¯¸ DOMì´ ë¡œë“œëœ ê²½ìš° ì¦‰ì‹œ ì‹¤í–‰
            initializeAIPromptButton();
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ì¶”ê°€ í™•ì¸
        window.addEventListener('load', function() {
            console.log('=== í˜ì´ì§€ ì™„ì „ ë¡œë“œ ì™„ë£Œ ===');
            const aiBtn = document.getElementById('ai-generate-prompt-btn');
            console.log('AI ë²„íŠ¼ ì¡´ì¬ ì—¬ë¶€:', !!aiBtn);
            if (aiBtn) {
                console.log('ë²„íŠ¼ í…ìŠ¤íŠ¸:', aiBtn.textContent);
                console.log('ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ:', aiBtn.onclick);
                console.log('window.generateAIPrompt ì¡´ì¬:', typeof window.generateAIPrompt);
            }
            
            // ëª¨ë“  ë²„íŠ¼ í™•ì¸
            const allButtons = document.querySelectorAll('button');
            console.log('ì „ì²´ ë²„íŠ¼ ìˆ˜:', allButtons.length);
            allButtons.forEach((btn, idx) => {
                if (btn.textContent.includes('AI')) {
                    console.log(`ë²„íŠ¼ ${idx}: ${btn.textContent.trim()}, ID: ${btn.id}`);
                }
            });
        });
        
        // API ì—°ë™ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function openApiModal() {
            console.log('openApiModal í•¨ìˆ˜ í˜¸ì¶œë¨');
            const modal = document.getElementById('api-modal');
            if (!modal) {
                console.error('API ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            console.log('ëª¨ë‹¬ ì°¾ìŒ, show í´ë˜ìŠ¤ ì¶”ê°€ ì „:', modal.className);
            modal.classList.add('show');
            console.log('show í´ë˜ìŠ¤ ì¶”ê°€ í›„:', modal.className);
            
            // ëª¨ë‹¬ì´ ì‹¤ì œë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
            setTimeout(() => {
                const computedStyle = window.getComputedStyle(modal);
                console.log('ëª¨ë‹¬ display ìƒíƒœ:', computedStyle.display);
                console.log('ëª¨ë‹¬ visibility:', computedStyle.visibility);
            }, 100);
            
            // ì €ì¥ëœ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
            const savedConfig = localStorage.getItem('aiApiConfig');
            if (savedConfig) {
                const config = JSON.parse(savedConfig);
                document.getElementById('api-provider').value = config.provider || '';
                document.getElementById('api-key').value = config.apiKey || '';
                updateModelOptions();
                setTimeout(() => {
                    document.getElementById('api-model').value = config.model || '';
                }, 100);
            }
        }
        
        // í•¨ìˆ˜ë¥¼ ì¦‰ì‹œ windowì— í• ë‹¹
        window.openApiModal = openApiModal;

        function closeApiModal() {
            console.log('closeApiModal í•¨ìˆ˜ í˜¸ì¶œë¨');
            const modal = document.getElementById('api-modal');
            if (!modal) {
                console.error('API ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
                return;
            }
            modal.classList.remove('show');
            console.log('ëª¨ë‹¬ ë‹«ê¸° ì™„ë£Œ');
            
            // ì—°ê²° ìƒíƒœ ì´ˆê¸°í™”
            const statusElement = document.getElementById('connection-status');
            if (statusElement) {
                statusElement.className = 'connection-status';
                statusElement.textContent = '';
            }
        }
        
        // í•¨ìˆ˜ë¥¼ ì¦‰ì‹œ windowì— í• ë‹¹
        window.closeApiModal = closeApiModal;

        function updateModelOptions() {
            const provider = document.getElementById('api-provider').value;
            const modelSelect = document.getElementById('api-model');
            const modelGroup = document.getElementById('model-group');
            const apiInfo = document.getElementById('api-info');
            
            // ëª¨ë¸ ì˜µì…˜ ì´ˆê¸°í™”
            modelSelect.innerHTML = '<option value="">ëª¨ë¸ì„ ì„ íƒí•˜ì„¸ìš”</option>';
            
            if (!provider) {
                modelGroup.style.display = 'none';
                apiInfo.style.display = 'none';
                return;
            }
            
            modelGroup.style.display = 'block';
            apiInfo.style.display = 'block';
            
            if (provider === 'gemini') {
                apiInfo.innerHTML = 'ğŸ’¡ Google AI Studioì—ì„œ API í‚¤ë¥¼ ë°œê¸‰ë°›ìœ¼ì„¸ìš”. <a href="https://makersuite.google.com/app/apikey" target="_blank" style="color: #3b82f6;">API í‚¤ ë°œê¸‰í•˜ê¸°</a>';
                const geminiModels = [
                    { value: 'gemini-2.5-pro', name: 'Gemini 2.5 Pro (ìµœì‹ , ì¶”ì²œ)' },
                    { value: 'gemini-2.5-flash', name: 'Gemini 2.5 Flash (ìµœì‹ )' },
                    { value: 'gemini-2.0-flash-exp', name: 'Gemini 2.0 Flash' },
                    { value: 'gemini-1.5-pro', name: 'Gemini 1.5 Pro' },
                    { value: 'gemini-1.5-flash', name: 'Gemini 1.5 Flash' }
                ];
                geminiModels.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.value;
                    option.textContent = model.name;
                    modelSelect.appendChild(option);
                });
            } else if (provider === 'openai') {
                apiInfo.innerHTML = 'ğŸ’¡ OpenAI Platformì—ì„œ API í‚¤ë¥¼ ë°œê¸‰ë°›ìœ¼ì„¸ìš”. <a href="https://platform.openai.com/api-keys" target="_blank" style="color: #3b82f6;">API í‚¤ ë°œê¸‰í•˜ê¸°</a>';
                const openaiModels = [
                    { value: 'gpt-4o', name: 'GPT-4o (ìµœì‹ , ì¶”ì²œ)' },
                    { value: 'gpt-4o-mini', name: 'GPT-4o Mini (ê²½ì œì )' },
                    { value: 'gpt-4-turbo', name: 'GPT-4 Turbo' },
                    { value: 'gpt-4', name: 'GPT-4' },
                    { value: 'gpt-3.5-turbo', name: 'GPT-3.5 Turbo' },
                    { value: 'o1-preview', name: 'o1 Preview (ì¶”ë¡  íŠ¹í™”)' },
                    { value: 'o1-mini', name: 'o1 Mini (ì¶”ë¡  íŠ¹í™”, ê²½ì œì )' }
                ];
                openaiModels.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.value;
                    option.textContent = model.name;
                    modelSelect.appendChild(option);
                });
            }
        }

        async function autoTestConnection() {
            const provider = document.getElementById('api-provider').value;
            const apiKey = document.getElementById('api-key').value;
            
            if (provider && apiKey && apiKey.length > 20) {
                // ëª¨ë¸ ì„ íƒì€ ìë™ìœ¼ë¡œ ì²« ë²ˆì§¸ ëª¨ë¸ë¡œ ì„¤ì •
                const modelSelect = document.getElementById('api-model');
                if (modelSelect.options.length > 1) {
                    modelSelect.selectedIndex = 1;
                }
                await testApiConnection();
            }
        }
        
        async function testApiConnection() {
            const provider = document.getElementById('api-provider').value;
            const apiKey = document.getElementById('api-key').value;
            const model = document.getElementById('api-model').value || document.getElementById('api-model').options[1]?.value;
            const statusDiv = document.getElementById('connection-status');
            
            if (!provider || !apiKey) {
                showToast('ì œê³µìì™€ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            statusDiv.className = 'connection-status';
            statusDiv.textContent = 'ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...';
            statusDiv.style.display = 'block';
            
            try {
                let response;
                
                if (provider === 'gemini') {
                    // Gemini API í…ŒìŠ¤íŠ¸
                    response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: "Say 'Hello'"
                                }]
                            }]
                        })
                    });
                } else if (provider === 'openai') {
                    // OpenAI API í…ŒìŠ¤íŠ¸
                    response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${apiKey}`
                        },
                        body: JSON.stringify({
                            model: model,
                            messages: [{
                                role: 'user',
                                content: 'Say "Hello"'
                            }],
                            max_tokens: 10
                        })
                    });
                }
                
                if (response.ok) {
                    statusDiv.className = 'connection-status success';
                    statusDiv.textContent = 'âœ“ ì—°ê²° ì„±ê³µ! APIê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.';
                    document.getElementById('save-api-btn').disabled = false;
                } else {
                    const error = await response.json();
                    statusDiv.className = 'connection-status error';
                    statusDiv.textContent = `âœ— ì—°ê²° ì‹¤íŒ¨: ${error.error?.message || 'ì˜ëª»ëœ API í‚¤ ë˜ëŠ” ì„¤ì •ì…ë‹ˆë‹¤.'}`;
                    document.getElementById('save-api-btn').disabled = true;
                }
            } catch (error) {
                statusDiv.className = 'connection-status error';
                statusDiv.textContent = `âœ— ì—°ê²° ì‹¤íŒ¨: ${error.message}`;
                document.getElementById('save-api-btn').disabled = true;
            }
        }

        function saveApiConfig() {
            console.log('=== saveApiConfig í•¨ìˆ˜ í˜¸ì¶œ ===');
            
            const provider = document.getElementById('api-provider').value;
            const apiKey = document.getElementById('api-key').value;
            const model = document.getElementById('api-model').value;
            
            console.log('ì…ë ¥ëœ ê°’ë“¤:');
            console.log('Provider:', provider);
            console.log('API Key:', apiKey ? `${apiKey.substring(0, 10)}...` : 'ì—†ìŒ');
            console.log('Model:', model);
            
            if (!provider || !apiKey || !model) {
                showToast('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            const config = {
                provider: provider,
                apiKey: apiKey,
                model: model
            };
            
            console.log('ì €ì¥í•  ì„¤ì •:', config);
            localStorage.setItem('aiApiConfig', JSON.stringify(config));
            
            // ì €ì¥ í™•ì¸
            const savedConfig = localStorage.getItem('aiApiConfig');
            console.log('ì €ì¥ëœ ì„¤ì • í™•ì¸:', savedConfig);
            
            showToast('API ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            closeApiModal();
        }

        // AIë¥¼ í†µí•œ í”„ë¡¬í”„íŠ¸ í–¥ìƒ í•¨ìˆ˜
        async function enhancePromptWithAI(text) {
            try {
                const configStr = localStorage.getItem('aiApiConfig');
                if (!configStr) {
                    console.log('API ì„¤ì •ì´ ì—†ì–´ì„œ ê¸°ë³¸ í–¥ìƒ í•¨ìˆ˜ ì‚¬ìš©');
                    return enhancePrompt(text); // ê¸°ì¡´ ë¡œì§ìœ¼ë¡œ í´ë°±
                }
                
                const config = JSON.parse(configStr);
                if (!config || !config.provider || !config.apiKey || !config.model) {
                    console.log('API ì„¤ì •ì´ ë¶ˆì™„ì „í•˜ì—¬ ê¸°ë³¸ í–¥ìƒ í•¨ìˆ˜ ì‚¬ìš©');
                    return enhancePrompt(text); // ê¸°ì¡´ ë¡œì§ìœ¼ë¡œ í´ë°±
                }
                
                const { provider, apiKey, model } = config;
            
            try {
                let enhancedText;
                const systemPrompt = `You are an expert at creating detailed image generation prompts. Enhance the following request into a detailed, descriptive prompt for AI image generation. Include specific details about style, lighting, composition, colors, and atmosphere. Keep the response concise but descriptive. Respond in the same language as the input.`;
                
                if (provider === 'gemini') {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: `${systemPrompt}\n\nEnhance this prompt: ${text}`
                                }]
                            }],
                            generationConfig: {
                                temperature: 0.7,
                                maxOutputTokens: 500
                            }
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        enhancedText = data.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error('API ìš”ì²­ ì‹¤íŒ¨');
                    }
                } else if (provider === 'openai') {
                    const response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${apiKey}`
                        },
                        body: JSON.stringify({
                            model: model,
                            messages: [
                                {
                                    role: 'system',
                                    content: systemPrompt
                                },
                                {
                                    role: 'user',
                                    content: `Enhance this prompt: ${text}`
                                }
                            ],
                            temperature: 0.7,
                            max_tokens: 500
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        enhancedText = data.choices[0].message.content;
                    } else {
                        throw new Error('API ìš”ì²­ ì‹¤íŒ¨');
                    }
                }
                
                return enhancedText || enhancePrompt(text);
            } catch (apiError) {
                console.error('AI API ìš”ì²­ ì‹¤íŒ¨:', apiError);
                return enhancePrompt(text); // ê¸°ì¡´ ë¡œì§ìœ¼ë¡œ í´ë°±
            }
            } catch (parseError) {
                console.error('API ì„¤ì • íŒŒì‹± ì˜¤ë¥˜:', parseError);
                return enhancePrompt(text); // ê¸°ì¡´ ë¡œì§ìœ¼ë¡œ í´ë°±
            }
        }
        
        // ì´ë¯¸ ìœ„ì—ì„œ ì •ì˜ëœ window í•¨ìˆ˜ë“¤ì€ ì œê±° (ì¤‘ë³µ ë°©ì§€)
        // window.openApiModalì€ ì´ë¯¸ 4107ì¤„ì—ì„œ ì •ì˜ë¨
        window.updateModelOptions = updateModelOptions;
        window.testApiConnection = testApiConnection;
        window.saveApiConfig = saveApiConfig;
        window.autoTestConnection = autoTestConnection;
    </script>
    
    <!-- API ì—°ë™ ëª¨ë‹¬ -->
    <div id="api-modal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title"><span style="font-size: 1.2rem;">ğŸ¤–</span> AI API ì—°ë™ ì„¤ì •</h3>
                <button class="modal-close" onclick="closeApiModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="api-provider">AI ì œê³µì ì„ íƒ</label>
                    <select id="api-provider" class="form-select" onchange="updateModelOptions()">
                        <option value="">ì œê³µìë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="gemini">Google Gemini</option>
                        <option value="openai">OpenAI</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="api-key">API í‚¤</label>
                    <input type="password" id="api-key" class="form-input" placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”" onpaste="setTimeout(() => autoTestConnection(), 100)" onkeyup="if(event.key === 'Enter') autoTestConnection()">
                    <div id="api-info" class="api-info" style="display: none;"></div>
                </div>
                
                <div class="form-group" id="model-group" style="display: none;">
                    <label class="form-label" for="api-model">ì—°ê²° ëª¨ë¸</label>
                    <select id="api-model" class="form-select">
                        <option value="">ëª¨ë¸ì„ ì„ íƒí•˜ì„¸ìš”</option>
                    </select>
                </div>
                
                <div id="connection-status" class="connection-status"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" onclick="closeApiModal()">ì·¨ì†Œ</button>
                <button class="btn btn-test" onclick="testApiConnection()">ì—°ê²° í…ŒìŠ¤íŠ¸</button>
                <button id="save-api-btn" class="btn btn-save" onclick="saveApiConfig()" disabled>ì €ì¥</button>
            </div>
        </div>
    </div>
    
</body>
</html>