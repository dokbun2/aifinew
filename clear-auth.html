<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¸ì¦ ë°ì´í„° ì •ë¦¬</title>
    <style>
        body {
            background: #1a1a1a;
            color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            color: #ff6b6b;
        }
        .section {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 10px 10px 0;
            font-size: 14px;
        }
        button:hover {
            background: #ff5252;
        }
        .danger {
            background: #dc3545;
        }
        .danger:hover {
            background: #c82333;
        }
        .success {
            background: #28a745;
        }
        .success:hover {
            background: #218838;
        }
        pre {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }
        .log {
            margin-top: 10px;
            padding: 10px;
            background: #333;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>ğŸ§¹ ì¸ì¦ ë°ì´í„° ì •ë¦¬ ë„êµ¬</h1>

    <div class="section">
        <h2>í˜„ì¬ ì €ì¥ëœ ì¸ì¦ ë°ì´í„°</h2>
        <button onclick="checkCurrentAuth()">í˜„ì¬ ìƒíƒœ í™•ì¸</button>
        <pre id="current-auth"></pre>
    </div>

    <div class="section">
        <h2>Google ë¡œê·¸ì¸ ì”ì¬ ì œê±°</h2>
        <button onclick="clearGoogleAuth()">Google ì¸ì¦ ë°ì´í„° ì‚­ì œ</button>
        <button onclick="clearAllGoogleData()" class="danger">ëª¨ë“  Google ê´€ë ¨ ë°ì´í„° ì‚­ì œ</button>
        <div id="google-log" class="log"></div>
    </div>

    <div class="section">
        <h2>ìì²´ ì¸ì¦ ì‹œìŠ¤í…œ</h2>
        <button onclick="clearAuthToken()">ì¸ì¦ í† í°ë§Œ ì‚­ì œ</button>
        <button onclick="clearUserInfo()">ì‚¬ìš©ì ì •ë³´ë§Œ ì‚­ì œ</button>
        <button onclick="clearAllAuth()" class="danger">ëª¨ë“  ì¸ì¦ ë°ì´í„° ì‚­ì œ</button>
        <div id="auth-log" class="log"></div>
    </div>

    <div class="section">
        <h2>ì „ì²´ ì´ˆê¸°í™”</h2>
        <button onclick="clearAllLocalStorage()" class="danger">âš ï¸ localStorage ì „ì²´ ì´ˆê¸°í™”</button>
        <button onclick="goToHome()" class="success">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
        <div id="total-log" class="log"></div>
    </div>

    <script>
        // í˜„ì¬ ì¸ì¦ ìƒíƒœ í™•ì¸
        function checkCurrentAuth() {
            const authData = {
                localStorage: {},
                sessionStorage: {},
                cookies: document.cookie
            };

            // localStorage ëª¨ë“  í‚¤ í™•ì¸
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                try {
                    authData.localStorage[key] = localStorage.getItem(key);
                    // JSON íŒŒì‹± ê°€ëŠ¥í•œ ê²½ìš° íŒŒì‹±
                    try {
                        authData.localStorage[key] = JSON.parse(authData.localStorage[key]);
                    } catch (e) {
                        // íŒŒì‹± ì‹¤íŒ¨ì‹œ ì›ë³¸ ìœ ì§€
                    }
                } catch (e) {
                    authData.localStorage[key] = 'Error reading value';
                }
            }

            // sessionStorage í™•ì¸
            for (let i = 0; i < sessionStorage.length; i++) {
                const key = sessionStorage.key(i);
                authData.sessionStorage[key] = sessionStorage.getItem(key);
            }

            document.getElementById('current-auth').textContent = JSON.stringify(authData, null, 2);
            console.log('í˜„ì¬ ì¸ì¦ ë°ì´í„°:', authData);
        }

        // Google ì¸ì¦ ê´€ë ¨ ë°ì´í„° ì‚­ì œ
        function clearGoogleAuth() {
            const googleKeys = [];
            let cleared = [];

            // Google ê´€ë ¨ í‚¤ ì°¾ê¸°
            for (let i = localStorage.length - 1; i >= 0; i--) {
                const key = localStorage.key(i);
                if (key && (
                    key.includes('google') ||
                    key.includes('Google') ||
                    key.includes('gsi') ||
                    key.includes('g_state') ||
                    key.includes('oauth')
                )) {
                    googleKeys.push(key);
                }
            }

            // ì°¾ì€ í‚¤ë“¤ ì‚­ì œ
            googleKeys.forEach(key => {
                localStorage.removeItem(key);
                cleared.push(key);
            });

            // Google ì¿ í‚¤ ì‚­ì œ ì‹œë„
            document.cookie.split(";").forEach(function(c) {
                if (c.includes('g_') || c.includes('google')) {
                    document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
                }
            });

            document.getElementById('google-log').innerHTML =
                `âœ… Google ê´€ë ¨ ë°ì´í„° ${cleared.length}ê°œ ì‚­ì œë¨:<br>` +
                cleared.join('<br>');
        }

        // ëª¨ë“  Google ê´€ë ¨ ë°ì´í„° ì‚­ì œ
        function clearAllGoogleData() {
            clearGoogleAuth();

            // user_infoì—ì„œ Google ê´€ë ¨ ì •ë³´ ì œê±°
            const userInfo = localStorage.getItem('user_info');
            if (userInfo) {
                try {
                    const user = JSON.parse(userInfo);
                    if (user.picture && user.picture.includes('google')) {
                        delete user.picture;
                        localStorage.setItem('user_info', JSON.stringify(user));
                    }
                } catch (e) {
                    console.error('user_info íŒŒì‹± ì˜¤ë¥˜:', e);
                }
            }

            document.getElementById('google-log').innerHTML +=
                '<br>âœ… ëª¨ë“  Google ê´€ë ¨ ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.';
        }

        // ì¸ì¦ í† í° ì‚­ì œ
        function clearAuthToken() {
            localStorage.removeItem('auth_token');
            sessionStorage.removeItem('auth_token');
            document.getElementById('auth-log').innerHTML = 'âœ… ì¸ì¦ í† í°ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.';
        }

        // ì‚¬ìš©ì ì •ë³´ ì‚­ì œ
        function clearUserInfo() {
            localStorage.removeItem('user_info');
            sessionStorage.removeItem('user_info');
            document.getElementById('auth-log').innerHTML = 'âœ… ì‚¬ìš©ì ì •ë³´ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.';
        }

        // ëª¨ë“  ì¸ì¦ ë°ì´í„° ì‚­ì œ
        function clearAllAuth() {
            clearAuthToken();
            clearUserInfo();
            clearGoogleAuth();
            document.getElementById('auth-log').innerHTML = 'âœ… ëª¨ë“  ì¸ì¦ ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.';
        }

        // localStorage ì „ì²´ ì´ˆê¸°í™”
        function clearAllLocalStorage() {
            if (confirm('âš ï¸ ê²½ê³ : ëª¨ë“  localStorage ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.\n\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                const keys = Object.keys(localStorage);
                localStorage.clear();
                sessionStorage.clear();

                // ì¿ í‚¤ë„ ëª¨ë‘ ì‚­ì œ
                document.cookie.split(";").forEach(function(c) {
                    document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
                });

                document.getElementById('total-log').innerHTML =
                    `âœ… ì „ì²´ ì´ˆê¸°í™” ì™„ë£Œ:<br>` +
                    `- localStorage: ${keys.length}ê°œ í•­ëª© ì‚­ì œ<br>` +
                    `- sessionStorage: ëª¨ë‘ ì‚­ì œ<br>` +
                    `- Cookies: ëª¨ë‘ ì‚­ì œ`;

                setTimeout(() => {
                    alert('ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. í™ˆìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
                    window.location.href = 'index.html';
                }, 2000);
            }
        }

        // í™ˆìœ¼ë¡œ ì´ë™
        function goToHome() {
            window.location.href = 'index.html';
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ í˜„ì¬ ìƒíƒœ ìë™ í‘œì‹œ
        window.addEventListener('load', () => {
            checkCurrentAuth();
        });
    </script>
</body>
</html>